Notebook[{
Cell[BoxData[{RowBox[{"Remove", "[", "\"Global`*\"", "]"}]}],"Input",CellLabel->"In[2]:="],
Cell[BoxData[{RowBox[{RowBox[{"f", "=", RowBox[{"epsi", "*", RowBox[{RowBox[{"M", "^", "3"}], "/", "r"}]}]}], ";"}], "\n", RowBox[{RowBox[{"A1", "=", RowBox[{"1", "+", RowBox[{"a13", "*", RowBox[{RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "^", "3"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"A2", "=", RowBox[{"2", "+", RowBox[{"a22", "*", RowBox[{RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"A5", "=", RowBox[{"1", "+", RowBox[{"a52", "*", RowBox[{RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "^", "2"}]}]}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"B", "=", RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[{"r", "^", "2"}], "+", RowBox[{"a", "^", "2"}]}], ")"}], "*", "A1"}], "-", RowBox[{RowBox[{"a", "^", "2"}], "*", "A2", "*", RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"Sigma", "=", RowBox[{RowBox[{"r", "^", "2"}], "+", RowBox[{RowBox[{"a", "^", "2"}], "*", RowBox[{RowBox[{"Cos", "[", "theta", "]"}], "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"Sigmavar", "=", RowBox[{"Sigma", "+", "f"}]}], ";"}], "\n", RowBox[{RowBox[{"Delta", "=", RowBox[{RowBox[{"r", "^", "2"}], "-", RowBox[{"2", "*", "M", "*", "r"}], "+", RowBox[{"a", "^", "2"}]}]}], ";"}]}],"Input",CellLabel->"In[3]:="],
Cell[BoxData[{RowBox[{RowBox[{"epsi", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"a13", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"a22", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"a52", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"b1", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"b2", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"c1", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"c2", "=", "0"}], ";"}]}],"Input",CellLabel->"In[11]:="],
Cell[BoxData[{RowBox[{RowBox[{"b1", "=", "defpar"}], ";"}]}],"Input",CellLabel->"In[19]:="],
Cell[TextData[{"Covariant Metric Components"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"gtt", "=", RowBox[{"Sigmavar", "*", RowBox[{RowBox[{"(", RowBox[{"Delta", "-", RowBox[{RowBox[{"a", "^", "2"}], "*", RowBox[{"A2", "^", "2"}], "*", RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}]}]}], ")"}], "/", RowBox[{"B", "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"grr", "=", RowBox[{"Sigmavar", "/", RowBox[{"(", RowBox[{"Delta", "*", "A5"}], ")"}]}]}], ";"}], "\n", RowBox[{RowBox[{"gthth", "=", "Sigmavar"}], ";"}], "\n", RowBox[{RowBox[{"gpp", "=", RowBox[{RowBox[{"(", RowBox[{RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[{"r", "^", "2"}], "+", RowBox[{"a", "^", "2"}]}], ")"}], "^", "2"}], "*", RowBox[{"A1", "^", "2"}]}], "-", RowBox[{RowBox[{"a", "^", "2"}], "*", "Delta", "*", RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}]}]}], ")"}], "*", "Sigmavar", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", RowBox[{"B", "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"gtp", "=", RowBox[{RowBox[{"-", "a"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[{"r", "^", "2"}], "+", RowBox[{"a", "^", "2"}]}], ")"}], "*", "A1", "*", "A2"}], "-", "Delta"}], ")"}], "*", "Sigmavar", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", RowBox[{"B", "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"gtr", "=", RowBox[{RowBox[{"b1", "*", RowBox[{"a", "/", "r"}]}], "+", RowBox[{"b2", "*", "a", "*", RowBox[{"M", "/", RowBox[{"r", "^", "2"}]}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"grp", "=", RowBox[{RowBox[{"c1", "*", "a", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", "r"}]}], "+", RowBox[{"c2", "*", "a", "*", "M", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", RowBox[{"r", "^", "2"}]}]}]}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"G", "=", RowBox[{"Simplify", "[", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"gtt", ",", "gtr", ",", "0", ",", "gtp"}], "}"}], ",", RowBox[{"{", RowBox[{"gtr", ",", "grr", ",", "0", ",", "grp"}], "}"}], ",", RowBox[{"{", RowBox[{"0", ",", "0", ",", "gthth", ",", "0"}], "}"}], ",", RowBox[{"{", RowBox[{"gtp", ",", "grp", ",", "0", ",", "gpp"}], "}"}]}], "}"}], "]"}]}], ";"}], "\n", RowBox[{"G", "//", "MatrixForm"}]}],"Input",CellLabel->"In[20]:="],
Cell[TextData[{"Contravariant Metric Components"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"Ginv", "=", RowBox[{"Simplify", "[", RowBox[{"Inverse", "[", "G", "]"}], "]"}]}], ";"}], "\n", RowBox[{"(*", RowBox[{"Ginv", "//", "MatrixForm"}], "*)"}]}],"Input",CellLabel->"In[34]:="],
Cell[BoxData[TagBox[RowBox[{"(", "\[NoBreak]", GridBox[{{FractionBox[RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]], FractionBox[RowBox[{"a", " ", "defpar"}], "r"], "0", RowBox[{"-", FractionBox[RowBox[{"a", " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]]}]}, {FractionBox[RowBox[{"a", " ", "defpar"}], "r"], FractionBox[RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], RowBox[{SuperscriptBox["a", "2"], "-", RowBox[{"2", " ", "M", " ", "r"}], "+", SuperscriptBox["r", "2"]}]], "0", "0"}, {"0", "0", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], "0"}, {RowBox[{"-", FractionBox[RowBox[{"a", " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]]}], "0", "0", FractionBox[RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]]}}, RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], Function[BoxForm`e$, MatrixForm[BoxForm`e$]]]],"Output",CellLabel->"Out[35]//MatrixForm= "],
Cell[BoxData[TagBox[RowBox[{"(", "\[NoBreak]", GridBox[{{RowBox[{"-", FractionBox[RowBox[{SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]]}], FractionBox[RowBox[{SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"a", " ", "defpar", " ", "r"}], "+", FractionBox[RowBox[{SuperscriptBox["a", "3"], " ", "defpar", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}], "r"]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]], "0", RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]]}]}, {FractionBox[RowBox[{SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"a", " ", "defpar", " ", "r"}], "+", FractionBox[RowBox[{SuperscriptBox["a", "3"], " ", "defpar", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}], "r"]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]], RowBox[{"-", FractionBox[RowBox[{SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]]}], "0", FractionBox[RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", "r", " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]]}, {"0", "0", FractionBox["1", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}]], "0"}, {RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]]}], FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"a", " ", "defpar", " ", "r"}], "+", FractionBox[RowBox[{SuperscriptBox["a", "3"], " ", "defpar", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}], "r"]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]], "0", RowBox[{"-", FractionBox[RowBox[{SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "4"], " ", RowBox[{"(", RowBox[{RowBox[{"-", FractionBox[RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"]}], SuperscriptBox["r", "2"]]}], "+", FractionBox[RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}]]}], ")"}]}], RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"]}], "+", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["defpar", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"Cos", "[", RowBox[{"2", " ", "theta"}], "]"}]}]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["r", "3"], "+", RowBox[{SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{"4", " ", SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}]]}]}}, RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], Function[BoxForm`e$, MatrixForm[BoxForm`e$]]]],"Output",CellLabel->"Out[37]//MatrixForm= "],
Cell[BoxData[{RowBox[{RowBox[{"gutt", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gurr", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"guthth", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gupp", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gutr", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gutp", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gurp", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], ";"}]}],"Input",CellLabel->"In[38]:="],
Cell[TextData[{"Christoffel Symbol"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"Christ", "=", RowBox[{RowBox[{"ResourceFunction", "[", "\"ChristoffelSymbol\"", "]"}], "[", RowBox[{"G", ",", RowBox[{"{", RowBox[{"t", ",", "r", ",", "theta", ",", "phi"}], "}"}], ",", RowBox[{"\"Kind\"", "->", "\"Second\""}]}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"Christ", "=", RowBox[{"Simplify", "[", "Christ", "]"}]}], ";"}]}],"Input",CellLabel->"In[45]:="],
Cell[BoxData[{RowBox[{"(*", RowBox[{RowBox[{"chttt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chttr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chttth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chttp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chtrr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chtrth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chtrp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chtthth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chtthp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chtpp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "4", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrtt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chrtr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chrtth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chrtp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrrr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chrrth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chrrp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrthth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chrthp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrpp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "4", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chthtt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chthtr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chthtth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chthtp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chthrr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chthrth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chthrp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chththth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chththp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chthpp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "4", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chptt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chptr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chptth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chptp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chprr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chprth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chprp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chpthth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chpthp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chppp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "4", ",", "4"}], "]"}], "]"}]}], ";"}], "*)"}]}],"Input",CellLabel->"In[47]:="],
Cell[TextData[{"Metric Derivatives"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"dGdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"G", ",", "r"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"dGdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"G", ",", "theta"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"dGdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"G", ",", RowBox[{"{", RowBox[{"r", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"dGdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"G", ",", RowBox[{"{", RowBox[{"theta", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}]}],"Input",CellLabel->"In[88]:="],
Cell[BoxData[{RowBox[{"(*", RowBox[{RowBox[{"dgttdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtt", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgththdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gthth", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgppdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gpp", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtp", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grp", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgttdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtt", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grr", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgththdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gthth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgppdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gpp", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtp", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtr", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grp", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgttdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgttdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrrdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgththdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgththdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgppdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgppdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtpdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtrdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrpdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgttdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgttdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrrdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgththdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgththdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgppdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgppdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtpdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtrdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrpdth", ",", "theta"}], "]"}], "]"}]}], ";"}], "*)"}]}],"Input",CellLabel->"In[87]:="],
Cell[TextData[{"Convert to C Code"}],"Chapter"],
Cell[BoxData[{RowBox[{"(*", RowBox[{RowBox[{"::", "Package"}], "::"}], "*)"}], "\n", "\n", RowBox[{"BeginPackage", "[", "\"OptimizeExpressionToC`\"", "]"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"OptimizeExpressionToC", "::", "usage"}], "=", "\"Generates optimized version of expression in C\""}], ";"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"ExtractTags", "::", "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"ClearTagText", "::", "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"TagExistQ", "::", "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"AppendToTag", "::", "usage"}], "=", "\"\""}], ";"}], "\n", "\n", RowBox[{"Begin", "[", "\"Private`\"", "]"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", "expr_List", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"optimizedExpr", ",", "mainExpr", ",", "n", ",", "m", ",", "defs", ",", "output"}], "}"}], ",", RowBox[{RowBox[{"optimizedExpr", "=", RowBox[{"Experimental`OptimizeExpression", "[", "expr", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"ToString", "@", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "0"}], "]"}], "]"}]}], "==", "\"Block\""}], ",", RowBox[{"{", RowBox[{RowBox[{"n", "=", RowBox[{"Length", "[", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", RowBox[{"mainExpr", "=", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "2", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ";"}], "}"}], ",", RowBox[{"{", RowBox[{RowBox[{"n", "=", "0"}], ";", RowBox[{"mainExpr", "=", RowBox[{"Flatten", "@", RowBox[{"{", RowBox[{"optimizedExpr", "[", RowBox[{"[", "1", "]"}], "]"}], "}"}]}]}], ";"}], "}"}]}], "]"}], ";", RowBox[{"m", "=", RowBox[{"Length", "[", "mainExpr", "]"}]}], ";", RowBox[{"defs", "=", RowBox[{"Table", "[", RowBox[{RowBox[{"\"double \"", "<>", RowBox[{"ToString", "@", RowBox[{"CForm", "@", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}]}]}], "<>", "\" = \"", "<>", RowBox[{"ToString", "@", RowBox[{"CForm", "@", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "2", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "<>", "\";\""}], ",", RowBox[{"{", RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", RowBox[{"output", "=", RowBox[{"MapIndexed", "[", RowBox[{RowBox[{RowBox[{"\"out(\"", "<>", RowBox[{"StringJoin", "@", RowBox[{"Riffle", "[", RowBox[{RowBox[{"ToString", "/@", RowBox[{"(", RowBox[{"#2", "-", "1"}], ")"}]}], ",", "\"\""}], "]"}]}], "<>", "\") = \"", "<>", RowBox[{"ToString", "@", RowBox[{"CForm", "@", "#1"}]}], "<>", "\";\""}], "&"}], ",", "mainExpr", ",", RowBox[{"{", RowBox[{"ArrayDepth", "[", "mainExpr", "]"}], "}"}]}], "]"}]}], ";", RowBox[{"StringReplace", "[", RowBox[{RowBox[{"Join", "[", RowBox[{"defs", ",", "output"}], "]"}], ",", RowBox[{"\"Compile_$\"", "->", "\"t\""}]}], "]"}]}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{"End", "[", "]"}], "\n", "\n", "\n", RowBox[{RowBox[{RowBox[{"ExtractTags", "[", "string_String", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"regex", ",", "extractTag"}], "}"}], ",", RowBox[{RowBox[{"regex", "=", RowBox[{"RegularExpression", "[", "\"\\\\n([^\\\\n]*)// (\\\\[|</?)([^\\\\]\\\\n]*)(\\\\]|>)[^\\\\n]*\\\\n\"", "]"}]}], ";", RowBox[{RowBox[{"extractTag", "[", "bounds_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"substring", ",", "indentation", ",", "tagType", ",", "tag"}], "}"}], ",", RowBox[{RowBox[{"substring", "=", RowBox[{"StringTake", "[", RowBox[{"string", ",", "bounds"}], "]"}]}], ";", RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"indentation", ",", "tagType", ",", "tag"}], "}"}], "}"}], "=", RowBox[{"StringCases", "[", RowBox[{"substring", ",", RowBox[{"regex", "->", RowBox[{"{", RowBox[{"\"$1\"", ",", "\"$2\"", ",", "\"$3\""}], "}"}]}]}], "]"}]}], ";", RowBox[{"Association", "[", RowBox[{RowBox[{"\"indentation\"", "->", "indentation"}], ",", RowBox[{"\"tagType\"", "->", "tagType"}], ",", RowBox[{"\"tag\"", "->", "tag"}], ",", RowBox[{"\"start\"", "->", RowBox[{RowBox[{"bounds", "[", RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", RowBox[{"\"end\"", "->", RowBox[{"bounds", "[", RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "]"}]}], ";", RowBox[{RowBox[{RowBox[{"extractTag", "[", "#", "]"}], "&"}], "/@", RowBox[{"StringPosition", "[", RowBox[{"string", ",", "regex"}], "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"TagExistQ", "[", RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", RowBox[{"AnyTrue", "[", RowBox[{RowBox[{"ExtractTags", "[", "string", "]"}], ",", RowBox[{RowBox[{RowBox[{"#", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&"}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"ClearTagText", "[", RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"tags", ",", "startTag", ",", "endTag", ",", "x"}], "}"}], ",", RowBox[{RowBox[{"tags", "=", RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", RowBox[{"startTag", "=", RowBox[{"FirstCase", "[", RowBox[{"tags", ",", RowBox[{"x_", "/;", RowBox[{RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&&", RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tagType\"", "]"}], "]"}], "==", "\"<\""}]}]}]}], "]"}]}], ";", RowBox[{"endTag", "=", RowBox[{"FirstCase", "[", RowBox[{"tags", ",", RowBox[{"x_", "/;", RowBox[{RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&&", RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tagType\"", "]"}], "]"}], "==", "\"</\""}]}]}]}], "]"}]}], ";", RowBox[{RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"startTag", "[", RowBox[{"[", "\"end\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{RowBox[{"endTag", "[", RowBox[{"[", "\"start\"", "]"}], "]"}], ",", RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], "]"}]}]}]}], "]"}]}], "\n", "\n", RowBox[{RowBox[{RowBox[{"AppendToTag", "[", RowBox[{"string_String", ",", "tag_String", ",", "linesToAppend_List"}], "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"tags", ",", "startTag", ",", "indent", ",", "x"}], "}"}], ",", RowBox[{RowBox[{"tags", "=", RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", RowBox[{"startTag", "=", RowBox[{"FirstCase", "[", RowBox[{"tags", ",", RowBox[{"x_", "/;", RowBox[{RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&&", RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tagType\"", "]"}], "]"}], "==", "\"<\""}]}]}]}], "]"}]}], ";", RowBox[{"indent", "=", RowBox[{"startTag", "[", RowBox[{"[", "\"indentation\"", "]"}], "]"}]}], ";", RowBox[{RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"startTag", "[", RowBox[{"[", "\"end\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", RowBox[{"StringRiffle", "[", RowBox[{"linesToAppend", ",", RowBox[{"{", RowBox[{"indent", ",", RowBox[{"\"\\n\"", "<>", "indent"}], ",", "\"\\n\""}], "}"}]}], "]"}], "<>", RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{RowBox[{RowBox[{"startTag", "[", RowBox[{"[", "\"end\"", "]"}], "]"}], "+", "1"}], ",", RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"AppendToTag", "[", RowBox[{"string_String", ",", "tag_String", ",", "stringToAppend_String"}], "]"}], ":=", RowBox[{"AppendToTag", "[", RowBox[{"string", ",", "tag", ",", RowBox[{"StringSplit", "[", RowBox[{"stringToAppend", ",", "\"\\n\""}], "]"}]}], "]"}]}], ";"}], "\n", "\n", "\n", RowBox[{"EndPackage", "[", "]"}]}],"Input",CellLabel->"In[92]:="],
Cell[BoxData["\"OptimizeExpressionToC`\""],"Output",CellLabel->"Out[92]= "],
Cell[BoxData["\"Private`\""],"Output",CellLabel->"Out[98]= "],
Cell[BoxData["\"Private`\""],"Output",CellLabel->"Out[100]= "],
Cell[BoxData[{RowBox[{RowBox[{"M", "=", "1"}], ";"}], "\n", RowBox[{RowBox[{"a", "=", "spin"}], ";"}], "\n", RowBox[{RowBox[{"theta", "=", "th"}], ";"}]}],"Input",CellLabel->"In[107]:="],
Cell[TextData[{"Metric Components"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"g[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"g[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"g[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"g[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"g[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"g[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"g[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"g[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"g[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"g[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"g[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"g[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"g[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"g[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"g[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"g[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void metric(long double r, long double th, long double g[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{"metric", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}]}],"Input",CellLabel->"In[110]:="],
Cell[BoxData["\"void metric(long double r, long double th, long double g[4][4])\\n{\\nlong double t1 = pow(r,2);\\nlong double t2 = pow(spin,2);\\nlong double t3 = cos(th);\\nlong double t4 = pow(t3,2);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t7 = 2*th;\\nlong double t8 = cos(t7);\\nlong double t9 = t2*t8;\\nlong double t11 = t1 + t9;\\nlong double t12 = pow(t11,-2);\\nlong double t15 = sin(th);\\nlong double t16 = pow(t15,2);\\nlong double t20 = 1/r;\\nlong double t21 = defpar*spin*t20;\\nlong double t22 = 2 + r;\\nlong double t23 = r*t22;\\nlong double t24 = t2 + t23;\\nlong double t25 = -(spin*t12*t16*t24*t6);\\nlong double t13 = -2 + r;\\nlong double t14 = r*t13;\\ng[0][0] = t12*(t14 + t2 - 4*t16*t2)*t6;\\ng[0][1] = t21;\\ng[0][2] = 0;\\ng[0][3] = t25;\\ng[1][0] = t21;\\ng[1][1] = t6/(-2*r + t1 + t2);\\ng[1][2] = 0;\\ng[1][3] = 0;\\ng[2][0] = 0;\\ng[2][1] = 0;\\ng[2][2] = t6;\\ng[2][3] = 0;\\ng[3][0] = t25;\\ng[3][1] = 0;\\ng[3][2] = 0;\\ng[3][3] = t12*t16*(pow(t1 + t2,2) - t16*t2*(t14 + t2))*t6;\\n}\""],"Output",CellLabel->"Out[114]= "],
Cell[TextData[{"Metric r derivatives"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"dg[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"dg[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"dg[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"dg[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"dg[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"dg[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"dg[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"dg[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"dg[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"dg[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"dg[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"dg[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"dg[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"dg[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"dg[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"dg[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], "\n", RowBox[{RowBox[{"header", "=", "\"void metric_rderivatives(long double r, long double th, long double dg[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metricdr", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input",CellLabel->"In[115]:="],
Cell[BoxData["\"long double t1 = pow(r,2);\\nlong double t2 = pow(spin,2);\\nlong double t14 = pow(spin,4);\\nlong double t3 = 2*th;\\nlong double t4 = cos(t3);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t7 = pow(t6,-3);\\nlong double t8 = pow(r,4);\\nlong double t12 = pow(r,3);\\nlong double t37 = 1 + r;\\nlong double t26 = 4*th;\\nlong double t27 = cos(t26);\\nlong double t31 = pow(r,-2);\\nlong double t32 = -(defpar*spin*t31);\\nlong double t24 = -r;\\nlong double t25 = 1 + t24;\\nlong double t33 = -4*t8;\\nlong double t34 = -6*t1*t2;\\nlong double t35 = -6*t12*t2;\\nlong double t36 = -3*r*t14;\\nlong double t38 = 3*t1;\\nlong double t39 = t2 + t38;\\nlong double t40 = 2*t2*t37*t39*t4;\\nlong double t41 = t14*t27*t37;\\nlong double t42 = t14 + t33 + t34 + t35 + t36 + t40 + t41;\\nlong double t43 = sin(th);\\nlong double t44 = pow(t43,2);\\nlong double t45 = -0.5*(spin*t42*t44*t7);\\nlong double t79 = pow(spin,6);\\nlong double t80 = 6*th;\\nlong double t81 = cos(t80);\\ndg[0][0] = (t7*(-t14 + 5*r*t14 + 6*t1*t2 + 2*t12*t2 - t14*t25*t27 - 2*t2*((3 + r)*t1 + (1 + 3*r)*t2)*t4 + 4*t8))/2.;\\ndg[0][1] = t32;\\ndg[0][2] = 0;\\ndg[0][3] = t45;\\ndg[1][0] = t32;\\ndg[1][1] = (2*(r*(t2 + t24) + t2*t25*pow(cos(th),2)))/pow((-2 + r)*r + t2,2);\\ndg[1][2] = 0;\\ndg[1][3] = 0;\\ndg[2][0] = 0;\\ndg[2][1] = 0;\\ndg[2][2] = 2*r;\\ndg[2][3] = 0;\\ndg[3][0] = t45;\\ndg[3][1] = 0;\\ndg[3][2] = 0;\\ndg[3][3] = (t44*t7*(16*pow(r,7) - 18*t1*t14 - 6*t12*t14 + 2*r*t14*(-3*r + 7*t1 + 4*t2)*t27 - 8*t2*t8 + t2*t4*((1 + 7*r)*t14 + 8*(3 + 5*r)*t1*t2 + 8*(1 + 6*r)*t8) - t79*t81 + r*t79*t81))/8.;\""],"Output",CellLabel->"Out[116]= "],
Cell[TextData[{"Metric r2 derivatives"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"dg2[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"dg2[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"dg2[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"dg2[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"dg2[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"dg2[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"dg2[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"dg2[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"dg2[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"dg2[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"dg2[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"dg2[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"dg2[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"dg2[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"dg2[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"dg2[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], "\n", RowBox[{RowBox[{"header", "=", "\"void metric_r2derivatives(long double r, long double th, long double dg2[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metricdr2", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input",CellLabel->"In[120]:="],
Cell[BoxData["\"long double t2 = pow(spin,2);\\nlong double t1 = pow(r,2);\\nlong double t11 = pow(r,3);\\nlong double t19 = 3*r;\\nlong double t15 = pow(spin,4);\\nlong double t3 = 2*th;\\nlong double t4 = cos(t3);\\nlong double t17 = pow(spin,6);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t7 = pow(t6,-4);\\nlong double t8 = pow(r,5);\\nlong double t9 = 16*t8;\\nlong double t12 = 48*t11*t2;\\nlong double t13 = pow(r,4);\\nlong double t30 = 4*th;\\nlong double t31 = cos(t30);\\nlong double t33 = 6*th;\\nlong double t34 = cos(t33);\\nlong double t38 = pow(r,-3);\\nlong double t39 = 2*defpar*spin*t38;\\nlong double t40 = 36*t13*t2;\\nlong double t41 = 48*t1*t15;\\nlong double t42 = 2*t17;\\nlong double t43 = 9*r;\\nlong double t44 = 20 + t43;\\nlong double t45 = 4*t11*t44;\\nlong double t46 = 7*r;\\nlong double t47 = 6 + t46;\\nlong double t48 = 8*r*t2*t47;\\nlong double t49 = 5*t15;\\nlong double t50 = t45 + t48 + t49;\\nlong double t51 = -(t2*t4*t50);\\nlong double t52 = 4*t1;\\nlong double t53 = t2 + t52;\\nlong double t54 = 2*t15*t31*t53;\\nlong double t55 = t17*t34;\\nlong double t56 = t12 + t40 + t41 + t42 + t51 + t54 + t55 + t9;\\nlong double t57 = sin(th);\\nlong double t58 = pow(t57,2);\\nlong double t59 = -0.25*(spin*t56*t58*t7);\\nlong double t81 = pow(spin,8);\\ndg2[0][0] = -0.25*(t7*(t12 + 56*t1*t15 + 6*t17 + 12*t13*t2 + 2*t15*(8*t1 + 3*t2)*t31 - t17*t34 - t2*(11*t15 + 4*t11*(20 + t19) + 24*r*(2 + t19)*t2)*t4 + t9));\\ndg2[0][1] = t39;\\ndg2[0][2] = 0;\\ndg2[0][3] = t59;\\ndg2[1][0] = t39;\\ndg2[1][1] = (2*(2*t11 + t15 - 3*t1*t2 - t2*(-4 + 6*r - 3*t1 + t2)*pow(cos(th),2)))/pow((-2 + r)*r + t2,3);\\ndg2[1][2] = 0;\\ndg2[1][3] = 0;\\ndg2[2][0] = 0;\\ndg2[2][1] = 0;\\ndg2[2][2] = 2;\\ndg2[2][3] = 0;\\ndg2[3][0] = t59;\\ndg2[3][1] = 0;\\ndg2[3][2] = 0;\\ndg2[3][3] = (t58*t7*(32*pow(r,8) + 176*t11*t15 + 276*t13*t15 + 48*r*t17 + 120*t1*t17 + 4*t15*((20 + 39*r)*t11 + 2*t15 + 2*r*(6 + 5*r)*t2)*t31 + 32*t1*t17*t34 + 32*t2*t8 + 8*t2*t4*(-4*r*(3 + 2*r)*t15 + t17 - 2*(16 + 15*r)*t11*t2 + 4*(-1 + 4*r)*t8) + 7*t81 + 8*t34*t81 + t81*cos(8*th)))/16.;\""],"Output",CellLabel->"Out[121]= "],
Cell[TextData[{"Covariant Metric Components"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{"meet", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n   \""}], ",", RowBox[{"\"out(0)\"", "->", "\"gu[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"gu[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"gu[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"gu[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"gu[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"gu[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"gu[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"gu[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"gu[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"gu[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"gu[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"gu[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"gu[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"gu[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"gu[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"gu[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], "\n", RowBox[{RowBox[{"header", "=", "\"void uppermetric(long double r, long double th, long double gu[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metricupper", "=", RowBox[{"header", "<>", "meet", "<>", "footer"}]}], ";"}]}],"Input",CellLabel->"In[125]:="],
Cell[BoxData["\"long double t1 = pow(r,2);\\nlong double t2 = pow(spin,2);\\nlong double t14 = sin(th);\\nlong double t15 = pow(t14,2);\\nlong double t3 = cos(th);\\nlong double t4 = pow(t3,2);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t16 = t1 + t2;\\nlong double t17 = pow(t16,2);\\nlong double t18 = -2 + r;\\nlong double t19 = r*t18;\\nlong double t20 = t19 + t2;\\nlong double t21 = -(t15*t2*t20);\\nlong double t22 = t17 + t21;\\nlong double t8 = 2*th;\\nlong double t9 = cos(t8);\\nlong double t11 = t2*t9;\\nlong double t12 = t1 + t11;\\nlong double t13 = pow(t12,2);\\nlong double t23 = 2 + r;\\nlong double t24 = r*t23;\\nlong double t25 = t2 + t24;\\nlong double t26 = pow(t25,2);\\nlong double t27 = pow(t6,3);\\nlong double t28 = pow(t14,4);\\nlong double t29 = t1*t2*t26*t27*t28;\\nlong double t30 = pow(defpar,2);\\nlong double t31 = t13*t2*t20*t30;\\nlong double t32 = pow(r,3);\\nlong double t33 = r*t2*t4;\\nlong double t34 = t32 + t33;\\nlong double t35 = pow(t34,2);\\nlong double t36 = -4*t15*t2;\\nlong double t37 = t19 + t2 + t36;\\nlong double t38 = -(t35*t37);\\nlong double t39 = t31 + t38;\\nlong double t40 = t15*t22*t39*t6;\\nlong double t41 = t29 + t40;\\nlong double t42 = 1/t41;\\nlong double t7 = pow(t6,2);\\nlong double t44 = defpar*r*spin;\\nlong double t45 = 1/r;\\nlong double t46 = pow(spin,3);\\nlong double t47 = defpar*t4*t45*t46;\\nlong double t48 = t44 + t47;\\nlong double t49 = t1*t13*t15*t20*t22*t42*t48;\\nlong double t50 = -(spin*t1*t13*t15*t25*t42*t7);\\ngu[0][0] = -(t1*t13*t15*t22*t42*t7);\\ngu[0][1] = t49;\\ngu[0][2] = 0;\\ngu[0][3] = t50;\\ngu[1][0] = t49;\\ngu[1][1] = -(t1*t15*t20*(-(t15*t2*t26) + t22*t37)*t42*t7);\\ngu[1][2] = 0;\\ngu[1][3] = defpar*r*t13*t15*t2*t20*t25*t42*t6;\\ngu[2][0] = 0;\\ngu[2][1] = 0;\\ngu[2][2] = 1/t6;\\ngu[2][3] = 0;\\ngu[3][0] = t50;\\ngu[3][1] = spin*t1*t13*t15*t20*t25*t42*t48;\\ngu[3][2] = 0;\\ngu[3][3] = -(t1*pow(t12,4)*t20*t42*(-((t2*t30)/pow(r,2)) + (t37*t7)/(pow(t12,2)*t20)));\""],"Output",CellLabel->"Out[126]= "],
Cell[BoxData[{RowBox[{RowBox[{"output", "=", RowBox[{"metric", "<>", "\"\\n\\n\"", "<>", "metricupper", "<>", "\"\\n\\n\"", "<>", "metricdr", "<>", "\"\\n\\n\"", "<>", "metricdr2"}]}], ";"}], "\n", "\n", RowBox[{"(*", RowBox[{"write", "to", RowBox[{"metric", ".", "cpp"}], "file"}], "*)"}], "\n", RowBox[{RowBox[{"SetDirectory", "[", "\"C:\\\\Users\\\\Administrator\\\\Documents\\\\script\\\\raytransfer\"", "]"}], ";"}], "\n", RowBox[{"Export", "[", RowBox[{"\"metric.cpp\"", ",", "output", ",", "\"Text\""}], "]"}]}],"Input",CellLabel->"In[130]:="],
Cell[BoxData["\"metric.cpp\""],"Output",CellLabel->"Out[132]= "],
Cell[TextData[{"Christoffel Symbols"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"christ[0][0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"christ[0][0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"christ[0][0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"christ[0][0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"christ[0][1][1]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"christ[0][1][2]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"christ[0][1][3]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"christ[0][2][2]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"christ[0][2][3]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"christ[0][3][3]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"christ[1][0][0]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"christ[1][0][1]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"christ[1][0][2]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"christ[1][0][3]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"christ[1][1][1]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"christ[1][1][2]\""}], ",", RowBox[{"\"out(16)\"", "->", "\"christ[1][1][3]\""}], ",", RowBox[{"\"out(17)\"", "->", "\"christ[1][2][2]\""}], ",", RowBox[{"\"out(18)\"", "->", "\"christ[1][2][3]\""}], ",", RowBox[{"\"out(19)\"", "->", "\"christ[1][3][3]\""}], ",", RowBox[{"\"out(20)\"", "->", "\"christ[2][0][0]\""}], ",", RowBox[{"\"out(21)\"", "->", "\"christ[2][0][1]\""}], ",", RowBox[{"\"out(22)\"", "->", "\"christ[2][0][2]\""}], ",", RowBox[{"\"out(23)\"", "->", "\"christ[2][0][3]\""}], ",", RowBox[{"\"out(24)\"", "->", "\"christ[2][1][1]\""}], ",", RowBox[{"\"out(25)\"", "->", "\"christ[2][1][2]\""}], ",", RowBox[{"\"out(26)\"", "->", "\"christ[2][1][3]\""}], ",", RowBox[{"\"out(27)\"", "->", "\"christ[2][2][2]\""}], ",", RowBox[{"\"out(28)\"", "->", "\"christ[2][2][3]\""}], ",", RowBox[{"\"out(29)\"", "->", "\"christ[2][3][3]\""}], ",", RowBox[{"\"out(30)\"", "->", "\"christ[3][0][0]\""}], ",", RowBox[{"\"out(31)\"", "->", "\"christ[3][0][1]\""}], ",", RowBox[{"\"out(32)\"", "->", "\"christ[3][0][2]\""}], ",", RowBox[{"\"out(33)\"", "->", "\"christ[3][0][3]\""}], ",", RowBox[{"\"out(34)\"", "->", "\"christ[3][1][1]\""}], ",", RowBox[{"\"out(35)\"", "->", "\"christ[3][1][2]\""}], ",", RowBox[{"\"out(36)\"", "->", "\"christ[3][1][3]\""}], ",", RowBox[{"\"out(37)\"", "->", "\"christ[3][2][2]\""}], ",", RowBox[{"\"out(38)\"", "->", "\"christ[3][2][3]\""}], ",", RowBox[{"\"out(39)\"", "->", "\"christ[3][3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], "\n", RowBox[{RowBox[{"header", "=", "\"void christoffel(long double r, long double th, long double christ[4][4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"christoffel", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input",CellLabel->"In[133]:="],
Cell[BoxData["\"long double t1 = pow(r,2);\\nlong double t4 = pow(spin,2);\\nlong double t24 = pow(spin,4);\\nlong double t14 = 2*th;\\nlong double t15 = cos(t14);\\nlong double t2 = -2 + r;\\nlong double t3 = r*t2;\\nlong double t5 = t3 + t4;\\nlong double t39 = sin(th);\\nlong double t40 = pow(t39,2);\\nlong double t9 = cos(th);\\nlong double t11 = pow(t9,2);\\nlong double t49 = t11*t4;\\nlong double t50 = t1 + t49;\\nlong double t41 = t1 + t4;\\nlong double t42 = pow(t41,2);\\nlong double t43 = -(t4*t40*t5);\\nlong double t44 = t42 + t43;\\nlong double t16 = t15*t4;\\nlong double t17 = t1 + t16;\\nlong double t22 = pow(r,3);\\nlong double t18 = 1/t17;\\nlong double t45 = 2 + r;\\nlong double t46 = r*t45;\\nlong double t47 = t4 + t46;\\nlong double t28 = 3*r;\\nlong double t19 = pow(r,4);\\nlong double t20 = -4*t19;\\nlong double t21 = -6*t1*t4;\\nlong double t23 = -2*t22*t4;\\nlong double t25 = -5*r*t24;\\nlong double t26 = 3 + r;\\nlong double t27 = t1*t26;\\nlong double t29 = 1 + t28;\\nlong double t30 = t29*t4;\\nlong double t31 = t27 + t30;\\nlong double t32 = 2*t15*t31*t4;\\nlong double t33 = -r;\\nlong double t34 = 1 + t33;\\nlong double t35 = 4*th;\\nlong double t36 = cos(t35);\\nlong double t37 = t24*t34*t36;\\nlong double t38 = t20 + t21 + t23 + t24 + t25 + t32 + t37;\\nlong double t48 = pow(t47,2);\\nlong double t51 = pow(t50,3);\\nlong double t52 = pow(t39,4);\\nlong double t53 = t1*t4*t48*t51*t52;\\nlong double t54 = pow(defpar,2);\\nlong double t55 = pow(t17,2);\\nlong double t56 = t4*t5*t54*t55;\\nlong double t57 = r*t11*t4;\\nlong double t58 = t22 + t57;\\nlong double t59 = pow(t58,2);\\nlong double t60 = -4*t4*t40;\\nlong double t61 = t3 + t4 + t60;\\nlong double t62 = -(t59*t61);\\nlong double t63 = t56 + t62;\\nlong double t64 = t40*t44*t50*t63;\\nlong double t65 = t53 + t64;\\nlong double t66 = 1/t65;\\nlong double t68 = pow(t50,2);\\nlong double t92 = t15*t4*t5;\\nlong double t6 = defpar*r*spin;\\nlong double t7 = 1/r;\\nlong double t8 = pow(spin,3);\\nlong double t12 = defpar*t11*t7*t8;\\nlong double t13 = t12 + t6;\\nlong double t77 = 1 + r;\\nlong double t71 = 2*t1;\\nlong double t111 = t16 + t4 + t71;\\nlong double t145 = pow(r,9);\\nlong double t148 = pow(r,10);\\nlong double t151 = pow(r,6);\\nlong double t154 = pow(r,7);\\nlong double t143 = pow(r,8);\\nlong double t159 = pow(spin,6);\\nlong double t162 = pow(r,5);\\nlong double t167 = pow(spin,8);\\nlong double t173 = pow(spin,10);\\nlong double t181 = -15*r;\\nlong double t221 = 4*t54;\\nlong double t241 = 6*th;\\nlong double t242 = cos(t241);\\nlong double t176 = pow(spin,12);\\nlong double t254 = 8*th;\\nlong double t255 = cos(t254);\\nlong double t121 = pow(t39,3);\\nlong double t69 = r + t4;\\nlong double t70 = 2*t22*t69;\\nlong double t72 = t28 + t4 + t71;\\nlong double t73 = -2*r*t15*t4*t72;\\nlong double t74 = 2*t4;\\nlong double t75 = t1 + t28 + t74;\\nlong double t76 = -(r*t75);\\nlong double t78 = t15*t4*t77;\\nlong double t79 = t76 + t78;\\nlong double t80 = -2*t11*t4*t79;\\nlong double t81 = t70 + t73 + t80;\\nlong double t86 = 2*t42*t48;\\nlong double t87 = 6 + r;\\nlong double t88 = -(t22*t87);\\nlong double t89 = 4 + t28;\\nlong double t90 = -(r*t4*t89);\\nlong double t91 = -2*t24;\\nlong double t93 = t88 + t90 + t91 + t92;\\nlong double t94 = 2*t19;\\nlong double t95 = 2 + t28;\\nlong double t96 = r*t4*t95;\\nlong double t97 = t24 + t92 + t94 + t96;\\nlong double t98 = -(t93*t97);\\nlong double t99 = t86 + t98;\\nlong double t100 = sin(t14);\\nlong double t286 = pow(t17,-3);\\nlong double t102 = -6*t22*t4;\\nlong double t103 = -3*r*t24;\\nlong double t104 = 3*t1;\\nlong double t105 = t104 + t4;\\nlong double t106 = 2*t105*t15*t4*t77;\\nlong double t107 = t24*t36*t77;\\nlong double t108 = t102 + t103 + t106 + t107 + t20 + t21 + t24;\\nlong double t287 = -(t4*t40*t48);\\nlong double t288 = t44*t61;\\nlong double t289 = t287 + t288;\\nlong double t117 = t33 + t4;\\nlong double t123 = t22*t26;\\nlong double t124 = 2*r;\\nlong double t125 = 1 + t124;\\nlong double t126 = r*t125*t4;\\nlong double t127 = t123 + t126 + t24;\\nlong double t128 = r*t127;\\nlong double t129 = -t1;\\nlong double t130 = t129 + t4;\\nlong double t131 = -(t130*t15*t4);\\nlong double t132 = t128 + t131;\\nlong double t139 = pow(r,11);\\nlong double t141 = pow(r,12);\\nlong double t178 = -2*t1;\\nlong double t179 = -2 + r + t178;\\nlong double t180 = 32*t143*t179;\\nlong double t182 = 2 + t181;\\nlong double t183 = r*t182;\\nlong double t184 = -12*r;\\nlong double t185 = 5*t1;\\nlong double t186 = 4 + t184 + t185;\\nlong double t187 = t186*t54;\\nlong double t188 = t183 + t187;\\nlong double t189 = 8*t151*t188*t4;\\nlong double t190 = -64*t54;\\nlong double t191 = -12*t54;\\nlong double t192 = 7 + t191;\\nlong double t193 = 8*r*t192;\\nlong double t194 = 32*t54;\\nlong double t195 = -27 + t194;\\nlong double t196 = 3*t1*t195;\\nlong double t197 = 4 + t190 + t193 + t196;\\nlong double t198 = t19*t197*t24;\\nlong double t199 = 8 + t181;\\nlong double t200 = r*t199;\\nlong double t201 = -4*r;\\nlong double t202 = 13*t1;\\nlong double t203 = 4 + t201 + t202;\\nlong double t204 = 3*t203*t54;\\nlong double t205 = t200 + t204;\\nlong double t206 = 2*t1*t159*t205;\\nlong double t207 = -7*r;\\nlong double t208 = 6 + t207;\\nlong double t209 = -4*t208*t54;\\nlong double t210 = -5*r;\\nlong double t211 = t209 + t210;\\nlong double t212 = r*t167*t211;\\nlong double t213 = 6*t173*t54;\\nlong double t214 = t180 + t189 + t198 + t206 + t212 + t213;\\nlong double t216 = 10*r;\\nlong double t217 = -17*t1;\\nlong double t218 = -16 + t216 + t217;\\nlong double t219 = t151*t218;\\nlong double t220 = 8*t54;\\nlong double t222 = -15 + t221;\\nlong double t223 = t1*t222;\\nlong double t224 = 6*r*t54;\\nlong double t225 = r + t224;\\nlong double t226 = -2*t225;\\nlong double t227 = -2 + t220 + t223 + t226;\\nlong double t228 = 2*t19*t227*t4;\\nlong double t229 = 8*t1;\\nlong double t230 = 12*r;\\nlong double t231 = -9*t1;\\nlong double t232 = 4 + t230 + t231;\\nlong double t233 = t232*t54;\\nlong double t234 = t229 + t233;\\nlong double t235 = -2*t1*t234*t24;\\nlong double t236 = -1 + t221;\\nlong double t237 = 3*t1*t159*t236;\\nlong double t238 = 2*t167*t54;\\nlong double t239 = t219 + t228 + t235 + t237 + t238;\\nlong double t262 = 16*t154;\\nlong double t263 = -8*t19*t4;\\nlong double t264 = -18*t1*t24;\\nlong double t265 = -6*t22*t24;\\nlong double t266 = 6*r;\\nlong double t267 = 1 + t266;\\nlong double t268 = 8*t19*t267;\\nlong double t269 = 5*r;\\nlong double t270 = 3 + t269;\\nlong double t271 = 8*t1*t270*t4;\\nlong double t272 = 7*r;\\nlong double t273 = 1 + t272;\\nlong double t274 = t24*t273;\\nlong double t275 = t268 + t271 + t274;\\nlong double t276 = t15*t275*t4;\\nlong double t277 = -3*r;\\nlong double t278 = 7*t1;\\nlong double t279 = 4*t4;\\nlong double t280 = t277 + t278 + t279;\\nlong double t281 = 2*r*t24*t280*t36;\\nlong double t282 = -(t159*t242);\\nlong double t283 = r*t159*t242;\\nlong double t284 = t262 + t263 + t264 + t265 + t276 + t281 + t282 + t283;\\nlong double t360 = 1/t50;\\nlong double t110 = 1/t5;\\nlong double t112 = -3 + r;\\nlong double t138 = pow(t111,2);\\nchrist[0][0][0] = (t1*t13*t18*t38*t40*t44*t5*t66)/4.;\\nchrist[0][0][1] = -0.5*(t1*t18*t40*t66*t68*(-0.5*(t38*t44) + t4*t40*t47*t81));\\nchrist[0][0][2] = (t1*t100*t18*t4*t40*t66*t68*t99)/4.;\\nchrist[0][0][3] = (spin*t1*t108*t13*t18*t44*t5*t52*t66)/4.;\\nchrist[0][1][1] = (defpar*spin*t110*t111*(2*t112*t22 + t24 + r*(-1 + 4*r)*t4 + t117*t15*t4)*t40*t44*t55*t66)/4.;\\nchrist[0][1][2] = -(t1*t121*t13*t4*t44*t55*t66*t9);\\nchrist[0][1][3] = -0.5*(spin*t111*t132*t52*t59*t66);\\nchrist[0][2][2] = -(t13*t22*t40*t44*t5*t55*t66);\\nchrist[0][2][3] = (8*t1*t121*t138*(-4*t1 + t19 + t24 + 2*t1*t4)*t8*t9)/(64*t139 - 32*t141 - 24*t151*t159 + 144*t159*t162 - 3*t1*t173 + 16*t159*t19 - 15*t167*t19 + 30*t167*t22 - 12*t143*t24 + 64*t151*t24 + 312*t154*t24 - 14*t151*t159*t242 + 16*t159*t162*t242 - 6*t1*t173*t242 - 8*t159*t19*t242 - 20*t167*t19*t242 - t1*t173*t255 - t167*t19*t255 + 2*t167*t22*t255 + 4*t239*t24*t36 + 128*t143*t4 + 192*t145*t4 - 32*t148*t4 + 2*t15*t214*t4 + 96*t151*t159*t54 - 96*t159*t162*t54 - 32*t1*t167*t54 + 48*t1*t173*t54 + 8*t176*t54 + 64*t159*t19*t54 + 88*t167*t19*t54 - 96*t167*t22*t54 + 80*t143*t24*t54 - 64*t151*t24*t54 - 64*t154*t24*t54 + 16*t1*t167*t242*t54 - 16*r*t173*t242*t54 + 8*t1*t173*t242*t54 + 4*t176*t242*t54 + 4*t167*t19*t242*t54 - 16*t167*t22*t242*t54 - 64*t145*t4*t54 + 32*t148*t4*t54);\\nchrist[0][3][3] = -0.0625*(t1*t13*t18*t284*t44*t5*t52*t66);\\nchrist[1][0][0] = -0.25*(t1*t286*t289*t38*t40*t5*t66*t68);\\nchrist[1][0][1] = -0.5*(t1*t13*t18*t40*t5*t66*((t38*t44)/2. - t4*t40*t47*t81));\\nchrist[1][0][2] = -0.25*(t1*t100*t13*t18*t4*t40*t5*t66*t99);\\nchrist[1][0][3] = -0.25*(spin*t108*t286*t289*t5*t52*t59*t66);\\nchrist[1][1][1] = -0.5*(t1*t40*t5*t50*((2*t4*t44*t54*t55)/pow(r,3) - ((2*r*t117 + 2*t11*t34*t4)*t50*(t4*t40*t48 - t44*t61))/pow(t5,2))*t66);\\nchrist[1][1][2] = t1*t121*t289*t4*t66*t68*t9;\\nchrist[1][1][3] = (spin*t1*t111*t13*t132*t5*t52*t66)/2.;\\nchrist[1][2][2] = t22*t289*t40*t5*t66*t68;\\nchrist[1][2][3] = (32*defpar*r*t121*t24*t47*pow(t5,2)*t50*t9)/(-64*t139 + 32*t141 + 24*t151*t159 - 144*t159*t162 + 3*t1*t173 - 16*t159*t19 + 15*t167*t19 - 30*t167*t22 + 12*t143*t24 - 64*t151*t24 - 312*t154*t24 + 14*t151*t159*t242 - 16*t159*t162*t242 + 6*t1*t173*t242 + 8*t159*t19*t242 + 20*t167*t19*t242 + t1*t173*t255 + t167*t19*t255 - 2*t167*t22*t255 - 4*t239*t24*t36 - 128*t143*t4 - 192*t145*t4 + 32*t148*t4 - 2*t15*t214*t4 - 96*t151*t159*t54 + 96*t159*t162*t54 + 32*t1*t167*t54 - 48*t1*t173*t54 - 8*t176*t54 - 64*t159*t19*t54 - 88*t167*t19*t54 + 96*t167*t22*t54 - 80*t143*t24*t54 + 64*t151*t24*t54 + 64*t154*t24*t54 - 16*t1*t167*t242*t54 + 16*r*t173*t242*t54 - 8*t1*t173*t242*t54 - 4*t176*t242*t54 - 4*t167*t19*t242*t54 + 16*t167*t22*t242*t54 + 64*t145*t4*t54 - 32*t148*t4*t54);\\nchrist[1][3][3] = (t284*t286*t289*t5*t52*t59*t66)/16.;\\nchrist[2][0][0] = -0.5*(t100*t286*t360*t4*t93);\\nchrist[2][0][1] = 0;\\nchrist[2][0][2] = 0;\\nchrist[2][0][3] = (spin*t100*t286*t360*t42*t47)/2.;\\nchrist[2][1][1] = t110*t360*t39*t4*t9;\\nchrist[2][1][2] = r*t360;\\nchrist[2][1][3] = 0;\\nchrist[2][2][2] = -(t360*t39*t4*t9);\\nchrist[2][2][3] = 0;\\nchrist[2][3][3] = t286*t39*(-2*t100*t39*t4*t44 - t17*t44*t9 + t17*t360*t4*t40*t44*t9 + t17*t4*t40*t5*t9);\\nchrist[3][0][0] = (defpar*r*t18*t38*t4*t40*t47*t5*t50*t66)/4.;\\nchrist[3][0][1] = -0.25*(spin*t18*t40*t66*(-(t38*t47*t59) - 2*t63*t81));\\nchrist[3][0][2] = (spin*t100*t47*t5*t66*(t15*(t1*t159*(15 + t190) + 48*t151*t4 + 16*t19*t24*(3 - 2*t54) - 32*t167*t54) + t1*(32*t151 + 10*t159 + 36*t1*t24 + t159*t242 + 48*t19*t4 - 32*t159*t54 - 64*t1*t24*t54 - 32*t19*t4*t54 + 6*t24*t36*(t4 + t71))))/64.;\\nchrist[3][0][3] = (defpar*r*t108*t18*t47*t5*t50*t52*t66*t8)/4.;\\nchrist[3][1][1] = (defpar*t1*t110*pow(t17,4)*t4*t40*t47*t50*t66*(t11*t117*t4 + t1*(r*t112 + t74)))/pow(t22 + r*t15*t4,2);\\nchrist[3][1][2] = -(defpar*r*t121*t24*t47*t50*t55*t66*t9);\\nchrist[3][1][3] = -0.5*(t18*t66*(-(t63*(2*r*t40*(t1*(t19 - t24 + t117*t4*t40) + t15*(t159 + 4*t1*t24 + 3*t19*t4 - t24*t40*(t277 + t4 + t71))) - 2*t11*t24*t52*(-(t15*t34*t4) + r*(t74 + 3*r*t77)))) + t1*t4*t47*t52*t68*t81));\\nchrist[3][2][2] = -(defpar*t1*t4*t40*t47*t5*t50*t55*t66);\\nchrist[3][2][3] = t18*t66*((t1*t121*t138*t4*t42*t48*t9)/4. - t39*t63*(-2*t100*t39*t4*t44*t50 + t17*t4*t40*t44*t9 - t17*t44*t50*t9 + t17*t4*t40*t5*t50*t9));\\nchrist[3][3][3] = -0.0625*(defpar*r*t18*t284*t4*t47*t5*t50*t52*t66);\""],"Output",CellLabel->"Out[134]= "],
Cell[BoxData[{RowBox[{RowBox[{"output", "=", "christoffel"}], ";"}], "\n", "\n", RowBox[{"(*", RowBox[{"write", "to", "christoffel", "file"}], "*)"}], "\n", RowBox[{RowBox[{"Export", "[", RowBox[{"\"christoffel.cpp\"", ",", "output", ",", "\"Text\""}], "]"}], ";"}]}],"Input",CellLabel->"In[138]:="]
}]
