Notebook[{
Cell[BoxData[{RowBox[{"Remove", "[", "\"Global`*\"", "]"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"f", "=", RowBox[{"epsi", "*", "M", "*", "M", "*", RowBox[{"M", "/", "r"}]}]}], ";"}], "\n", RowBox[{RowBox[{"A1", "=", RowBox[{"1", "+", RowBox[{"a13", "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"A2", "=", RowBox[{"1", "+", RowBox[{"a22", "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"A5", "=", RowBox[{"1", "+", RowBox[{"a52", "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}], "*", RowBox[{"(", RowBox[{"M", "/", "r"}], ")"}]}]}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"B", "=", RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[{"r", "*", "r"}], "+", RowBox[{"a", "*", "a"}]}], ")"}], "*", "A1"}], "-", RowBox[{"a", "*", "a", "*", "A2", "*", RowBox[{"Sin", "[", "theta", "]"}], "*", RowBox[{"Sin", "[", "theta", "]"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"Sigma", "=", RowBox[{RowBox[{"r", "*", "r"}], "+", RowBox[{"a", "*", "a", "*", RowBox[{"Cos", "[", "theta", "]"}], "*", RowBox[{"Cos", "[", "theta", "]"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"Sigmavar", "=", RowBox[{"Sigma", "+", "f"}]}], ";"}], "\n", RowBox[{RowBox[{"Delta", "=", RowBox[{RowBox[{"r", "*", "r"}], "-", RowBox[{"2", "*", "M", "*", "r"}], "+", RowBox[{"a", "*", "a"}]}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"epsi", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"a13", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"a22", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"a52", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"b1", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"b2", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"c1", "=", "0"}], ";"}], "\n", RowBox[{RowBox[{"c2", "=", "0"}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"a13", "=", "defpar"}], ";"}]}],"Input"],
Cell[TextData[{"Covariant Metric Components"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"gtt", "=", RowBox[{RowBox[{"-", "Sigmavar"}], "*", RowBox[{RowBox[{"(", RowBox[{"Delta", "-", RowBox[{"a", "*", "a", "*", "A2", "*", "A2", "*", RowBox[{"Sin", "[", "theta", "]"}], "*", RowBox[{"Sin", "[", "theta", "]"}]}]}], ")"}], "/", RowBox[{"(", RowBox[{"B", "*", "B"}], ")"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"grr", "=", RowBox[{"Sigmavar", "/", RowBox[{"(", RowBox[{"Delta", "*", "A5"}], ")"}]}]}], ";"}], "\n", RowBox[{RowBox[{"gthth", "=", "Sigmavar"}], ";"}], "\n", RowBox[{RowBox[{"gpp", "=", RowBox[{RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[{"r", "*", "r"}], "+", RowBox[{"a", "*", "a"}]}], ")"}], "*", RowBox[{"(", RowBox[{RowBox[{"r", "*", "r"}], "+", RowBox[{"a", "*", "a"}]}], ")"}], "*", "A1", "*", "A1"}], "-", RowBox[{"a", "*", "a", "*", "Delta", "*", RowBox[{"Sin", "[", "theta", "]"}], "*", RowBox[{"Sin", "[", "theta", "]"}]}]}], ")"}], "*", "Sigmavar", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", RowBox[{"(", RowBox[{"B", "*", "B"}], ")"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"gtp", "=", RowBox[{RowBox[{"-", "a"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[{"r", "^", "2"}], "+", RowBox[{"a", "^", "2"}]}], ")"}], "*", "A1", "*", "A2"}], "-", "Delta"}], ")"}], "*", "Sigmavar", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", RowBox[{"B", "^", "2"}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"gtr", "=", RowBox[{RowBox[{"b1", "*", RowBox[{"a", "/", "r"}]}], "+", RowBox[{"b2", "*", "a", "*", RowBox[{"M", "/", RowBox[{"r", "^", "2"}]}]}]}]}], ";"}], "\n", RowBox[{RowBox[{"grp", "=", RowBox[{RowBox[{"c1", "*", "a", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", "r"}]}], "+", RowBox[{"c2", "*", "a", "*", "M", "*", RowBox[{RowBox[{RowBox[{"Sin", "[", "theta", "]"}], "^", "2"}], "/", RowBox[{"r", "^", "2"}]}]}]}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"G", "=", RowBox[{"Simplify", "[", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"gtt", ",", "gtr", ",", "0", ",", "gtp"}], "}"}], ",", RowBox[{"{", RowBox[{"gtr", ",", "grr", ",", "0", ",", "grp"}], "}"}], ",", RowBox[{"{", RowBox[{"0", ",", "0", ",", "gthth", ",", "0"}], "}"}], ",", RowBox[{"{", RowBox[{"gtp", ",", "grp", ",", "0", ",", "gpp"}], "}"}]}], "}"}], "]"}]}], ";"}], "\n", RowBox[{"G", "//", "MatrixForm"}]}],"Input"],
Cell[BoxData[TagBox[RowBox[{"(", "\[NoBreak]", GridBox[{{FractionBox[RowBox[{RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["r", "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]], "0", "0", RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "3"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]]}]}, {"0", FractionBox[RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], RowBox[{SuperscriptBox["a", "2"], "-", RowBox[{"2", " ", "M", " ", "r"}], "+", SuperscriptBox["r", "2"]}]], "0", "0"}, {"0", "0", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], "0"}, {RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "3"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]]}], "0", "0", FractionBox[RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]]}}, RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], Function[BoxForm`e$, MatrixForm[BoxForm`e$]]]],"Output",CellLabel->"Out[496]//MatrixForm= "],
Cell[BoxData[{RowBox[{"(*", RowBox[{"test", "G", "numerically"}], "*)"}], "\n", RowBox[{RowBox[{"num", "=", RowBox[{"{", RowBox[{RowBox[{"r", "->", "1.0"}], ",", RowBox[{"theta", "->", "0.2"}], ",", RowBox[{"M", "->", "1"}], ",", RowBox[{"a", "->", "0.5"}]}], "}"}]}], ";"}], "\n", RowBox[{RowBox[{"Evaluate", "[", RowBox[{"grr", "/.", "num"}], "]"}], "//", "MatrixForm"}]}],"Input"],
Cell[BoxData[TagBox[RowBox[{"-", "1.6535101656671476`"}], Function[BoxForm`e$, MatrixForm[BoxForm`e$]]]],"Output",CellLabel->"Out[498]//MatrixForm= "],
Cell[TextData[{"Metric Derivatives"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"dGdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"G", ",", "r"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"dGdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"G", ",", "theta"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"dGdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dGdr", ",", "r"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"dGdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dGdr", ",", "theta"}], "]"}], "]"}]}], ";"}]}],"Input"],
Cell[TextData[{"Contravariant Metric Components"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"Ginv", "=", RowBox[{"Simplify", "[", RowBox[{"Inverse", "[", "G", "]"}], "]"}]}], ";"}], "\n", RowBox[{"(*", RowBox[{"Ginv", "//", "MatrixForm"}], "*)"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"gutt", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gurr", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"guthth", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gupp", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gutr", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gutp", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"gurp", "=", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], ";"}]}],"Input"],
Cell[TextData[{"Christoffel Symbol"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"Christ", "=", RowBox[{RowBox[{"ResourceFunction", "[", "\"ChristoffelSymbol\"", "]"}], "[", RowBox[{"G", ",", RowBox[{"{", RowBox[{"t", ",", "r", ",", "theta", ",", "phi"}], "}"}], ",", RowBox[{"\"Kind\"", "->", "\"Second\""}]}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"Christ", "=", RowBox[{"Simplify", "[", "Christ", "]"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{"(*", RowBox[{RowBox[{"chttt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chttr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chttth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chttp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chtrr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chtrth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chtrp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chtthth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chtthp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chtpp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "1", ",", "4", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrtt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chrtr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chrtth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chrtp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrrr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chrrth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chrrp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrthth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chrthp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chrpp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "2", ",", "4", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chthtt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chthtr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chthtth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chthtp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chthrr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chthrth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chthrp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chththth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chththp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chthpp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "3", ",", "4", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chptt", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", RowBox[{"chptr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chptth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chptp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chprr", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", RowBox[{"chprth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chprp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chpthth", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "3", ",", "3"}], "]"}], "]"}]}], ";", RowBox[{"chpthp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "3", ",", "4"}], "]"}], "]"}]}], ";", RowBox[{"chppp", "=", RowBox[{"Simplify", "[", RowBox[{"Part", "[", RowBox[{"Christ", ",", "4", ",", "4", ",", "4"}], "]"}], "]"}]}], ";"}], "*)"}]}],"Input"],
Cell[BoxData[{RowBox[{"(*", RowBox[{RowBox[{"dgttdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtt", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgththdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gthth", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgppdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gpp", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtp", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdr", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grp", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgttdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtt", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grr", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgththdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gthth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgppdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gpp", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtp", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"gtr", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdth", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"grp", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgttdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgttdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrrdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgththdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgththdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgppdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgppdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtpdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtrdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdr2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrpdr", ",", "r"}], "]"}], "]"}]}], ";", RowBox[{"dgttdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgttdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrrdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrrdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgththdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgththdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgppdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgppdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtpdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtpdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgtrdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgtrdth", ",", "theta"}], "]"}], "]"}]}], ";", RowBox[{"dgrpdth2", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"dgrpdth", ",", "theta"}], "]"}], "]"}]}], ";"}], "*)"}]}],"Input"],
Cell[TextData[{"Redshift"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"omega", "=", RowBox[{RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "+", RowBox[{"Sqrt", "[", RowBox[{RowBox[{RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "*", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "-", RowBox[{RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}]}], ")"}], "/", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"uet", "=", RowBox[{"1", "/", RowBox[{"Sqrt", "[", RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "+", RowBox[{"2", "*", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "*", "omega"}], "+", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "*", "omega", "*", "omega"}]}], ")"}]}], "]"}]}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{"g", "=", RowBox[{"1", "/", RowBox[{"(", RowBox[{"uet", "*", RowBox[{"(", RowBox[{"1", "-", RowBox[{"omega", "*", "ktkp"}]}], ")"}]}], ")"}]}]}]}],"Input"],
Cell[BoxData[FractionBox[SqrtBox[RowBox[{RowBox[{"-", FractionBox[RowBox[{RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["r", "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "2"]]}], "+", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "13"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", RowBox[{"(", RowBox[{RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r"}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}], "-", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"], " ", "r"}], "+", RowBox[{"8", " ", "M", " ", SuperscriptBox["r", "3"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"3", " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "3"]]}], "+", SqrtBox[RowBox[{FractionBox[RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "4"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r"}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}], "-", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"], " ", "r"}], "+", RowBox[{"8", " ", "M", " ", SuperscriptBox["r", "3"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"3", " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "6"]], "-", FractionBox[RowBox[{"2", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["a", "2"]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", "r"}], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{"2", " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", "r", " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "11"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], RowBox[{SuperscriptBox["r", "14"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "6"]}]]}]]}], ")"}]}], RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "11"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]], "-", FractionBox[RowBox[{SuperscriptBox["r", "20"], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "4"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r"}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}], "-", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"], " ", "r"}], "+", RowBox[{"8", " ", "M", " ", SuperscriptBox["r", "3"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"3", " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "3"]]}], "+", SqrtBox[RowBox[{FractionBox[RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "4"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r"}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}], "-", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"], " ", "r"}], "+", RowBox[{"8", " ", "M", " ", SuperscriptBox["r", "3"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"3", " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "6"]], "-", FractionBox[RowBox[{"2", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["a", "2"]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", "r"}], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{"2", " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", "r", " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "11"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], RowBox[{SuperscriptBox["r", "14"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "6"]}]]}]]}], ")"}], "2"]}], RowBox[{"4", " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "11"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], "2"]}]]}]], RowBox[{"1", "-", FractionBox[RowBox[{"ktkp", " ", SuperscriptBox["r", "10"], " ", SuperscriptBox[RowBox[{"Csc", "[", "theta", "]"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "3"], " ", RowBox[{"(", RowBox[{RowBox[{"-", FractionBox[RowBox[{"a", " ", SuperscriptBox["r", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r"}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}], "-", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"], " ", "r"}], "+", RowBox[{"8", " ", "M", " ", SuperscriptBox["r", "3"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"3", " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "3"]]}], "+", SqrtBox[RowBox[{FractionBox[RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "4"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "4"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r"}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}], "-", RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "r", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["M", "3"], " ", "r"}], "+", RowBox[{"8", " ", "M", " ", SuperscriptBox["r", "3"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"3", " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], "2"]}], SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "6"]], "-", FractionBox[RowBox[{"2", " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["a", "2"]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", "r"}], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{"2", " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", "r", " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "11"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], RowBox[{SuperscriptBox["r", "14"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], "6"]}]]}]]}], ")"}]}], RowBox[{"2", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "3"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{"M", "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "11"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{"1", "+", FractionBox[RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], SuperscriptBox["r", "3"]]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["a", "2"], " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "2"]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "5"]}]}], ")"}], " ", RowBox[{"(", RowBox[{SuperscriptBox["r", "2"], "+", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox[RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", SuperscriptBox["r", "2"]}], ")"}], "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", SuperscriptBox["r", "3"]}], ")"}], "2"]}], "-", RowBox[{SuperscriptBox["a", "2"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", SuperscriptBox[RowBox[{"Sin", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]]}]]],"Output",CellLabel->"Out[517]= "],
Cell[BoxData[{RowBox[{RowBox[{"se", "=", RowBox[{RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "+", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "*", "omega"}]}], ")"}]}], "*", "uet"}], "/.", RowBox[{"theta", "->", RowBox[{"Pi", "/", "2"}]}]}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"Lzsub", "=", RowBox[{RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "+", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "*", "omega"}]}], ")"}]}], "*", "uet"}], "/.", RowBox[{"theta", "->", RowBox[{"Pi", "/", "2"}]}]}]}], ";"}]}],"Input"],
Cell[TextData[{"ISCO"}],"Chapter"],
Cell[BoxData[{RowBox[{RowBox[{"equE", "=", RowBox[{"(", RowBox[{RowBox[{RowBox[{"gttS", "*", "dt"}], "+", RowBox[{"gtrS", "*", "dr"}], "+", RowBox[{"gtpS", "*", "dp"}]}], "==", RowBox[{"-", "E"}]}], ")"}]}], ";"}], "\n", RowBox[{RowBox[{"equL", "=", RowBox[{"(", RowBox[{RowBox[{RowBox[{"gtpS", "*", "dt"}], "+", RowBox[{"grpS", "*", "dr"}], "+", RowBox[{"gppS", "*", "dp"}]}], "==", "Lz"}], ")"}]}], ";"}], "\n", RowBox[{RowBox[{"equU", "=", RowBox[{"(", RowBox[{RowBox[{RowBox[{"gttS", "*", RowBox[{"dt", "^", "2"}]}], "+", RowBox[{"grrS", "*", RowBox[{"dr", "^", "2"}]}], "+", RowBox[{"gppS", "*", RowBox[{"dp", "^", "2"}]}], "+", RowBox[{"2", "*", "gtrS", "*", "dt", "*", "dr"}], "+", RowBox[{"2", "*", "grpS", "*", "dr", "*", "dp"}], "+", RowBox[{"2", "*", "gtpS", "*", "dt", "*", "dp"}]}], "==", RowBox[{"-", "1"}]}], ")"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"equEalt", "=", RowBox[{"(", RowBox[{RowBox[{RowBox[{"gttS", "*", "dt"}], "+", RowBox[{"gtpS", "*", "dp"}]}], "==", RowBox[{"-", "E"}]}], ")"}]}], ";"}], "\n", RowBox[{RowBox[{"equLalt", "=", RowBox[{"(", RowBox[{RowBox[{RowBox[{"gtpS", "*", "dt"}], "+", RowBox[{"gppS", "*", "dp"}]}], "==", "Lz"}], ")"}]}], ";"}], "\n", RowBox[{RowBox[{"equUalt", "=", RowBox[{"(", RowBox[{RowBox[{RowBox[{"gttS", "*", RowBox[{"dt", "^", "2"}]}], "+", RowBox[{"grrS", "*", RowBox[{"dr", "^", "2"}]}], "+", RowBox[{"gppS", "*", RowBox[{"dp", "^", "2"}]}], "+", RowBox[{"2", "*", "gtpS", "*", "dt", "*", "dp"}]}], "==", RowBox[{"-", "1"}]}], ")"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"set", "=", RowBox[{"{", RowBox[{"equE", ",", "equL", ",", "equU"}], "}"}]}], ";"}], "\n", RowBox[{RowBox[{"set", "=", RowBox[{"{", RowBox[{"equEalt", ",", "equLalt", ",", "equUalt"}], "}"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{"sol", "=", RowBox[{"Simplify", "[", RowBox[{"Solve", "[", RowBox[{"set", ",", RowBox[{"{", RowBox[{"dt", ",", "dp", ",", "dr"}], "}"}]}], "]"}], "]"}]}]}],"Input"],
Cell[BoxData[RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{RowBox[{"dt", "\[Rule]", FractionBox[RowBox[{RowBox[{"\[ExponentialE]", " ", "gppS"}], "+", RowBox[{"gtpS", " ", "Lz"}]}], RowBox[{SuperscriptBox["gtpS", "2"], "-", RowBox[{"gppS", " ", "gttS"}]}]]}], ",", RowBox[{"dp", "\[Rule]", FractionBox[RowBox[{RowBox[{"\[ExponentialE]", " ", "gtpS"}], "+", RowBox[{"gttS", " ", "Lz"}]}], RowBox[{RowBox[{"-", SuperscriptBox["gtpS", "2"]}], "+", RowBox[{"gppS", " ", "gttS"}]}]]}], ",", RowBox[{"dr", "\[Rule]", RowBox[{"-", FractionBox[SqrtBox[RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{SuperscriptBox["\[ExponentialE]", "2"], " ", "gppS"}], ")"}]}], "+", SuperscriptBox["gtpS", "2"], "-", RowBox[{"2", " ", "\[ExponentialE]", " ", "gtpS", " ", "Lz"}], "-", RowBox[{"gttS", " ", RowBox[{"(", RowBox[{"gppS", "+", SuperscriptBox["Lz", "2"]}], ")"}]}]}]], SqrtBox[RowBox[{"grrS", " ", RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["gtpS", "2"]}], "+", RowBox[{"gppS", " ", "gttS"}]}], ")"}]}]]]}]}]}], "}"}], ",", RowBox[{"{", RowBox[{RowBox[{"dt", "\[Rule]", FractionBox[RowBox[{RowBox[{"\[ExponentialE]", " ", "gppS"}], "+", RowBox[{"gtpS", " ", "Lz"}]}], RowBox[{SuperscriptBox["gtpS", "2"], "-", RowBox[{"gppS", " ", "gttS"}]}]]}], ",", RowBox[{"dp", "\[Rule]", FractionBox[RowBox[{RowBox[{"\[ExponentialE]", " ", "gtpS"}], "+", RowBox[{"gttS", " ", "Lz"}]}], RowBox[{RowBox[{"-", SuperscriptBox["gtpS", "2"]}], "+", RowBox[{"gppS", " ", "gttS"}]}]]}], ",", RowBox[{"dr", "\[Rule]", FractionBox[SqrtBox[RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{SuperscriptBox["\[ExponentialE]", "2"], " ", "gppS"}], ")"}]}], "+", SuperscriptBox["gtpS", "2"], "-", RowBox[{"2", " ", "\[ExponentialE]", " ", "gtpS", " ", "Lz"}], "-", RowBox[{"gttS", " ", RowBox[{"(", RowBox[{"gppS", "+", SuperscriptBox["Lz", "2"]}], ")"}]}]}]], SqrtBox[RowBox[{"grrS", " ", RowBox[{"(", RowBox[{RowBox[{"-", SuperscriptBox["gtpS", "2"]}], "+", RowBox[{"gppS", " ", "gttS"}]}], ")"}]}]]]}]}], "}"}]}], "}"}]],"Output",CellLabel->"Out[528]= "],
Cell[BoxData[{RowBox[{RowBox[{"Veff", "=", RowBox[{RowBox[{"grrS", "*", "dr", "*", "dr"}], "/.", RowBox[{"sol", "[", RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\n", RowBox[{"Veff", "=", RowBox[{"Simplify", "[", "Veff", "]"}]}]}],"Input"],
Cell[BoxData[FractionBox[RowBox[{RowBox[{SuperscriptBox["\[ExponentialE]", "2"], " ", "gppS"}], "-", SuperscriptBox["gtpS", "2"], "+", RowBox[{"2", " ", "\[ExponentialE]", " ", "gtpS", " ", "Lz"}], "+", RowBox[{"gttS", " ", RowBox[{"(", RowBox[{"gppS", "+", SuperscriptBox["Lz", "2"]}], ")"}]}]}], RowBox[{SuperscriptBox["gtpS", "2"], "-", RowBox[{"gppS", " ", "gttS"}]}]]],"Output",CellLabel->"Out[530]= "],
Cell[BoxData[{RowBox[{RowBox[{"subs", "=", RowBox[{"{", RowBox[{RowBox[{"gttS", "->", "gtt"}], ",", RowBox[{"grrS", "->", "grr"}], ",", RowBox[{"gththS", "->", "gthth"}], ",", RowBox[{"gppS", "->", "gpp"}], ",", RowBox[{"gtrS", "->", "gtr"}], ",", RowBox[{"gtpS", "->", "gtp"}], ",", RowBox[{"grpS", "->", "grp"}], ",", RowBox[{"theta", "->", RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{"Veffsub", "=", RowBox[{"Simplify", "[", RowBox[{RowBox[{"(", RowBox[{"Veff", "/.", "subs"}], ")"}], "/.", RowBox[{"theta", "->", RowBox[{"Pi", "/", "2"}]}]}], "]"}]}]}],"Input"],
Cell[BoxData[FractionBox[RowBox[{RowBox[{RowBox[{"-", "2"}], " ", SuperscriptBox["a", "3"], " ", "defpar", " ", "\[ExponentialE]", " ", "Lz", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "3"]}], "+", RowBox[{SuperscriptBox["defpar", "2"], " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "6"], " ", SuperscriptBox["r", "4"]}], "+", RowBox[{"2", " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "7"]}], "+", RowBox[{SuperscriptBox["Lz", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", SuperscriptBox["r", "7"]}], "+", RowBox[{SuperscriptBox["r", "9"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", RowBox[{RowBox[{"(", RowBox[{RowBox[{"-", "1"}], "+", SuperscriptBox["\[ExponentialE]", "2"]}], ")"}], " ", "r"}]}], ")"}]}], "-", RowBox[{"2", " ", "a", " ", "\[ExponentialE]", " ", "Lz", " ", "M", " ", SuperscriptBox["r", "5"], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "2"]}], "+", RowBox[{"2", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "4"], " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", RowBox[{"(", RowBox[{RowBox[{"defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"2", " ", SuperscriptBox["r", "3"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["defpar", "2"], " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "6"], " ", SuperscriptBox["r", "2"]}], "+", RowBox[{"4", " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "5"]}], "+", RowBox[{SuperscriptBox["r", "7"], " ", RowBox[{"(", RowBox[{RowBox[{"-", "r"}], "+", RowBox[{SuperscriptBox["\[ExponentialE]", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "+", "r"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], RowBox[{SuperscriptBox["r", "8"], " ", RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}]}]]],"Output",CellLabel->"Out[532]= "],
Cell[BoxData[{RowBox[{"d2Veffsub", "=", RowBox[{"Simplify", "[", RowBox[{"D", "[", RowBox[{"Veffsub", ",", RowBox[{"{", RowBox[{"r", ",", "2"}], "}"}]}], "]"}], "]"}]}]}],"Input"],
Cell[BoxData[FractionBox[RowBox[{"2", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "30"}], " ", SuperscriptBox["a", "7"], " ", "defpar", " ", "\[ExponentialE]", " ", "Lz", " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "3"]}], "+", RowBox[{"4", " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "9"], " ", RowBox[{"(", RowBox[{RowBox[{"6", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"8", " ", "M", " ", "r"}], "+", RowBox[{"3", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["defpar", "2"], " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "6"], " ", SuperscriptBox["r", "6"], " ", RowBox[{"(", RowBox[{RowBox[{"60", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"70", " ", "M", " ", "r"}], "+", RowBox[{"21", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{"2", " ", SuperscriptBox["a", "5"], " ", "\[ExponentialE]", " ", "Lz", " ", "M", " ", SuperscriptBox["r", "4"], " ", RowBox[{"(", RowBox[{RowBox[{"5", " ", "defpar", " ", SuperscriptBox["M", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"14", " ", "M"}], "-", RowBox[{"9", " ", "r"}]}], ")"}]}], "-", RowBox[{"2", " ", SuperscriptBox["r", "3"]}]}], ")"}]}], "+", RowBox[{"6", " ", SuperscriptBox["a", "8"], " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", RowBox[{"(", RowBox[{RowBox[{"6", " ", "defpar", " ", SuperscriptBox["M", "3"]}], "+", RowBox[{"5", " ", SuperscriptBox["r", "3"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "9"], " ", RowBox[{"(", RowBox[{RowBox[{"3", " ", SuperscriptBox["Lz", "2"], " ", SuperscriptBox[RowBox[{"(", RowBox[{RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], "3"]}], "+", RowBox[{"2", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", "M", " ", SuperscriptBox["r", "4"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "6"], " ", SuperscriptBox["\[ExponentialE]", "2"], " ", "M", " ", "r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "defpar", " ", SuperscriptBox["M", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"70", " ", "M"}], "-", RowBox[{"51", " ", "r"}]}], ")"}], " ", SuperscriptBox["r", "3"]}], "+", RowBox[{"2", " ", SuperscriptBox["r", "6"]}], "+", RowBox[{SuperscriptBox["defpar", "2"], " ", SuperscriptBox["M", "5"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "160"}], " ", "M"}], "+", RowBox[{"129", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", RowBox[{"2", " ", "a", " ", "\[ExponentialE]", " ", "Lz", " ", "M", " ", SuperscriptBox["r", "7"], " ", RowBox[{"(", RowBox[{RowBox[{"4", " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"6", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"8", " ", "M", " ", "r"}], "+", RowBox[{"3", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"40", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"48", " ", "M", " ", "r"}], "+", RowBox[{"15", " ", SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], "-", RowBox[{"6", " ", SuperscriptBox["a", "3"], " ", "\[ExponentialE]", " ", "Lz", " ", "M", " ", SuperscriptBox["r", "5"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", SuperscriptBox["r", "3"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], "+", RowBox[{"defpar", " ", SuperscriptBox["M", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"28", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"42", " ", "M", " ", "r"}], "+", RowBox[{"15", " ", SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "4"], " ", RowBox[{"(", RowBox[{RowBox[{"6", " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "5"], " ", RowBox[{"(", RowBox[{RowBox[{"28", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"52", " ", "M", " ", "r"}], "+", RowBox[{"21", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{"3", " ", SuperscriptBox["defpar", "2"], " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "6"], " ", SuperscriptBox["r", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"60", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"130", " ", "M", " ", "r"}], "+", RowBox[{"57", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{"2", " ", "M", " ", SuperscriptBox["r", "7"], " ", RowBox[{"(", RowBox[{SuperscriptBox["Lz", "2"], "+", RowBox[{"3", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", "r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["a", "2"], " ", RowBox[{"(", RowBox[{RowBox[{"2", " ", "defpar", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "3"], " ", SuperscriptBox["r", "7"], " ", RowBox[{"(", RowBox[{RowBox[{"80", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"102", " ", "M", " ", "r"}], "+", RowBox[{"33", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["defpar", "2"], " ", SuperscriptBox["\[ExponentialE]", "2"], " ", SuperscriptBox["M", "6"], " ", SuperscriptBox["r", "4"], " ", RowBox[{"(", RowBox[{RowBox[{"224", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"300", " ", "M", " ", "r"}], "+", RowBox[{"99", " ", SuperscriptBox["r", "2"]}]}], ")"}]}], "+", RowBox[{SuperscriptBox["r", "8"], " ", RowBox[{"(", RowBox[{RowBox[{SuperscriptBox["Lz", "2"], " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "12"}], " ", SuperscriptBox["M", "2"]}], "+", RowBox[{"6", " ", "M", " ", "r"}], "+", SuperscriptBox["r", "2"]}], ")"}]}], "+", RowBox[{"2", " ", SuperscriptBox["\[ExponentialE]", "2"], " ", "M", " ", "r", " ", RowBox[{"(", RowBox[{RowBox[{"12", " ", SuperscriptBox["M", "2"]}], "-", RowBox[{"14", " ", "M", " ", "r"}], "+", RowBox[{"3", " ", SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], RowBox[{SuperscriptBox["r", "10"], " ", SuperscriptBox[RowBox[{"(", RowBox[{SuperscriptBox["a", "2"], "+", RowBox[{"r", " ", RowBox[{"(", RowBox[{RowBox[{RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "3"]}]]],"Output",CellLabel->"Out[533]= "],
Cell[TextData[{"Convert to C Code"}],"Chapter"],
Cell[BoxData[{RowBox[{"(*", RowBox[{RowBox[{"::", "Package"}], "::"}], "*)"}], "\n", "\n", RowBox[{"BeginPackage", "[", "\"OptimizeExpressionToC`\"", "]"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"OptimizeExpressionToC", "::", "usage"}], "=", "\"Generates optimized version of expression in C\""}], ";"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"ExtractTags", "::", "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"ClearTagText", "::", "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"TagExistQ", "::", "usage"}], "=", "\"\""}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"AppendToTag", "::", "usage"}], "=", "\"\""}], ";"}], "\n", "\n", RowBox[{"Begin", "[", "\"Private`\"", "]"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", "expr_List", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"optimizedExpr", ",", "mainExpr", ",", "n", ",", "m", ",", "defs", ",", "output"}], "}"}], ",", RowBox[{RowBox[{"optimizedExpr", "=", RowBox[{"Experimental`OptimizeExpression", "[", "expr", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"ToString", "@", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "0"}], "]"}], "]"}]}], "==", "\"Block\""}], ",", RowBox[{"{", RowBox[{RowBox[{"n", "=", RowBox[{"Length", "[", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", RowBox[{"mainExpr", "=", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "2", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ";"}], "}"}], ",", RowBox[{"{", RowBox[{RowBox[{"n", "=", "0"}], ";", RowBox[{"mainExpr", "=", RowBox[{"Flatten", "@", RowBox[{"{", RowBox[{"optimizedExpr", "[", RowBox[{"[", "1", "]"}], "]"}], "}"}]}]}], ";"}], "}"}]}], "]"}], ";", RowBox[{"m", "=", RowBox[{"Length", "[", "mainExpr", "]"}]}], ";", RowBox[{"defs", "=", RowBox[{"Table", "[", RowBox[{RowBox[{"\"double \"", "<>", RowBox[{"ToString", "@", RowBox[{"CForm", "@", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "2", ",", "i", ",", "1"}], "]"}], "]"}]}]}], "<>", "\" = \"", "<>", RowBox[{"ToString", "@", RowBox[{"CForm", "@", RowBox[{"optimizedExpr", "[", RowBox[{"[", RowBox[{"1", ",", "2", ",", "i", ",", "2"}], "]"}], "]"}]}]}], "<>", "\";\""}], ",", RowBox[{"{", RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", RowBox[{"output", "=", RowBox[{"MapIndexed", "[", RowBox[{RowBox[{RowBox[{"\"out(\"", "<>", RowBox[{"StringJoin", "@", RowBox[{"Riffle", "[", RowBox[{RowBox[{"ToString", "/@", RowBox[{"(", RowBox[{"#2", "-", "1"}], ")"}]}], ",", "\"\""}], "]"}]}], "<>", "\") = \"", "<>", RowBox[{"ToString", "@", RowBox[{"CForm", "@", "#1"}]}], "<>", "\";\""}], "&"}], ",", "mainExpr", ",", RowBox[{"{", RowBox[{"ArrayDepth", "[", "mainExpr", "]"}], "}"}]}], "]"}]}], ";", RowBox[{"StringReplace", "[", RowBox[{RowBox[{"Join", "[", RowBox[{"defs", ",", "output"}], "]"}], ",", RowBox[{"\"Compile_$\"", "->", "\"t\""}]}], "]"}]}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{"End", "[", "]"}], "\n", "\n", "\n", RowBox[{RowBox[{RowBox[{"ExtractTags", "[", "string_String", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"regex", ",", "extractTag"}], "}"}], ",", RowBox[{RowBox[{"regex", "=", RowBox[{"RegularExpression", "[", "\"\\\\n([^\\\\n]*)// (\\\\[|</?)([^\\\\]\\\\n]*)(\\\\]|>)[^\\\\n]*\\\\n\"", "]"}]}], ";", RowBox[{RowBox[{"extractTag", "[", "bounds_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"substring", ",", "indentation", ",", "tagType", ",", "tag"}], "}"}], ",", RowBox[{RowBox[{"substring", "=", RowBox[{"StringTake", "[", RowBox[{"string", ",", "bounds"}], "]"}]}], ";", RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"indentation", ",", "tagType", ",", "tag"}], "}"}], "}"}], "=", RowBox[{"StringCases", "[", RowBox[{"substring", ",", RowBox[{"regex", "->", RowBox[{"{", RowBox[{"\"$1\"", ",", "\"$2\"", ",", "\"$3\""}], "}"}]}]}], "]"}]}], ";", RowBox[{"Association", "[", RowBox[{RowBox[{"\"indentation\"", "->", "indentation"}], ",", RowBox[{"\"tagType\"", "->", "tagType"}], ",", RowBox[{"\"tag\"", "->", "tag"}], ",", RowBox[{"\"start\"", "->", RowBox[{RowBox[{"bounds", "[", RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", RowBox[{"\"end\"", "->", RowBox[{"bounds", "[", RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "]"}]}], ";", RowBox[{RowBox[{RowBox[{"extractTag", "[", "#", "]"}], "&"}], "/@", RowBox[{"StringPosition", "[", RowBox[{"string", ",", "regex"}], "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"TagExistQ", "[", RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", RowBox[{"AnyTrue", "[", RowBox[{RowBox[{"ExtractTags", "[", "string", "]"}], ",", RowBox[{RowBox[{RowBox[{"#", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&"}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{"ClearTagText", "[", RowBox[{"string_String", ",", "tag_String"}], "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"tags", ",", "startTag", ",", "endTag", ",", "x"}], "}"}], ",", RowBox[{RowBox[{"tags", "=", RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", RowBox[{"startTag", "=", RowBox[{"FirstCase", "[", RowBox[{"tags", ",", RowBox[{"x_", "/;", RowBox[{RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&&", RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tagType\"", "]"}], "]"}], "==", "\"<\""}]}]}]}], "]"}]}], ";", RowBox[{"endTag", "=", RowBox[{"FirstCase", "[", RowBox[{"tags", ",", RowBox[{"x_", "/;", RowBox[{RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&&", RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tagType\"", "]"}], "]"}], "==", "\"</\""}]}]}]}], "]"}]}], ";", RowBox[{RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"startTag", "[", RowBox[{"[", "\"end\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{RowBox[{"endTag", "[", RowBox[{"[", "\"start\"", "]"}], "]"}], ",", RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], "]"}]}]}]}], "]"}]}], "\n", "\n", RowBox[{RowBox[{RowBox[{"AppendToTag", "[", RowBox[{"string_String", ",", "tag_String", ",", "linesToAppend_List"}], "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"tags", ",", "startTag", ",", "indent", ",", "x"}], "}"}], ",", RowBox[{RowBox[{"tags", "=", RowBox[{"ExtractTags", "[", "string", "]"}]}], ";", RowBox[{"startTag", "=", RowBox[{"FirstCase", "[", RowBox[{"tags", ",", RowBox[{"x_", "/;", RowBox[{RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tag\"", "]"}], "]"}], "==", "tag"}], "&&", RowBox[{RowBox[{"x", "[", RowBox[{"[", "\"tagType\"", "]"}], "]"}], "==", "\"<\""}]}]}]}], "]"}]}], ";", RowBox[{"indent", "=", RowBox[{"startTag", "[", RowBox[{"[", "\"indentation\"", "]"}], "]"}]}], ";", RowBox[{RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"startTag", "[", RowBox[{"[", "\"end\"", "]"}], "]"}]}], "}"}]}], "]"}], "<>", RowBox[{"StringRiffle", "[", RowBox[{"linesToAppend", ",", RowBox[{"{", RowBox[{"indent", ",", RowBox[{"\"\\n\"", "<>", "indent"}], ",", "\"\\n\""}], "}"}]}], "]"}], "<>", RowBox[{"StringTake", "[", RowBox[{"string", ",", RowBox[{"{", RowBox[{RowBox[{RowBox[{"startTag", "[", RowBox[{"[", "\"end\"", "]"}], "]"}], "+", "1"}], ",", RowBox[{"StringLength", "[", "string", "]"}]}], "}"}]}], "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", RowBox[{RowBox[{RowBox[{"AppendToTag", "[", RowBox[{"string_String", ",", "tag_String", ",", "stringToAppend_String"}], "]"}], ":=", RowBox[{"AppendToTag", "[", RowBox[{"string", ",", "tag", ",", RowBox[{"StringSplit", "[", RowBox[{"stringToAppend", ",", "\"\\n\""}], "]"}]}], "]"}]}], ";"}], "\n", "\n", "\n", RowBox[{"EndPackage", "[", "]"}]}],"Input"],
Cell[BoxData["\"OptimizeExpressionToC`\""],"Output",CellLabel->"Out[534]= "],
Cell[BoxData["\"Private`\""],"Output",CellLabel->"Out[540]= "],
Cell[BoxData["\"Private`\""],"Output",CellLabel->"Out[542]= "],
Cell[BoxData[{RowBox[{RowBox[{"M", "=", "1"}], ";"}], "\n", RowBox[{RowBox[{"a", "=", "spin"}], ";"}], "\n", RowBox[{RowBox[{"theta", "=", "th"}], ";"}]}],"Input"],
Cell[TextData[{"Metric Components"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"G", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"g[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"g[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"g[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"g[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"g[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"g[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"g[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"g[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"g[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"g[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"g[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"g[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"g[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"g[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"g[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"g[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void metric(long double r, long double th, long double g[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metric", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[TextData[{"Metric r derivatives"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"dg[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"dg[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"dg[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"dg[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"dg[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"dg[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"dg[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"dg[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"dg[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"dg[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"dg[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"dg[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"dg[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"dg[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"dg[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"dg[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void metric_rderivatives(long double r, long double th, long double dg[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metricdr", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[TextData[{"Metric r2 derivatives"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"dGdr2", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"dg2[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"dg2[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"dg2[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"dg2[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"dg2[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"dg2[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"dg2[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"dg2[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"dg2[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"dg2[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"dg2[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"dg2[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"dg2[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"dg2[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"dg2[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"dg2[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void metric_r2derivatives(long double r, long double th, long double dg2[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metricdr2", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[TextData[{"Covariant Metric Components"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{"Ginv", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meet", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"gu[0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"gu[0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"gu[0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"gu[0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"gu[1][0]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"gu[1][1]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"gu[1][2]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"gu[1][3]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"gu[2][0]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"gu[2][1]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"gu[2][2]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"gu[2][3]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"gu[3][0]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"gu[3][1]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"gu[3][2]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"gu[3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void uppermetric(long double r, long double th, long double gu[4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"metricupper", "=", RowBox[{"header", "<>", "meet", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"output", "=", RowBox[{"metric", "<>", "\"\\n\\n\"", "<>", "metricupper", "<>", "\"\\n\\n\"", "<>", "metricdr", "<>", "\"\\n\\n\"", "<>", "metricdr2"}]}], ";"}], "\n", "\n", RowBox[{"(*", RowBox[{"write", "to", RowBox[{"metric", ".", "cpp"}], "file"}], "*)"}], "\n", RowBox[{RowBox[{"SetDirectory", "[", "\"C:\\\\Users\\\\Administrator\\\\Documents\\\\script\\\\raytransfer\"", "]"}], ";"}], "\n", RowBox[{"Export", "[", RowBox[{"\"metric.cpp\"", ",", "output", ",", "\"Text\""}], "]"}]}],"Input"],
Cell[BoxData["\"metric.cpp\""],"Output",CellLabel->"Out[574]= "],
Cell[TextData[{"Christoffel Symbols"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "1", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "2", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "3", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], ",", RowBox[{RowBox[{RowBox[{"Christ", "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}], "[", RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"christ[0][0][0]\""}], ",", RowBox[{"\"out(1)\"", "->", "\"christ[0][0][1]\""}], ",", RowBox[{"\"out(2)\"", "->", "\"christ[0][0][2]\""}], ",", RowBox[{"\"out(3)\"", "->", "\"christ[0][0][3]\""}], ",", RowBox[{"\"out(4)\"", "->", "\"christ[0][1][1]\""}], ",", RowBox[{"\"out(5)\"", "->", "\"christ[0][1][2]\""}], ",", RowBox[{"\"out(6)\"", "->", "\"christ[0][1][3]\""}], ",", RowBox[{"\"out(7)\"", "->", "\"christ[0][2][2]\""}], ",", RowBox[{"\"out(8)\"", "->", "\"christ[0][2][3]\""}], ",", RowBox[{"\"out(9)\"", "->", "\"christ[0][3][3]\""}], ",", RowBox[{"\"out(10)\"", "->", "\"christ[1][0][0]\""}], ",", RowBox[{"\"out(11)\"", "->", "\"christ[1][0][1]\""}], ",", RowBox[{"\"out(12)\"", "->", "\"christ[1][0][2]\""}], ",", RowBox[{"\"out(13)\"", "->", "\"christ[1][0][3]\""}], ",", RowBox[{"\"out(14)\"", "->", "\"christ[1][1][1]\""}], ",", RowBox[{"\"out(15)\"", "->", "\"christ[1][1][2]\""}], ",", RowBox[{"\"out(16)\"", "->", "\"christ[1][1][3]\""}], ",", RowBox[{"\"out(17)\"", "->", "\"christ[1][2][2]\""}], ",", RowBox[{"\"out(18)\"", "->", "\"christ[1][2][3]\""}], ",", RowBox[{"\"out(19)\"", "->", "\"christ[1][3][3]\""}], ",", RowBox[{"\"out(20)\"", "->", "\"christ[2][0][0]\""}], ",", RowBox[{"\"out(21)\"", "->", "\"christ[2][0][1]\""}], ",", RowBox[{"\"out(22)\"", "->", "\"christ[2][0][2]\""}], ",", RowBox[{"\"out(23)\"", "->", "\"christ[2][0][3]\""}], ",", RowBox[{"\"out(24)\"", "->", "\"christ[2][1][1]\""}], ",", RowBox[{"\"out(25)\"", "->", "\"christ[2][1][2]\""}], ",", RowBox[{"\"out(26)\"", "->", "\"christ[2][1][3]\""}], ",", RowBox[{"\"out(27)\"", "->", "\"christ[2][2][2]\""}], ",", RowBox[{"\"out(28)\"", "->", "\"christ[2][2][3]\""}], ",", RowBox[{"\"out(29)\"", "->", "\"christ[2][3][3]\""}], ",", RowBox[{"\"out(30)\"", "->", "\"christ[3][0][0]\""}], ",", RowBox[{"\"out(31)\"", "->", "\"christ[3][0][1]\""}], ",", RowBox[{"\"out(32)\"", "->", "\"christ[3][0][2]\""}], ",", RowBox[{"\"out(33)\"", "->", "\"christ[3][0][3]\""}], ",", RowBox[{"\"out(34)\"", "->", "\"christ[3][1][1]\""}], ",", RowBox[{"\"out(35)\"", "->", "\"christ[3][1][2]\""}], ",", RowBox[{"\"out(36)\"", "->", "\"christ[3][1][3]\""}], ",", RowBox[{"\"out(37)\"", "->", "\"christ[3][2][2]\""}], ",", RowBox[{"\"out(38)\"", "->", "\"christ[3][2][3]\""}], ",", RowBox[{"\"out(39)\"", "->", "\"christ[3][3][3]\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void christoffel(long double r, long double th, long double christ[4][4][4])\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"christoffel", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"output", "=", "christoffel"}], ";"}], "\n", "\n", RowBox[{"(*", RowBox[{"write", "to", "christoffel", "file"}], "*)"}], "\n", RowBox[{RowBox[{"Export", "[", RowBox[{"\"christoffel.cpp\"", ",", "output", ",", "\"Text\""}], "]"}], ";"}]}],"Input"],
Cell[TextData[{"Redshift"}],"Section"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", "g", "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"gg\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"void redshift(long double r, long double th, long double ktkp, long double &gg)\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"red", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", "se", "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"long double se\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"long double specific_energy(long double r)\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\nreturn se;\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"specificE", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", "Lzsub", "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"long double Lz\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"long double specific_momentum(long double r)\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\nreturn Lz;\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"specificL", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"output", "=", RowBox[{"red", "<>", "\"\\n\\n\"", "<>", "specificE", "<>", "\"\\n\\n\"", "<>", "specificL"}]}], ";"}], "\n", "\n", RowBox[{"(*", RowBox[{"write", "to", RowBox[{"metric", ".", "cpp"}], "file"}], "*)"}], "\n", RowBox[{RowBox[{"SetDirectory", "[", "\"C:\\\\Users\\\\Administrator\\\\Documents\\\\script\\\\raytransfer\"", "]"}], ";"}], "\n", RowBox[{"Export", "[", RowBox[{"\"redshift.cpp\"", ",", "output", ",", "\"Text\""}], "]"}]}],"Input"],
Cell[BoxData["\"redshift.cpp\""],"Output",CellLabel->"Out[599]= "],
Cell[BoxData[{RowBox[{RowBox[{"OptimizeExpressionToC", "[", RowBox[{"{", "d2Veffsub", "}"}], "]"}], ";"}], "\n", RowBox[{RowBox[{"meat", "=", RowBox[{"ToString", "[", RowBox[{"Column", "[", RowBox[{"StringReplace", "[", RowBox[{"%", ",", RowBox[{"{", RowBox[{RowBox[{"\"Sqrt\"", "->", "\"sqrt\""}], ",", RowBox[{"\"Power(E,\"", "->", "\"exp(\""}], ",", RowBox[{"\"Power\"", "->", "\"pow\""}], ",", RowBox[{"\"Sin\"", "->", "\"sin\""}], ",", RowBox[{"\"Cos\"", "->", "\"cos\""}], ",", RowBox[{"\"Csc\"", "->", "\"1/sin\""}], ",", RowBox[{"\"Cot\"", "->", "\"1/tan\""}], ",", RowBox[{"\"double\"", "->", "\"long double\""}], ",", RowBox[{"\";,\"", "->", "\";\\n    \""}], ",", RowBox[{"\"out(0)\"", "->", "\"long double d2Veff\""}]}], "}"}]}], "]"}], "]"}], "]"}]}], ";"}], "\n", RowBox[{RowBox[{"header", "=", "\"long double Veff_deri2(long double r, long double E, long double Lz)\\n{\\n\""}], ";"}], "\n", RowBox[{RowBox[{"footer", "=", "\"\\nreturn d2Veff;\\n}\""}], ";"}], "\n", RowBox[{RowBox[{"Veffderi2", "=", RowBox[{"header", "<>", "meat", "<>", "footer"}]}], ";"}]}],"Input"],
Cell[BoxData[{RowBox[{RowBox[{"output", "=", "Veffderi2"}], ";"}], "\n", "\n", RowBox[{"(*", RowBox[{"write", "to", RowBox[{"metric", ".", "cpp"}], "file"}], "*)"}], "\n", RowBox[{RowBox[{"SetDirectory", "[", "\"C:\\\\Users\\\\Administrator\\\\Documents\\\\script\\\\raytransfer\"", "]"}], ";"}], "\n", RowBox[{"Export", "[", RowBox[{"\"effective_potential.cpp\"", ",", "output", ",", "\"Text\""}], "]"}]}],"Input"],
Cell[BoxData["\"effective_potential.cpp\""],"Output",CellLabel->"Out[607]= "]
}]
