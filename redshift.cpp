void redshift(double r, double th, double ktkp, double &gg)
{
double t3 = pow(spin,2);
double t1 = pow(r,2);
double t16 = pow(spin,4);
double t4 = 2*th;
double t5 = cos(t4);
double t6 = t3*t5;
double t2 = 2*t1;
double t7 = t2 + t3 + t6;
double t33 = -2*t1;
double t34 = t3 + t33 + t6;
double t9 = pow(r,5);
double t11 = 8*t9;
double t12 = -4*t1*t3;
double t13 = pow(r,3);
double t15 = 8*t13*t3;
double t17 = 3*r*t16;
double t18 = 2*r;
double t20 = 1 + t18;
double t21 = r*t20;
double t22 = t21 + t3;
double t23 = 4*r*t22*t3*t5;
double t24 = -r;
double t25 = 1 + t24;
double t26 = 4*th;
double t27 = cos(t26);
double t28 = -(t16*t25*t27);
double t29 = t11 + t12 + t15 + t16 + t17 + t23 + t28;
double t36 = sin(th);
double t37 = pow(t36,2);
double t39 = pow(t7,-4);
double t30 = 1/t29;
double t35 = pow(t7,-2);
double t38 = 4*spin*t34*t35*t37;
double t40 = -4*t29*t34*t37*t39;
double t41 = pow(t34,2);
double t42 = pow(t36,4);
double t43 = 16*t3*t39*t41*t42;
double t44 = t40 + t43;
double t45 = sqrt(t44);
double t46 = t38 + t45;
double t31 = 1/sin(th);
double t32 = pow(t31,2);
double t50 = -2 + r;
gg = sqrt((t3 + 2*r*t50 + t6)/t7 + 8*r*spin*t30*t46*t7 - (t32*pow(t46,2)*(pow(t1 + t3,2) - t3*t37*(t3 + r*t50))*pow(t7,4)*(t1 + t3*pow(cos(th),2)))/(pow(t29,2)*pow(t1 + t3 - t3*t37,2)))/(1 - ktkp*t30*t32*t46*pow(t7,2));
}

double specific_energy(double r)
{
double t4 = pow(r,3);
double t8 = pow(spin,2);
double t12 = pow(spin,4);
double t5 = pow(r,5);
double t6 = 8*t5;
double t7 = pow(r,2);
double t9 = -4*t7*t8;
double t11 = 8*t4*t8;
double t13 = -r;
double t15 = 1 + t13;
double t16 = -(t12*t15);
double t17 = 3*r*t12;
double t18 = 2*r;
double t20 = 1 + t18;
double t21 = r*t20;
double t22 = t21 + t8;
double t23 = -4*r*t22*t8;
double t24 = t11 + t12 + t16 + t17 + t23 + t6 + t9;
double t1 = -2 + r;
double t2 = 1/r;
double t3 = t1*t2;
double t25 = 1/t24;
double t26 = pow(r,-2);
double t27 = -2*spin*t26;
double t28 = pow(r,-4);
double t29 = 4*t28*t8;
double t30 = pow(r,-6);
double t31 = (t24*t30)/2.;
double t32 = t29 + t31;
double t33 = sqrt(t32);
double t34 = t27 + t33;
double se = (t3 + 8*spin*t25*t34*t4)/sqrt(t3 + 16*spin*t25*t34*t4 - (16*pow(r,6)*pow(t34,2)*(-(t8*(r*t1 + t8)) + pow(t7 + t8,2)))/pow(t24,2));
return se;
}

double specific_momentum(double r)
{
double t4 = pow(spin,2);
double t3 = pow(r,2);
double t20 = pow(spin,4);
double t13 = pow(r,5);
double t15 = 8*t13;
double t16 = -4*t3*t4;
double t17 = pow(r,3);
double t18 = 8*t17*t4;
double t21 = -r;
double t22 = 1 + t21;
double t23 = -(t20*t22);
double t24 = 3*r*t20;
double t25 = 2*r;
double t26 = 1 + t25;
double t27 = r*t26;
double t28 = t27 + t4;
double t29 = -4*r*t28*t4;
double t30 = t15 + t16 + t18 + t20 + t23 + t24 + t29;
double t5 = -2 + r;
double t1 = 1/r;
double t31 = 1/t30;
double t32 = pow(r,-2);
double t33 = -2*spin*t32;
double t34 = pow(r,-4);
double t35 = 4*t34*t4;
double t36 = pow(r,-6);
double t37 = (t30*t36)/2.;
double t38 = t35 + t37;
double t39 = sqrt(t38);
double t40 = t33 + t39;
double t6 = r*t5;
double t7 = t4 + t6;
double t8 = -(t4*t7);
double t9 = t3 + t4;
double t11 = pow(t9,2);
double t12 = t11 + t8;
double Lz = (2*spin*t1 - 4*t12*t3*t31*t40)/sqrt(16*spin*t17*t31*t40 - (16*pow(r,6)*t12*pow(t40,2))/pow(t30,2) + t1*t5);
return Lz;
}