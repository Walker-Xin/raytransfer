void redshift(long double r, long double th, long double ktkp, long double &gg)
{
long double t8 = pow(spin,2);
long double t7 = pow(r,2);
long double t9 = t7 + t8;
long double t21 = pow(r,3);
long double t12 = sin(th);
long double t13 = pow(t12,2);
long double t22 = defpar + t21;
long double t4 = pow(r,-3);
long double t5 = defpar*t4;
long double t6 = 1 + t5;
long double t11 = t6*t9;
long double t14 = -(t13*t8);
long double t15 = t11 + t14;
long double t26 = defpar*t7;
long double t27 = pow(r,5);
long double t28 = -2*t27;
long double t29 = 3*defpar*t8;
long double t30 = t26 + t28 + t29;
long double t17 = cos(th);
long double t18 = pow(t17,2);
long double t19 = t18*t8;
long double t20 = t19 + t7;
long double t40 = pow(t9,2);
long double t42 = -2 + r;
long double t43 = r*t42;
long double t44 = t43 + t8;
long double t23 = t22*t9;
long double t24 = -(t13*t21*t8);
long double t25 = t23 + t24;
long double t57 = pow(r,4);
long double t58 = 2*t57;
long double t59 = defpar*t8;
long double t60 = t26 + t58 + t59;
long double t61 = 2*defpar;
long double t62 = 5*t21;
long double t63 = 3*r*t8;
long double t64 = -3*r*t13*t8;
long double t65 = t61 + t62 + t63 + t64;
long double t66 = 2*t20*t60*t65*t7;
long double t67 = -2*t25*t60*t7;
long double t68 = 2*defpar*r;
long double t69 = 8*t21;
long double t70 = t68 + t69;
long double t71 = -(r*t20*t25*t70);
long double t72 = -3*t20*t25*t60;
long double t73 = t66 + t67 + t71 + t72;
long double t32 = -r;
long double t33 = 1 + t32;
long double t31 = -(t22*t30*t9);
long double t34 = pow(r,7);
long double t35 = t13*t33*t34*t8;
long double t36 = t31 + t35;
long double t37 = t20*t25*t36;
long double t38 = pow(r,11);
long double t39 = pow(t6,2);
long double t41 = t39*t40;
long double t45 = -(t13*t44*t8);
long double t46 = t41 + t45;
long double t47 = t15*t38*t46;
long double t48 = pow(t22,2);
long double t49 = t40*t48;
long double t50 = pow(r,6);
long double t51 = -(t13*t44*t50*t8);
long double t52 = t49 + t51;
long double t53 = t20*t30*t52;
long double t54 = t37 + t47 + t53;
long double t88 = t14 + t43 + t8;
long double t16 = pow(t15,3);
long double t55 = 1/t54;
long double t56 = pow(t25,-3);
long double t74 = -(spin*t13*t56*t7*t73);
long double t75 = pow(t12,4);
long double t76 = pow(t25,-6);
long double t77 = pow(t73,2);
long double t78 = t57*t75*t76*t77*t8;
long double t79 = pow(r,-14);
long double t80 = pow(t15,-6);
long double t81 = 2 + t32;
long double t82 = r*t81;
long double t83 = -t8;
long double t84 = t13*t8;
long double t85 = t82 + t83 + t84;
long double t86 = 2*t20*t30*t85;
long double t87 = 2*r*t20*t25*t33;
long double t89 = -2*t25*t7*t88;
long double t90 = t86 + t87 + t89;
long double t91 = -2*t13*t54*t79*t80*t90;
long double t92 = t78 + t91;
long double t93 = sqrt(t92);
long double t94 = t74 + t93;
long double t2 = 1/sin(th);
long double t3 = pow(t2,2);
gg = sqrt(-(((-t7 - t18*t8)*t88)/pow(t15,2)) + (pow(r,13)*spin*t16*t20*t55*t60*t94)/pow(t25,2) - (pow(r,20)*pow(t15,4)*t20*t3*t46*pow(t94,2))/(4.*pow(t54,2)))/(1 - (ktkp*pow(r,10)*t16*t3*t55*t94)/2.);
}

long double specific_energy(long double r)
{
long double t3 = pow(spin,2);
long double t8 = pow(r,2);
long double t4 = -t3;
long double t5 = pow(r,-3);
long double t6 = defpar*t5;
long double t7 = 1 + t6;
long double t9 = t3 + t8;
long double t11 = t7*t9;
long double t12 = t11 + t4;
long double t2 = pow(r,3);
long double t1 = -2 + r;
long double t16 = defpar*t8;
long double t28 = r*t1;
long double t29 = t28 + t3;
long double t23 = defpar + t2;
long double t32 = pow(t9,2);
long double t22 = -(t2*t3);
long double t24 = t23*t9;
long double t25 = t22 + t24;
long double t36 = pow(r,5);
long double t37 = -2*t36;
long double t38 = 3*defpar*t3;
long double t39 = t16 + t37 + t38;
long double t17 = pow(r,4);
long double t18 = 2*t17;
long double t19 = defpar*t3;
long double t20 = t16 + t18 + t19;
long double t56 = 2*defpar;
long double t57 = 5*t2;
long double t58 = t56 + t57;
long double t59 = 2*t17*t20*t58;
long double t60 = 2*defpar*r;
long double t61 = 8*t2;
long double t62 = t60 + t61;
long double t63 = -(t2*t25*t62);
long double t64 = -5*t20*t25*t8;
long double t65 = t59 + t63 + t64;
long double t46 = -r;
long double t47 = 1 + t46;
long double t27 = pow(r,11);
long double t30 = -(t29*t3);
long double t31 = pow(t7,2);
long double t33 = t31*t32;
long double t34 = t30 + t33;
long double t35 = t12*t27*t34;
long double t40 = pow(r,6);
long double t41 = -(t29*t3*t40);
long double t42 = pow(t23,2);
long double t43 = t32*t42;
long double t44 = t41 + t43;
long double t45 = t39*t44*t8;
long double t48 = pow(r,7);
long double t49 = t3*t47*t48;
long double t50 = -(t23*t39*t9);
long double t51 = t49 + t50;
long double t52 = t25*t51*t8;
long double t53 = t35 + t45 + t52;
long double t13 = pow(t12,-2);
long double t14 = t1*t13*t2;
long double t15 = pow(r,15);
long double t21 = pow(t12,3);
long double t26 = pow(t25,-2);
long double t54 = 1/t53;
long double t55 = pow(t25,-3);
long double t66 = -(spin*t55*t65*t8);
long double t67 = pow(t25,-6);
long double t68 = pow(t65,2);
long double t69 = t17*t3*t67*t68;
long double t70 = pow(r,-14);
long double t71 = pow(t12,-6);
long double t72 = 2 + t46;
long double t73 = 2*t2*t39*t72;
long double t74 = 2*t2*t25*t47;
long double t75 = -2*t1*t2*t25;
long double t76 = t73 + t74 + t75;
long double t77 = -2*t53*t70*t71*t76;
long double t78 = t69 + t77;
long double t79 = sqrt(t78);
long double t80 = t66 + t79;
long double se = (t14 + (spin*t15*t20*t21*t26*t54*t80)/2.)/sqrt(t14 + spin*t15*t20*t21*t26*t54*t80 - (pow(r,22)*pow(t12,4)*t34*pow(t80,2))/(4.*pow(t53,2)));
return se;
}

long double specific_momentum(long double r)
{
long double t6 = pow(spin,2);
long double t9 = pow(r,3);
long double t2 = pow(r,2);
long double t13 = t2 + t6;
long double t20 = pow(r,-3);
long double t21 = defpar*t20;
long double t22 = 1 + t21;
long double t19 = -t6;
long double t23 = t13*t22;
long double t24 = t19 + t23;
long double t25 = -2 + r;
long double t26 = r*t25;
long double t27 = t26 + t6;
long double t28 = -(t27*t6);
long double t29 = pow(t22,2);
long double t30 = pow(t13,2);
long double t31 = t29*t30;
long double t32 = t28 + t31;
long double t3 = defpar*t2;
long double t1 = pow(r,5);
long double t12 = defpar + t9;
long double t11 = -(t6*t9);
long double t14 = t12*t13;
long double t15 = t11 + t14;
long double t35 = -2*t1;
long double t36 = 3*defpar*t6;
long double t37 = t3 + t35 + t36;
long double t4 = pow(r,4);
long double t5 = 2*t4;
long double t7 = defpar*t6;
long double t8 = t3 + t5 + t7;
long double t54 = 2*defpar;
long double t55 = 5*t9;
long double t56 = t54 + t55;
long double t57 = 2*t4*t56*t8;
long double t58 = 2*defpar*r;
long double t59 = 8*t9;
long double t60 = t58 + t59;
long double t61 = -(t15*t60*t9);
long double t62 = -5*t15*t2*t8;
long double t63 = t57 + t61 + t62;
long double t44 = -r;
long double t45 = 1 + t44;
long double t33 = pow(r,11);
long double t34 = t24*t32*t33;
long double t38 = pow(r,6);
long double t39 = -(t27*t38*t6);
long double t40 = pow(t12,2);
long double t41 = t30*t40;
long double t42 = t39 + t41;
long double t43 = t2*t37*t42;
long double t46 = pow(r,7);
long double t47 = t45*t46*t6;
long double t48 = -(t12*t13*t37);
long double t49 = t47 + t48;
long double t50 = t15*t2*t49;
long double t51 = t34 + t43 + t50;
long double t16 = pow(t15,-2);
long double t52 = 1/t51;
long double t53 = pow(t15,-3);
long double t64 = -(spin*t2*t53*t63);
long double t65 = pow(t15,-6);
long double t66 = pow(t63,2);
long double t67 = t4*t6*t65*t66;
long double t68 = pow(r,-14);
long double t69 = pow(t24,-6);
long double t70 = 2 + t44;
long double t71 = 2*t37*t70*t9;
long double t72 = 2*t15*t45*t9;
long double t73 = -2*t15*t25*t9;
long double t74 = t71 + t72 + t73;
long double t75 = -2*t51*t68*t69*t74;
long double t76 = t67 + t75;
long double t77 = sqrt(t76);
long double t78 = t64 + t77;
long double Lz = (-0.5*(pow(r,12)*t24*t32*t52*t78) + spin*t1*t16*t8)/sqrt(-0.25*(pow(r,22)*pow(t24,4)*t32*pow(t78,2))/pow(t51,2) + pow(r,15)*spin*t16*pow(t24,3)*t52*t78*t8 + (t25*t9)/pow(t24,2));
return Lz;
}