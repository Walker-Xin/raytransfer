void redshift(double r, double th, double ktkp, double &gg)
{
double t3 = pow(spin,2);
double t1 = pow(r,2);
double t16 = pow(spin,4);
double t4 = 2*th;
double t5 = cos(t4);
double t6 = t3*t5;
double t2 = 2*t1;
double t7 = t2 + t3 + t6;
double t32 = -2*t1;
double t33 = t3 + t32 + t6;
double t9 = pow(r,5);
double t12 = 8*t9;
double t13 = -4*t1*t3;
double t14 = pow(r,3);
double t15 = 8*t14*t3;
double t17 = 3*r*t16;
double t18 = 2*r;
double t19 = 1 + t18;
double t20 = r*t19;
double t21 = t20 + t3;
double t22 = 4*r*t21*t3*t5;
double t23 = -r;
double t24 = 1 + t23;
double t25 = 4*th;
double t26 = cos(t25);
double t27 = -(t16*t24*t26);
double t28 = t12 + t13 + t15 + t16 + t17 + t22 + t27;
double t35 = sin(th);
double t36 = pow(t35,2);
double t38 = pow(t7,-4);
double t29 = 1/t28;
double t34 = pow(t7,-2);
double t37 = 4*spin*t33*t34*t36;
double t39 = -4*t28*t33*t36*t38;
double t40 = pow(t33,2);
double t41 = pow(t35,4);
double t42 = 16*t3*t38*t40*t41;
double t43 = t39 + t42;
double t44 = sqrt(t43);
double t45 = t37 + t44;
double t30 = 1/sin(th);
double t31 = pow(t30,2);
double t49 = -2 + r;
gg = sqrt((t3 + 2*r*t49 + t6)/t7 + 8*r*spin*t29*t45*t7 - (t31*pow(t45,2)*(pow(t1 + t3,2) - t3*t36*(t3 + r*t49))*pow(t7,4)*(t1 + t3*pow(cos(th),2)))/(pow(t28,2)*pow(t1 + t3 - t3*t36,2)))/(1 - ktkp*t29*t31*t45*pow(t7,2));
}

double specific_energy(double r)
{
double t4 = pow(r,3);
double t8 = pow(spin,2);
double t13 = pow(spin,4);
double t5 = pow(r,5);
double t6 = 8*t5;
double t7 = pow(r,2);
double t9 = -4*t7*t8;
double t12 = 8*t4*t8;
double t14 = -r;
double t15 = 1 + t14;
double t16 = -(t13*t15);
double t17 = 3*r*t13;
double t18 = 2*r;
double t19 = 1 + t18;
double t20 = r*t19;
double t21 = t20 + t8;
double t22 = -4*r*t21*t8;
double t23 = t12 + t13 + t16 + t17 + t22 + t6 + t9;
double t1 = -2 + r;
double t2 = 1/r;
double t3 = t1*t2;
double t24 = 1/t23;
double t25 = pow(r,-2);
double t26 = -2*spin*t25;
double t27 = pow(r,-4);
double t28 = 4*t27*t8;
double t29 = pow(r,-6);
double t30 = (t23*t29)/2.;
double t31 = t28 + t30;
double t32 = sqrt(t31);
double t33 = t26 + t32;
double se = (t3 + 8*spin*t24*t33*t4)/sqrt(t3 + 16*spin*t24*t33*t4 - (16*pow(r,6)*pow(t33,2)*(-(t8*(r*t1 + t8)) + pow(t7 + t8,2)))/pow(t23,2));
return se;
}

double specific_momentum(double r)
{
double t4 = pow(spin,2);
double t3 = pow(r,2);
double t19 = pow(spin,4);
double t14 = pow(r,5);
double t15 = 8*t14;
double t16 = -4*t3*t4;
double t17 = pow(r,3);
double t18 = 8*t17*t4;
double t20 = -r;
double t21 = 1 + t20;
double t22 = -(t19*t21);
double t23 = 3*r*t19;
double t24 = 2*r;
double t25 = 1 + t24;
double t26 = r*t25;
double t27 = t26 + t4;
double t28 = -4*r*t27*t4;
double t29 = t15 + t16 + t18 + t19 + t22 + t23 + t28;
double t5 = -2 + r;
double t1 = 1/r;
double t30 = 1/t29;
double t31 = pow(r,-2);
double t32 = -2*spin*t31;
double t33 = pow(r,-4);
double t34 = 4*t33*t4;
double t35 = pow(r,-6);
double t36 = (t29*t35)/2.;
double t37 = t34 + t36;
double t38 = sqrt(t37);
double t39 = t32 + t38;
double t6 = r*t5;
double t7 = t4 + t6;
double t8 = -(t4*t7);
double t9 = t3 + t4;
double t12 = pow(t9,2);
double t13 = t12 + t8;
double Lz = (2*spin*t1 - 4*t13*t3*t30*t39)/sqrt(16*spin*t17*t30*t39 - (16*pow(r,6)*t13*pow(t39,2))/pow(t29,2) + t1*t5);
return Lz;
}