void redshift(long double r, long double th, long double ktkp, long double &gg)
{
long double t8 = pow(spin,2);
long double t7 = pow(r,2);
long double t24 = pow(r,3);
long double t9 = t7 + t8;
long double t21 = defpar*t7;
long double t22 = pow(r,5);
long double t12 = sin(th);
long double t13 = pow(t12,2);
long double t4 = pow(r,-3);
long double t5 = defpar*t4;
long double t6 = 1 + t5;
long double t11 = t6*t9;
long double t14 = -2*t13*t8;
long double t15 = t11 + t14;
long double t30 = -2*t22;
long double t31 = 3*defpar*t8;
long double t32 = t21 + t30 + t31;
long double t17 = cos(th);
long double t18 = pow(t17,2);
long double t19 = t18*t8;
long double t20 = t19 + t7;
long double t29 = defpar + t24;
long double t42 = pow(t9,2);
long double t44 = -2 + r;
long double t45 = r*t44;
long double t46 = t45 + t8;
long double t62 = 2 + r;
long double t59 = pow(r,-7);
long double t60 = 2*defpar*t7;
long double t61 = pow(r,4);
long double t63 = t61*t62;
long double t64 = 2*defpar;
long double t65 = t24 + t64;
long double t66 = t65*t8;
long double t67 = t60 + t63 + t66;
long double t68 = -2*t20*t32*t59*t67;
long double t69 = 1/r;
long double t70 = 2*defpar*t69;
long double t71 = r*t62;
long double t72 = 2*defpar*t4;
long double t73 = 1 + t72;
long double t74 = t73*t8;
long double t75 = t70 + t71 + t74;
long double t76 = -2*r*t15*t75;
long double t77 = pow(r,-4);
long double t78 = 3*t8;
long double t79 = t7 + t78;
long double t80 = -(defpar*t77*t79);
long double t81 = 1 + r + t80;
long double t82 = -2*t15*t20*t81;
long double t83 = t68 + t76 + t82;
long double t86 = pow(t15,-6);
long double t94 = -4*t13*t8;
long double t95 = t45 + t8 + t94;
long double t23 = defpar*t8;
long double t25 = 2*th;
long double t26 = cos(t25);
long double t27 = t24*t26*t8;
long double t28 = t21 + t22 + t23 + t27;
long double t33 = -(t29*t32*t9);
long double t34 = -r;
long double t35 = 1 + t34;
long double t36 = pow(r,7);
long double t37 = t13*t35*t36*t8;
long double t38 = t33 + t37;
long double t39 = t20*t28*t38;
long double t40 = pow(r,11);
long double t41 = pow(t6,2);
long double t43 = t41*t42;
long double t47 = -(t13*t46*t8);
long double t48 = t43 + t47;
long double t49 = t15*t40*t48;
long double t50 = pow(t29,2);
long double t51 = t42*t50;
long double t52 = pow(r,6);
long double t53 = -(t13*t46*t52*t8);
long double t54 = t51 + t53;
long double t55 = t20*t32*t54;
long double t56 = t39 + t49 + t55;
long double t1 = pow(r,10);
long double t57 = 1/t56;
long double t58 = pow(t15,-3);
long double t84 = -(spin*t13*t58*t83);
long double t85 = pow(t12,4);
long double t87 = pow(t83,2);
long double t88 = t8*t85*t86*t87;
long double t89 = pow(r,-10);
long double t90 = -(defpar*t7);
long double t91 = 2*t22;
long double t92 = -3*defpar*t8;
long double t93 = t90 + t91 + t92;
long double t96 = -2*t20*t77*t93*t95;
long double t97 = 2*r;
long double t98 = -2 + t97;
long double t99 = t15*t20*t98;
long double t100 = 2*r*t15*t95;
long double t101 = t100 + t96 + t99;
long double t102 = -2*t101*t13*t56*t86*t89;
long double t103 = t102 + t88;
long double t104 = sqrt(t103);
long double t105 = t104 + t84;
long double t2 = 1/sin(th);
long double t3 = pow(t2,2);
gg = sqrt(-0.25*(pow(r,20)*pow(t105,2)*pow(t15,4)*t20*t3*t48)/pow(t56,2) + spin*t1*t105*t15*t20*t57*t75 - (t20*t95)/pow(t15,2))/(1 - (ktkp*t1*t105*pow(t15,3)*t3*t57)/2.);
}

long double specific_energy(long double r)
{
long double t4 = pow(spin,2);
long double t1 = pow(r,2);
long double t8 = pow(r,-3);
long double t7 = -2*t4;
long double t9 = defpar*t8;
long double t11 = 1 + t9;
long double t12 = t1 + t4;
long double t13 = t11*t12;
long double t14 = t13 + t7;
long double t2 = -2 + r;
long double t3 = r*t2;
long double t27 = t3 + t4;
long double t30 = pow(t12,2);
long double t34 = defpar*t1;
long double t35 = pow(r,5);
long double t41 = pow(r,3);
long double t42 = defpar + t41;
long double t36 = -2*t35;
long double t37 = 3*defpar*t4;
long double t38 = t34 + t36 + t37;
long double t20 = 2 + r;
long double t18 = 1/r;
long double t19 = 2*defpar*t18;
long double t21 = r*t20;
long double t22 = 2*defpar*t8;
long double t23 = 1 + t22;
long double t24 = t23*t4;
long double t25 = t19 + t21 + t24;
long double t60 = pow(r,-5);
long double t61 = 2*defpar*t1;
long double t62 = pow(r,4);
long double t63 = t20*t62;
long double t64 = 2*defpar;
long double t65 = t41 + t64;
long double t66 = t4*t65;
long double t67 = t61 + t63 + t66;
long double t68 = -2*t38*t60*t67;
long double t69 = -2*r*t14*t25;
long double t70 = pow(r,-4);
long double t71 = 3*t4;
long double t72 = t1 + t71;
long double t73 = -(defpar*t70*t72);
long double t74 = 1 + r + t73;
long double t75 = -2*t1*t14*t74;
long double t76 = t68 + t69 + t75;
long double t78 = pow(t14,-6);
long double t5 = -3*t4;
long double t6 = t3 + t5;
long double t26 = pow(r,11);
long double t28 = -(t27*t4);
long double t29 = pow(t11,2);
long double t31 = t29*t30;
long double t32 = t28 + t31;
long double t33 = t14*t26*t32;
long double t39 = pow(r,6);
long double t40 = -(t27*t39*t4);
long double t43 = pow(t42,2);
long double t44 = t30*t43;
long double t45 = t40 + t44;
long double t46 = t1*t38*t45;
long double t47 = defpar*t4;
long double t48 = -(t4*t41);
long double t49 = t34 + t35 + t47 + t48;
long double t50 = -r;
long double t51 = 1 + t50;
long double t52 = pow(r,7);
long double t53 = t4*t51*t52;
long double t54 = -(t12*t38*t42);
long double t55 = t53 + t54;
long double t56 = t1*t49*t55;
long double t57 = t33 + t46 + t56;
long double t15 = pow(t14,-2);
long double t16 = -(t1*t15*t6);
long double t17 = pow(r,12);
long double t58 = 1/t57;
long double t59 = pow(t14,-3);
long double t77 = -(spin*t59*t76);
long double t79 = pow(t76,2);
long double t80 = t4*t78*t79;
long double t81 = pow(r,-10);
long double t82 = pow(r,-2);
long double t83 = -(defpar*t1);
long double t84 = 2*t35;
long double t85 = -3*defpar*t4;
long double t86 = t83 + t84 + t85;
long double t87 = -2*t6*t82*t86;
long double t88 = 2*r;
long double t89 = -2 + t88;
long double t90 = t1*t14*t89;
long double t91 = 2*r*t14*t6;
long double t92 = t87 + t90 + t91;
long double t93 = -2*t57*t78*t81*t92;
long double t94 = t80 + t93;
long double t95 = sqrt(t94);
long double t96 = t77 + t95;
long double se = (t16 + (spin*t14*t17*t25*t58*t96)/2.)/sqrt(t16 + spin*t14*t17*t25*t58*t96 - (pow(r,22)*pow(t14,4)*t32*pow(t96,2))/(4.*pow(t57,2)));
return se;
}

long double specific_momentum(long double r)
{
long double t9 = pow(spin,2);
long double t6 = pow(r,-3);
long double t1 = pow(r,2);
long double t13 = -2*t9;
long double t14 = defpar*t6;
long double t15 = 1 + t14;
long double t16 = t1 + t9;
long double t17 = t15*t16;
long double t18 = t13 + t17;
long double t22 = -2 + r;
long double t23 = r*t22;
long double t24 = t23 + t9;
long double t25 = -(t24*t9);
long double t26 = pow(t15,2);
long double t27 = pow(t16,2);
long double t28 = t26*t27;
long double t29 = t25 + t28;
long double t32 = defpar*t1;
long double t33 = pow(r,5);
long double t39 = pow(r,3);
long double t40 = defpar + t39;
long double t34 = -2*t33;
long double t35 = 3*defpar*t9;
long double t36 = t32 + t34 + t35;
long double t4 = 2 + r;
long double t2 = 1/r;
long double t3 = 2*defpar*t2;
long double t5 = r*t4;
long double t7 = 2*defpar*t6;
long double t8 = 1 + t7;
long double t11 = t8*t9;
long double t12 = t11 + t3 + t5;
long double t58 = pow(r,-5);
long double t59 = 2*defpar*t1;
long double t60 = pow(r,4);
long double t61 = t4*t60;
long double t62 = 2*defpar;
long double t63 = t39 + t62;
long double t64 = t63*t9;
long double t65 = t59 + t61 + t64;
long double t66 = -2*t36*t58*t65;
long double t67 = -2*r*t12*t18;
long double t68 = pow(r,-4);
long double t69 = 3*t9;
long double t70 = t1 + t69;
long double t71 = -(defpar*t68*t70);
long double t72 = 1 + r + t71;
long double t73 = -2*t1*t18*t72;
long double t74 = t66 + t67 + t73;
long double t76 = pow(t18,-6);
long double t81 = -3*t9;
long double t82 = t23 + t81;
long double t30 = pow(r,11);
long double t31 = t18*t29*t30;
long double t37 = pow(r,6);
long double t38 = -(t24*t37*t9);
long double t41 = pow(t40,2);
long double t42 = t27*t41;
long double t43 = t38 + t42;
long double t44 = t1*t36*t43;
long double t45 = defpar*t9;
long double t46 = -(t39*t9);
long double t47 = t32 + t33 + t45 + t46;
long double t48 = -r;
long double t49 = 1 + t48;
long double t50 = pow(r,7);
long double t51 = t49*t50*t9;
long double t52 = -(t16*t36*t40);
long double t53 = t51 + t52;
long double t54 = t1*t47*t53;
long double t55 = t31 + t44 + t54;
long double t19 = pow(t18,-2);
long double t21 = pow(r,12);
long double t56 = 1/t55;
long double t57 = pow(t18,-3);
long double t75 = -(spin*t57*t74);
long double t77 = pow(t74,2);
long double t78 = t76*t77*t9;
long double t79 = pow(r,-10);
long double t80 = pow(r,-2);
long double t83 = -(defpar*t1);
long double t84 = 2*t33;
long double t85 = -3*defpar*t9;
long double t86 = t83 + t84 + t85;
long double t87 = -2*t80*t82*t86;
long double t88 = 2*r;
long double t89 = -2 + t88;
long double t90 = t1*t18*t89;
long double t91 = 2*r*t18*t82;
long double t92 = t87 + t90 + t91;
long double t93 = -2*t55*t76*t79*t92;
long double t94 = t78 + t93;
long double t95 = sqrt(t94);
long double t96 = t75 + t95;
long double Lz = (spin*t1*t12*t19 - (t18*t21*t29*t56*t96)/2.)/sqrt(-(t1*t19*t82) + spin*t12*t18*t21*t56*t96 - (pow(r,22)*pow(t18,4)*t29*pow(t96,2))/(4.*pow(t55,2)));
return Lz;
}