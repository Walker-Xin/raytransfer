{
 "cells": [
  {
   "kind": 2,
   "value": "Remove[\"Global`*\"]",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549063025,
     "endTime": 1691549063108
    },
    "executionOrder": 16,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "f = epsi*M^3/r;\r\nA1 = 1 + a13*(M/r)^3;\r\nA2 = 2 + a22*(M/r)^2;\r\nA5 = 1 + a52*(M/r)^2;\r\n\r\nepsi = 0;\r\na13 = 0;\r\na22 = 0;\r\na52 = 0;\r\nb2 = 0;\r\nc1 = 0;\r\nc2 = 0;\r\n\r\nB = (r^2 + a^2)*A1 - a^2*A2*Sin[theta]^2;\r\nSigma = r^2 + a^2*Cos[theta]^2;\r\nSigmavar = Sigma + f;\r\nDelta = r^2 - 2*M*r + a^2;",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549063109,
     "endTime": 1691549064155
    },
    "executionOrder": 17,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "## Covariant Metric Components",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "gtt = Sigmavar*(Delta - a^2*A2^2*Sin[theta]^2)/B^2;\r\ngrr = Sigmavar/(Delta*A5);\r\ngthth = Sigmavar;\r\ngpp = ((r^2 + a^2)^2*A1^2 - a^2*Delta*Sin[theta]^2)*Sigmavar*\r\n   Sin[theta]^2/B^2;\r\ngtp = -a*((r^2 + a^2)*A1*A2 - Delta)*Sigmavar*Sin[theta]^2/B^2;\r\ngtr = b1*a/r + b2*a*M/r^2;\r\ngrp = c1*a*Sin[theta]^2/r + c2*a*M*Sin[theta]^2/r^2;\r\n\r\ngtt = Simplify[gtt];\r\ngrr = Simplify[grr];\r\ngthth = Simplify[gthth];\r\ngpp = Simplify[gpp];\r\ngtp = Simplify[gtp];\r\ngtr = Simplify[gtr];\r\ngrp = Simplify[grp];",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549064156,
     "endTime": 1691549065559
    },
    "executionOrder": 32,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "## Contravariant Metric Components",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "G = Simplify[{{gtt, gtr, 0, gtp}, {gtr, grr, 0, grp}, {0, 0, gthth, \r\n     0}, {gtp, grp, 0, gpp}}];\r\nG // MatrixForm\r\n\r\nGinv = Simplify[Inverse[G]];\r\nGinv // MatrixForm",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><wrow><w></w><wb>(</wb><w>⁠</w><wgrid style=\"grid-template-columns:repeat(4,max-content);\"><w><wfrac><w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></w></w></wfrac></w><w><wfrac><w><wrow><w></w><w>b1</w><w></w><w>spin</w></wrow></w><w><w></w><w><w>r</w></w></w></wfrac></w><w><w>0</w></w><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><w>spin</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></w></w></wfrac></wrow></w><w><wfrac><w><wrow><w></w><w>b1</w><w></w><w>spin</w></wrow></w><w><w></w><w><w>r</w></w></w></wfrac></w><w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow></w></w></wfrac></w><w><w>0</w></w><w><w>0</w></w><w><w>0</w></w><w><w>0</w></w><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow></w><w><w>0</w></w><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><w>spin</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></w></w></wfrac></wrow></w><w><w>0</w></w><w><w>0</w></w><w><wfrac><w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></w></w></wfrac></w></wgrid><w>⁠</w><wb>)</wb></wrow></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "MatrixForm[{{((r^2 + spin^2*Cos[th]^2)*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))/(r^2 + spin^2*Cos[2*th])^2, (b1*spin)/r, 0, -((spin*(r*(2 + r) + spin^2)*(r^2 + spin^2*Cos[th]^2)*Sin[th]^2)/(r^2 + spin^2*Cos[2*th])^2)}, {(b1*spin)/r, (r^2 + spin^2*Cos[th]^2)/(-2*r + r^2 + spin^2), 0, 0}, {0, 0, r^2 + spin^2*Cos[th]^2, 0}, {-((spin*(r*(2 + r) + spin^2)*(r^2 + spin^2*Cos[th]^2)*Sin[th]^2)/(r^2 + spin^2*Cos[2*th])^2), 0, 0, ((r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2))/(r^2 + spin^2*Cos[2*th])^2}}]",
       "mime": "text/plain"
      }
     ],
     "id": "7bd1e072-406f-4de6-a473-8e66a1666e07",
     "metadata": {
      "cellLabel": "Out[162]//MatrixForm= ",
      "isBoxData": false
     }
    },
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><wrow><w></w><wb>(</wb><w>⁠</w><wgrid style=\"grid-template-columns:repeat(4,max-content);\"><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></wrow></w><w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>b1</w><w></w><w>r</w><w></w><w>spin</w></wrow><w>+</w><wfrac class=\"script\"><w><wrow><w></w><w>b1</w><w></w><wsup><w></w><w>spin</w><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><w>r</w></w></w></wfrac></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></w><w><w>0</w></w><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><w>spin</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></wrow></w><w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>b1</w><w></w><w>r</w><w></w><w>spin</w></wrow><w>+</w><wfrac class=\"script\"><w><wrow><w></w><w>b1</w><w></w><wsup><w></w><w>spin</w><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><w>r</w></w></w></wfrac></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></w><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></wrow></w><w><w>0</w></w><w><wfrac><w><wrow><w></w><w>b1</w><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></w><w><w>0</w></w><w><w>0</w></w><w><wfrac><w><w>1</w></w><w><w></w><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow></w></w></wfrac></w><w><w>0</w></w><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><w>spin</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></wrow></w><w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><w>spin</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>b1</w><w></w><w>r</w><w></w><w>spin</w></wrow><w>+</w><wfrac class=\"script\"><w><wrow><w></w><w>b1</w><w></w><wsup><w></w><w>spin</w><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><w>r</w></w></w></wfrac></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></w><w><w>0</w></w><w><wrow><w></w><w>-</w><wfrac><w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>4</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><wfrac class=\"script\"><w><wrow><w></w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow></w><w><w></w><w><wsup><w></w><w>r</w><w><w>2</w></w></wsup></w></w></wfrac></wrow><w>+</w><wfrac class=\"script\"><w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow></w></w></wfrac></wrow><wb>)</wb></wrow></wrow></w><w><w></w><w><wrow><w></w><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>r</w><w></w><wrow><w></w><wb>(</wb><wrow><w></w><w>2</w><w>+</w><w>r</w></wrow><wb>)</wb></wrow></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>3</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>4</w></w></wsup></wrow><w>-</w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w>-</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><wsup><w></w><w>b1</w><w><w>2</w></w></wsup></wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup></wrow><wb>)</wb></wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>2</w></w></wsup><w>+</w><wrow><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><wrow><w></w><w>2</w><w></w><w>th</w></wrow><wb>]</wb></wrow></wrow></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup></wrow><w>+</w><wrow><w></w><wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wsup><w></w><w>r</w><w><w>3</w></w></wsup><w>+</w><wrow><w></w><w>r</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Cos</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow><w><w>2</w></w></wsup><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><wrow><w></w><wb>(</wb><wrow><w></w><wrow><w></w><w>-</w><w>2</w></wrow><w>+</w><w>r</w></wrow><wb>)</wb></wrow><w></w><w>r</w></wrow><w>+</w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w>-</w><wrow><w></w><w>4</w><w></w><wsup><w></w><w>spin</w><w><w>2</w></w></wsup><w></w><wsup><w></w><wrow><w></w><w>Sin</w><wrow><w></w><wb>[</wb><w>th</w><wb>]</wb></wrow></wrow><w><w>2</w></w></wsup></wrow></wrow><wb>)</wb></wrow></wrow></wrow><wb>)</wb></wrow></wrow></wrow></w></w></wfrac></wrow></w></wgrid><w>⁠</w><wb>)</wb></wrow></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "MatrixForm[{{-((r^2*(r^2 + spin^2*Cos[th]^2)^2*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2))/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2)))), (r^2*(-2*r + r^2 + spin^2)*(b1*r*spin + (b1*spin^3*Cos[th]^2)/r)*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2))/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))), 0, -((r^2*spin*(r*(2 + r) + spin^2)*(r^2 + spin^2*Cos[th]^2)^2*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2)/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))))}, {(r^2*(-2*r + r^2 + spin^2)*(b1*r*spin + (b1*spin^3*Cos[th]^2)/r)*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2))/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))), -((r^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[th]^2)^2*Sin[th]^2*(-(spin^2*(r*(2 + r) + spin^2)^2*Sin[th]^2) + ((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2)*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)))/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2)))), 0, (b1*r*spin^2*(-2*r + r^2 + spin^2)*(r*(2 + r) + spin^2)*(r^2 + spin^2*Cos[th]^2)*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2)/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2)))}, {0, 0, (r^2 + spin^2*Cos[th]^2)^(-1), 0}, {-((r^2*spin*(r*(2 + r) + spin^2)*(r^2 + spin^2*Cos[th]^2)^2*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2)/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2)))), (r^2*spin*(-2*r + r^2 + spin^2)*(r*(2 + r) + spin^2)*(b1*r*spin + (b1*spin^3*Cos[th]^2)/r)*(r^2 + spin^2*Cos[2*th])^2*Sin[th]^2)/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))), 0, -((r^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^4*(-((b1^2*spin^2)/r^2) + ((r^2 + spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))/((-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2)))/(r^2*spin^2*(r*(2 + r) + spin^2)^2*(r^2 + spin^2*Cos[th]^2)^3*Sin[th]^4 - (r^2 + spin^2*Cos[th]^2)*Sin[th]^2*((r^2 + spin^2)^2 - spin^2*((-2 + r)*r + spin^2)*Sin[th]^2)*(-(b1^2*spin^2*(-2*r + r^2 + spin^2)*(r^2 + spin^2*Cos[2*th])^2) + (r^3 + r*spin^2*Cos[th]^2)^2*((-2 + r)*r + spin^2 - 4*spin^2*Sin[th]^2))))}}]",
       "mime": "text/plain"
      }
     ],
     "id": "5b196011-3189-4536-b7df-3cd40df7dba9",
     "metadata": {
      "cellLabel": "Out[164]//MatrixForm= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549121991,
     "endTime": 1691549127373
    },
    "executionOrder": 161,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "gutt = Ginv[[1]][[1]];\r\ngurr = Ginv[[2]][[2]];\r\nguthth = Ginv[[3]][[3]];\r\ngupp = Ginv[[4]][[4]];\r\ngutr = Ginv[[1]][[2]];\r\ngutp = Ginv[[1]][[4]];\r\ngurp = Ginv[[2]][[4]];",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549073109,
     "endTime": 1691549073610
    },
    "executionOrder": 50,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "## Christoffel Symbol",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "Christ = ResourceFunction[\"ChristoffelSymbol\"][G, {t, r, theta, phi}, \"Kind\" -> \"Second\"];\r\nChrist = Simplify[Christ];",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691551453083,
     "endTime": 1691551485932
    },
    "executionOrder": 371,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "chttt = Simplify[Part[Christ, 1, 1, 1]];\r\nchttr = Simplify[Part[Christ, 1, 1, 2]];\r\nchttth = Simplify[Part[Christ, 1, 1, 3]];\r\nchttp = Simplify[Part[Christ, 1, 1, 4]];\r\nchtrr = Simplify[Part[Christ, 1, 2, 2]];\r\nchtrth = Simplify[Part[Christ, 1, 2, 3]];\r\nchtrp = Simplify[Part[Christ, 1, 2, 4]];\r\nchtthth = Simplify[Part[Christ, 1, 3, 3]];\r\nchtthp = Simplify[Part[Christ, 1, 3, 4]];\r\nchtpp = Simplify[Part[Christ, 1, 4, 4]];\r\n\r\nchrtt = Simplify[Part[Christ, 2, 1, 1]];\r\nchrtr = Simplify[Part[Christ, 2, 1, 2]];\r\nchrtth = Simplify[Part[Christ, 2, 1, 3]];\r\nchrtp = Simplify[Part[Christ, 2, 1, 4]];\r\nchrrr = Simplify[Part[Christ, 2, 2, 2]];\r\nchrrth = Simplify[Part[Christ, 2, 2, 3]];\r\nchrrp = Simplify[Part[Christ, 2, 2, 4]];\r\nchrthth = Simplify[Part[Christ, 2, 3, 3]];\r\nchrthp = Simplify[Part[Christ, 2, 3, 4]];\r\nchrpp = Simplify[Part[Christ, 2, 4, 4]];\r\n\r\nchthtt = Simplify[Part[Christ, 3, 1, 1]];\r\nchthtr = Simplify[Part[Christ, 3, 1, 2]];\r\nchthtth = Simplify[Part[Christ, 3, 1, 3]];\r\nchthtp = Simplify[Part[Christ, 3, 1, 4]];\r\nchthrr = Simplify[Part[Christ, 3, 2, 2]];\r\nchthrth = Simplify[Part[Christ, 3, 2, 3]];\r\nchthrp = Simplify[Part[Christ, 3, 2, 4]];\r\nchththth = Simplify[Part[Christ, 3, 3, 3]];\r\nchththp = Simplify[Part[Christ, 3, 3, 4]];\r\nchthpp = Simplify[Part[Christ, 3, 4, 4]];\r\n\r\nchptt = Simplify[Part[Christ, 4, 1, 1]];\r\nchptr = Simplify[Part[Christ, 4, 1, 2]];\r\nchptth = Simplify[Part[Christ, 4, 1, 3]];\r\nchptp = Simplify[Part[Christ, 4, 1, 4]];\r\nchprr = Simplify[Part[Christ, 4, 2, 2]];\r\nchprth = Simplify[Part[Christ, 4, 2, 3]];\r\nchprp = Simplify[Part[Christ, 4, 2, 4]];\r\nchpthth = Simplify[Part[Christ, 4, 3, 3]];\r\nchpthp = Simplify[Part[Christ, 4, 3, 4]];\r\nchppp = Simplify[Part[Christ, 4, 4, 4]];",
   "languageId": "wolfram",
   "mime": "text/plain",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549074896,
     "endTime": 1691549079100
    },
    "executionOrder": 58,
    "success": false
   }
  },
  {
   "kind": 1,
   "value": "## Metric Derivatives",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "(* dgttdr = Simplify[D[gtt, r]];\r\ndgrrdr = Simplify[D[grr, r]];\r\ndgththdr = Simplify[D[gthth, r]];\r\ndgppdr = Simplify[D[gpp, r]];\r\ndgtpdr = Simplify[D[gtp, r]];\r\ndgtrdr = Simplify[D[gtr, r]];\r\ndgrpdr = Simplify[D[grp, r]];\r\n\r\ndgttdth = Simplify[D[gtt, theta]];\r\ndgrrdth = Simplify[D[grr, theta]];\r\ndgththdth = Simplify[D[gthth, theta]];\r\ndgppdth = Simplify[D[gpp, theta]];\r\ndgtpdth = Simplify[D[gtp, theta]];\r\ndgtrdth = Simplify[D[gtr, theta]];\r\ndgrpdth = Simplify[D[grp, theta]];\r\n\r\ndgttdr2 = Simplify[D[dgttdr, r]];\r\ndgrrdr2 = Simplify[D[dgrrdr, r]];\r\ndgththdr2 = Simplify[D[dgththdr, r]];\r\ndgppdr2 = Simplify[D[dgppdr, r]];\r\ndgtpdr2 = Simplify[D[dgtpdr, r]];\r\ndgtrdr2 = Simplify[D[dgtrdr, r]];\r\ndgrpdr2 = Simplify[D[dgrpdr, r]];\r\n\r\ndgttdth2 = Simplify[D[dgttdth, theta]];\r\ndgrrdth2 = Simplify[D[dgrrdth, theta]];\r\ndgththdth2 = Simplify[D[dgththdth, theta]];\r\ndgppdth2 = Simplify[D[dgppdth, theta]];\r\ndgtpdth2 = Simplify[D[dgtpdth, theta]];\r\ndgtrdth2 = Simplify[D[dgtrdth, theta]];\r\ndgrpdth2 = Simplify[D[dgrpdth, theta]]; *)",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549088713,
     "endTime": 1691549093590
    },
    "executionOrder": 115,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "dGdr = Simplify[D[G, r]];\r\ndGdth = Simplify[D[G, theta]];\r\ndGdr2 = Simplify[D[G, {r, 2}]];\r\ndGdth2 = Simplify[D[G, {theta, 2}]];",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549861596,
     "endTime": 1691549861880
    },
    "executionOrder": 222,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "## Convert to C Code",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "(* ::Package:: *)\r\n\r\nBeginPackage[ \"OptimizeExpressionToC`\"]\r\n\r\nOptimizeExpressionToC::usage = \"Generates optimized version of expression in C\";\r\n\r\nExtractTags::usage = \"\";\r\nClearTagText::usage = \"\";\r\nTagExistQ::usage = \"\";\r\nAppendToTag::usage = \"\";\r\n\r\nBegin[ \"Private`\"]\r\n\r\nOptimizeExpressionToC[expr_List] :=\r\n\tModule[ {optimizedExpr, mainExpr, n, m, defs, output},\r\n\t\toptimizedExpr = Experimental`OptimizeExpression[expr];\r\n\t\tIf[ ToString@optimizedExpr[[1, 0]] == \"Block\",\r\n\t\t    {n = Length[optimizedExpr[[1, 1]]];\r\n\t\t     mainExpr = optimizedExpr[[1, 2, n + 1]];},\r\n\t\t    {n = 0;\r\n\t\t     mainExpr = Flatten@{optimizedExpr[[1]]};}\r\n\t\t];\r\n\t\tm = Length[mainExpr];\r\n\t\t\r\n\t\tdefs  = \r\n\t\tTable[ \"double \" <>\r\n\t\t\t       ToString@CForm@optimizedExpr[[1, 2, i, 1]]  <>\r\n\t\t\t       \" = \" <>\r\n\t\t\t       ToString@CForm@optimizedExpr[[1, 2, i, 2]] <>\r\n     \t\t\t       \";\",\r\n    \t\t       {i, 1, n}];\r\n\t\t\r\n\t\toutput = \r\n\r\n\t\t       MapIndexed[ \"out(\"<>StringJoin@Riffle[ToString/@(#2-1),\"\"]<>\") = \" <> ToString@CForm@#1 <>\";\" &,\r\n\t\t\t\t\t mainExpr, {ArrayDepth[mainExpr]}];\r\n\t\t\r\n\t\tStringReplace[Join[defs,output], \"Compile_$\" -> \"t\"]\r\n\t];\r\n\r\nEnd[]\r\n\r\n\r\nExtractTags[string_String] :=\r\n\tModule[ {regex, extractTag},\r\n\t\tregex = RegularExpression[\"\\\\n([^\\\\n]*)// (\\\\[|</?)([^\\\\]\\\\n]*)(\\\\]|>)[^\\\\n]*\\\\n\"];\r\n\t\t\r\n\t\textractTag[bounds_] := Module[{substring, indentation, tagType, tag},\r\n\t\t\t\t\t      substring = StringTake[string, bounds];\r\n\t\t\t\t\t      {{indentation, tagType, tag}} = \r\n\t\t\t\t\t      StringCases[substring, regex -> {\"$1\", \"$2\", \"$3\"}];\r\n\t\t\t\t\t      Association[\"indentation\" -> indentation,\r\n\t\t\t\t\t\t\t  \"tagType\" -> tagType, \r\n\t\t\t\t\t\t\t  \"tag\" -> tag , \"start\" -> bounds[[1]] + 1, \r\n\t\t\t\t\t\t\t  \"end\" -> bounds[[2]]]\r\n\t\t\t\t       ];\r\n\t\t\r\n\t\textractTag[#] & /@ StringPosition[string, regex]\r\n\t];\r\n\r\nTagExistQ[string_String, tag_String] := AnyTrue[ExtractTags[string], #[[\"tag\"]]==tag &];\r\n\r\nClearTagText[string_String, tag_String] :=\r\n\tModule[{tags, startTag, endTag, x},\r\n\t       tags = ExtractTags[string];\r\n\t       startTag = FirstCase[tags, x_ /; x[[\"tag\"]] == tag  && x[[\"tagType\"]] == \"<\"];\r\n\t       endTag = FirstCase[tags, x_ /; x[[\"tag\"]] == tag  && x[[\"tagType\"]] == \"</\"];\r\n\t       \r\n\t       StringTake[string, {1, startTag[[\"end\"]]}] <> \r\n\t\t\t StringTake[string, {endTag[[\"start\"]], StringLength[string]}]\r\n\t]\r\n\r\nAppendToTag[string_String,  tag_String, linesToAppend_List] := \r\n\tModule[{tags, startTag, indent, x},\r\n\t       tags = ExtractTags[string];\r\n\t       startTag = FirstCase[tags, x_ /; x[[\"tag\"]] == tag  && x[[\"tagType\"]] == \"<\"];\r\n\t       indent = startTag[[\"indentation\"]];\r\n\t       \r\n\t       StringTake[string, {1, startTag[[\"end\"]]}] <> \r\n\t\t\t StringRiffle[ linesToAppend, {indent, \"\\n\" <> indent, \"\\n\"}] <>\r\n\t\t\t StringTake[ string, {startTag[[\"end\"]] + 1, StringLength[string]}]\r\n\t];\r\n\r\nAppendToTag[string_String,  tag_String, stringToAppend_String] :=\r\n\tAppendToTag[string, tag, StringSplit[stringToAppend,\"\\n\"]];\r\n\r\n\r\nEndPackage[]",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>OptimizeExpressionToC`</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"OptimizeExpressionToC`\"",
       "mime": "text/plain"
      }
     ],
     "id": "d384c506-ae93-4c49-8cc6-aaa65724cceb",
     "metadata": {
      "cellLabel": "Out[143]= ",
      "isBoxData": false
     }
    },
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>Private`</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"Private`\"",
       "mime": "text/plain"
      }
     ],
     "id": "24382539-b2d1-4120-91df-b6a8410c1887",
     "metadata": {
      "cellLabel": "Out[149]= ",
      "isBoxData": false
     }
    },
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>Private`</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"Private`\"",
       "mime": "text/plain"
      }
     ],
     "id": "84f27cc7-600a-41ad-a604-dc4d6fdab454",
     "metadata": {
      "cellLabel": "Out[151]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549107803,
     "endTime": 1691549109160
    },
    "executionOrder": 143,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "M = 1;\r\na = spin;\r\ntheta = th;",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691549112915,
     "endTime": 1691549113159
    },
    "executionOrder": 158,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "### Metric Components",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "OptimizeExpressionToC[{\r\n   G[[1]][[1]], G[[1]][[2]], G[[1]][[3]], G[[1]][[4]], \r\n   G[[2]][[1]], G[[2]][[2]], G[[2]][[3]], G[[2]][[4]],\r\n   G[[3]][[1]], G[[3]][[2]], G[[3]][[3]], G[[3]][[4]],\r\n   G[[4]][[1]], G[[4]][[2]], G[[4]][[3]], G[[4]][[4]]\r\n   }];\r\nmeat = ToString[Column[StringReplace[%, {\r\n   \"Sqrt\" -> \"sqrt\", \"Power(E,\" -> \"exp(\", \"Power\" -> \"pow\", \"Sin\" -> \"sin\", \"Cos\" -> \"cos\", \"double\" -> \"long double\", \";,\" -> \";\\n    \",\r\n   \"out(0)\" -> \"g[0][0]\", \"out(1)\" -> \"g[0][1]\", \"out(2)\" -> \"g[0][2]\", \"out(3)\" -> \"g[0][3]\",\r\n   \"out(4)\" -> \"g[1][0]\", \"out(5)\" -> \"g[1][1]\", \"out(6)\" -> \"g[1][2]\", \"out(7)\" -> \"g[1][3]\",\r\n   \"out(8)\" -> \"g[2][0]\", \"out(9)\" -> \"g[2][1]\", \"out(10)\" -> \"g[2][2]\", \"out(11)\" -> \"g[2][3]\",\r\n   \"out(12)\" -> \"g[3][0]\", \"out(13)\" -> \"g[3][1]\", \"out(14)\" -> \"g[3][2]\", \"out(15)\" -> \"g[3][3]\"\r\n   }]]];\r\nheader = \"void metric(long double r, long double th, long double g[4][4])\\n{\\n\";\r\nfooter = \"\\n}\";\r\nmetric = header <> meat <> footer",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>void metric(long double r, long double th, long double g[4][4])</w><br/><w>{</w><br/><w>long double t1 = pow(r,2);</w><br/><w>long double t2 = pow(spin,2);</w><br/><w>long double t3 = cos(th);</w><br/><w>long double t4 = pow(t3,2);</w><br/><w>long double t5 = t2*t4;</w><br/><w>long double t6 = t1 + t5;</w><br/><w>long double t7 = 2*th;</w><br/><w>long double t8 = cos(t7);</w><br/><w>long double t9 = t2*t8;</w><br/><w>long double t11 = t1 + t9;</w><br/><w>long double t12 = pow(t11,-2);</w><br/><w>long double t15 = sin(th);</w><br/><w>long double t16 = pow(t15,2);</w><br/><w>long double t20 = 1/r;</w><br/><w>long double t21 = b1*spin*t20;</w><br/><w>long double t22 = 2 + r;</w><br/><w>long double t23 = r*t22;</w><br/><w>long double t24 = t2 + t23;</w><br/><w>long double t25 = -(spin*t12*t16*t24*t6);</w><br/><w>long double t13 = -2 + r;</w><br/><w>long double t14 = r*t13;</w><br/><w>g[0][0] = t12*(t14 + t2 - 4*t16*t2)*t6;</w><br/><w>g[0][1] = t21;</w><br/><w>g[0][2] = 0;</w><br/><w>g[0][3] = t25;</w><br/><w>g[1][0] = t21;</w><br/><w>g[1][1] = t6/(-2*r + t1 + t2);</w><br/><w>g[1][2] = 0;</w><br/><w>g[1][3] = 0;</w><br/><w>g[2][0] = 0;</w><br/><w>g[2][1] = 0;</w><br/><w>g[2][2] = t6;</w><br/><w>g[2][3] = 0;</w><br/><w>g[3][0] = t25;</w><br/><w>g[3][1] = 0;</w><br/><w>g[3][2] = 0;</w><br/><w>g[3][3] = t12*t16*(pow(t1 + t2,2) - t16*t2*(t14 + t2))*t6;</w><br/><w>}</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"void metric(long double r, long double th, long double g[4][4])\\n{\\nlong double t1 = pow(r,2);\\nlong double t2 = pow(spin,2);\\nlong double t3 = cos(th);\\nlong double t4 = pow(t3,2);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t7 = 2*th;\\nlong double t8 = cos(t7);\\nlong double t9 = t2*t8;\\nlong double t11 = t1 + t9;\\nlong double t12 = pow(t11,-2);\\nlong double t15 = sin(th);\\nlong double t16 = pow(t15,2);\\nlong double t20 = 1/r;\\nlong double t21 = b1*spin*t20;\\nlong double t22 = 2 + r;\\nlong double t23 = r*t22;\\nlong double t24 = t2 + t23;\\nlong double t25 = -(spin*t12*t16*t24*t6);\\nlong double t13 = -2 + r;\\nlong double t14 = r*t13;\\ng[0][0] = t12*(t14 + t2 - 4*t16*t2)*t6;\\ng[0][1] = t21;\\ng[0][2] = 0;\\ng[0][3] = t25;\\ng[1][0] = t21;\\ng[1][1] = t6/(-2*r + t1 + t2);\\ng[1][2] = 0;\\ng[1][3] = 0;\\ng[2][0] = 0;\\ng[2][1] = 0;\\ng[2][2] = t6;\\ng[2][3] = 0;\\ng[3][0] = t25;\\ng[3][1] = 0;\\ng[3][2] = 0;\\ng[3][3] = t12*t16*(pow(t1 + t2,2) - t16*t2*(t14 + t2))*t6;\\n}\"",
       "mime": "text/plain"
      }
     ],
     "id": "d32f7f2c-d541-4497-9402-187acd97fe83",
     "metadata": {
      "cellLabel": "Out[350]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691551316833,
     "endTime": 1691551317335
    },
    "executionOrder": 346,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "### Metric r derivatives",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "OptimizeExpressionToC[{\r\n   dGdr[[1]][[1]], dGdr[[1]][[2]], dGdr[[1]][[3]], dGdr[[1]][[4]], \r\n   dGdr[[2]][[1]], dGdr[[2]][[2]], dGdr[[2]][[3]], dGdr[[2]][[4]],\r\n   dGdr[[3]][[1]], dGdr[[3]][[2]], dGdr[[3]][[3]], dGdr[[3]][[4]],\r\n   dGdr[[4]][[1]], dGdr[[4]][[2]], dGdr[[4]][[3]], dGdr[[4]][[4]]\r\n   }];\r\nmeat = ToString[Column[StringReplace[%, {\r\n   \"Sqrt\" -> \"sqrt\", \"Power(E,\" -> \"exp(\", \"Power\" -> \"pow\", \"Sin\" -> \"sin\", \"Cos\" -> \"cos\", \"double\" -> \"long double\", \";,\" -> \";\\n    \",\r\n   \"out(0)\" -> \"dg[0][0]\", \"out(1)\" -> \"dg[0][1]\", \"out(2)\" -> \"dg[0][2]\", \"out(3)\" -> \"dg[0][3]\",\r\n   \"out(4)\" -> \"dg[1][0]\", \"out(5)\" -> \"dg[1][1]\", \"out(6)\" -> \"dg[1][2]\", \"out(7)\" -> \"dg[1][3]\",\r\n   \"out(8)\" -> \"dg[2][0]\", \"out(9)\" -> \"dg[2][1]\", \"out(10)\" -> \"dg[2][2]\", \"out(11)\" -> \"dg[2][3]\",\r\n   \"out(12)\" -> \"dg[3][0]\", \"out(13)\" -> \"dg[3][1]\", \"out(14)\" -> \"dg[3][2]\", \"out(15)\" -> \"dg[3][3]\"\r\n   }]]]\r\nheader = \"void metric_rderivatives(long double r, long double th, long double dg[4][4])\\n{\\n\";\r\nfooter = \"\\n}\";\r\nmetricdr = header <> meat <> footer;",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>long double t1 = pow(r,2);</w><br/><w>long double t2 = pow(spin,2);</w><br/><w>long double t14 = pow(spin,4);</w><br/><w>long double t12 = pow(r,3);</w><br/><w>long double t3 = 2*th;</w><br/><w>long double t4 = cos(t3);</w><br/><w>long double t5 = t2*t4;</w><br/><w>long double t6 = t1 + t5;</w><br/><w>long double t7 = pow(t6,-3);</w><br/><w>long double t8 = pow(r,4);</w><br/><w>long double t17 = 3*t1;</w><br/><w>long double t33 = 1 + r;</w><br/><w>long double t22 = 4*th;</w><br/><w>long double t23 = cos(t22);</w><br/><w>long double t27 = pow(r,-2);</w><br/><w>long double t28 = -(b1*spin*t27);</w><br/><w>long double t21 = -1 + r;</w><br/><w>long double t29 = -4*t8;</w><br/><w>long double t30 = -6*t1*t2;</w><br/><w>long double t31 = -6*t12*t2;</w><br/><w>long double t32 = -3*r*t14;</w><br/><w>long double t34 = t17 + t2;</w><br/><w>long double t35 = 2*t2*t33*t34*t4;</w><br/><w>long double t36 = t14*t23*t33;</w><br/><w>long double t37 = t14 + t29 + t30 + t31 + t32 + t35 + t36;</w><br/><w>long double t38 = sin(th);</w><br/><w>long double t39 = pow(t38,2);</w><br/><w>long double t40 = -0.5*(spin*t37*t39*t7);</w><br/><w>long double t71 = pow(spin,6);</w><br/><w>long double t72 = 6*th;</w><br/><w>long double t73 = cos(t72);</w><br/><w>dg[0][0] = (t7*(-t14 + 5*r*t14 + 6*t1*t2 + 2*t12*t2 + t14*t21*t23 - 2*t2*(t12 + t17 + t2 + 3*r*t2)*t4 + 4*t8))/2.;</w><br/><w>dg[0][1] = t28;</w><br/><w>dg[0][2] = 0;</w><br/><w>dg[0][3] = t40;</w><br/><w>dg[1][0] = t28;</w><br/><w>dg[1][1] = (-2*(r*(r - t2) + t2*t21*pow(cos(th),2)))/pow(-2*r + t1 + t2,2);</w><br/><w>dg[1][2] = 0;</w><br/><w>dg[1][3] = 0;</w><br/><w>dg[2][0] = 0;</w><br/><w>dg[2][1] = 0;</w><br/><w>dg[2][2] = 2*r;</w><br/><w>dg[2][3] = 0;</w><br/><w>dg[3][0] = t40;</w><br/><w>dg[3][1] = 0;</w><br/><w>dg[3][2] = 0;</w><br/><w>dg[3][3] = (t39*t7*(16*pow(r,7) - 18*t1*t14 - 6*t12*t14 + 2*r*t14*(-3*r + 7*t1 + 4*t2)*t23 - t71*t73 + r*t71*t73 - 8*t2*t8 + t2*t4*(48*pow(r,5) + t14 + 7*r*t14 + 24*t1*t2 + 40*t12*t2 + 8*t8)))/8.;</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"long double t1 = pow(r,2);\\nlong double t2 = pow(spin,2);\\nlong double t14 = pow(spin,4);\\nlong double t12 = pow(r,3);\\nlong double t3 = 2*th;\\nlong double t4 = cos(t3);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t7 = pow(t6,-3);\\nlong double t8 = pow(r,4);\\nlong double t17 = 3*t1;\\nlong double t33 = 1 + r;\\nlong double t22 = 4*th;\\nlong double t23 = cos(t22);\\nlong double t27 = pow(r,-2);\\nlong double t28 = -(b1*spin*t27);\\nlong double t21 = -1 + r;\\nlong double t29 = -4*t8;\\nlong double t30 = -6*t1*t2;\\nlong double t31 = -6*t12*t2;\\nlong double t32 = -3*r*t14;\\nlong double t34 = t17 + t2;\\nlong double t35 = 2*t2*t33*t34*t4;\\nlong double t36 = t14*t23*t33;\\nlong double t37 = t14 + t29 + t30 + t31 + t32 + t35 + t36;\\nlong double t38 = sin(th);\\nlong double t39 = pow(t38,2);\\nlong double t40 = -0.5*(spin*t37*t39*t7);\\nlong double t71 = pow(spin,6);\\nlong double t72 = 6*th;\\nlong double t73 = cos(t72);\\ndg[0][0] = (t7*(-t14 + 5*r*t14 + 6*t1*t2 + 2*t12*t2 + t14*t21*t23 - 2*t2*(t12 + t17 + t2 + 3*r*t2)*t4 + 4*t8))/2.;\\ndg[0][1] = t28;\\ndg[0][2] = 0;\\ndg[0][3] = t40;\\ndg[1][0] = t28;\\ndg[1][1] = (-2*(r*(r - t2) + t2*t21*pow(cos(th),2)))/pow(-2*r + t1 + t2,2);\\ndg[1][2] = 0;\\ndg[1][3] = 0;\\ndg[2][0] = 0;\\ndg[2][1] = 0;\\ndg[2][2] = 2*r;\\ndg[2][3] = 0;\\ndg[3][0] = t40;\\ndg[3][1] = 0;\\ndg[3][2] = 0;\\ndg[3][3] = (t39*t7*(16*pow(r,7) - 18*t1*t14 - 6*t12*t14 + 2*r*t14*(-3*r + 7*t1 + 4*t2)*t23 - t71*t73 + r*t71*t73 - 8*t2*t8 + t2*t4*(48*pow(r,5) + t14 + 7*r*t14 + 24*t1*t2 + 40*t12*t2 + 8*t8)))/8.;\"",
       "mime": "text/plain"
      }
     ],
     "id": "00c996b9-0818-4e84-aa63-6fb189f27bcc",
     "metadata": {
      "cellLabel": "Out[352]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691551318368,
     "endTime": 1691551318902
    },
    "executionOrder": 351,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "### Metric r2 derivatives",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "OptimizeExpressionToC[{\r\n   dGdr2[[1]][[1]], dGdr2[[1]][[2]], dGdr2[[1]][[3]], dGdr2[[1]][[4]], \r\n   dGdr2[[2]][[1]], dGdr2[[2]][[2]], dGdr2[[2]][[3]], dGdr2[[2]][[4]],\r\n   dGdr2[[3]][[1]], dGdr2[[3]][[2]], dGdr2[[3]][[3]], dGdr2[[3]][[4]],\r\n   dGdr2[[4]][[1]], dGdr2[[4]][[2]], dGdr2[[4]][[3]], dGdr2[[4]][[4]]\r\n   }];\r\nmeat = ToString[Column[StringReplace[%, {\r\n   \"Sqrt\" -> \"sqrt\", \"Power(E,\" -> \"exp(\", \"Power\" -> \"pow\", \"Sin\" -> \"sin\", \"Cos\" -> \"cos\", \"double\" -> \"long double\", \";,\" -> \";\\n    \",\r\n   \"out(0)\" -> \"dg2[0][0]\", \"out(1)\" -> \"dg2[0][1]\", \"out(2)\" -> \"dg2[0][2]\", \"out(3)\" -> \"dg2[0][3]\",\r\n   \"out(4)\" -> \"dg2[1][0]\", \"out(5)\" -> \"dg2[1][1]\", \"out(6)\" -> \"dg2[1][2]\", \"out(7)\" -> \"dg2[1][3]\",\r\n   \"out(8)\" -> \"dg2[2][0]\", \"out(9)\" -> \"dg2[2][1]\", \"out(10)\" -> \"dg2[2][2]\", \"out(11)\" -> \"dg2[2][3]\",\r\n   \"out(12)\" -> \"dg2[3][0]\", \"out(13)\" -> \"dg2[3][1]\", \"out(14)\" -> \"dg2[3][2]\", \"out(15)\" -> \"dg2[3][3]\"\r\n   }]]]\r\nheader = \"void metric_r2derivatives(long double r, long double th, long double dg2[4][4])\\n{\\n\";\r\nfooter = \"\\n}\";\r\nmetricdr2 = header <> meat <> footer;",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>long double t2 = pow(spin,2);</w><br/><w>long double t1 = pow(r,2);</w><br/><w>long double t11 = pow(r,3);</w><br/><w>long double t13 = pow(r,4);</w><br/><w>long double t15 = pow(spin,4);</w><br/><w>long double t3 = 2*th;</w><br/><w>long double t4 = cos(t3);</w><br/><w>long double t17 = pow(spin,6);</w><br/><w>long double t5 = t2*t4;</w><br/><w>long double t6 = t1 + t5;</w><br/><w>long double t7 = pow(t6,-4);</w><br/><w>long double t8 = pow(r,5);</w><br/><w>long double t9 = 16*t8;</w><br/><w>long double t12 = 48*t11*t2;</w><br/><w>long double t19 = 80*t11;</w><br/><w>long double t21 = 48*r*t2;</w><br/><w>long double t29 = 4*th;</w><br/><w>long double t30 = cos(t29);</w><br/><w>long double t32 = 6*th;</w><br/><w>long double t33 = cos(t32);</w><br/><w>long double t37 = pow(r,-3);</w><br/><w>long double t38 = 2*b1*spin*t37;</w><br/><w>long double t39 = 36*t13*t2;</w><br/><w>long double t40 = 48*t1*t15;</w><br/><w>long double t41 = 2*t17;</w><br/><w>long double t42 = 36*t13;</w><br/><w>long double t43 = 56*t1*t2;</w><br/><w>long double t44 = 5*t15;</w><br/><w>long double t45 = t19 + t21 + t42 + t43 + t44;</w><br/><w>long double t46 = -(t2*t4*t45);</w><br/><w>long double t47 = 4*t1;</w><br/><w>long double t48 = t2 + t47;</w><br/><w>long double t49 = 2*t15*t30*t48;</w><br/><w>long double t50 = t17*t33;</w><br/><w>long double t51 = t12 + t39 + t40 + t41 + t46 + t49 + t50 + t9;</w><br/><w>long double t52 = sin(th);</w><br/><w>long double t53 = pow(t52,2);</w><br/><w>long double t54 = -0.25*(spin*t51*t53*t7);</w><br/><w>long double t75 = pow(spin,8);</w><br/><w>dg2[0][0] = -0.25*(t7*(t12 + 56*t1*t15 + 6*t17 + 12*t13*t2 + 2*t15*(8*t1 + 3*t2)*t30 - t17*t33 - t2*(12*t13 + 11*t15 + t19 + 72*t1*t2 + t21)*t4 + t9));</w><br/><w>dg2[0][1] = t38;</w><br/><w>dg2[0][2] = 0;</w><br/><w>dg2[0][3] = t54;</w><br/><w>dg2[1][0] = t38;</w><br/><w>dg2[1][1] = (2*(2*t11 + t15 - 3*t1*t2 - t2*(-4 + 6*r - 3*t1 + t2)*pow(cos(th),2)))/pow(-2*r + t1 + t2,3);</w><br/><w>dg2[1][2] = 0;</w><br/><w>dg2[1][3] = 0;</w><br/><w>dg2[2][0] = 0;</w><br/><w>dg2[2][1] = 0;</w><br/><w>dg2[2][2] = 2;</w><br/><w>dg2[2][3] = 0;</w><br/><w>dg2[3][0] = t54;</w><br/><w>dg2[3][1] = 0;</w><br/><w>dg2[3][2] = 0;</w><br/><w>dg2[3][3] = (t53*t7*(32*pow(r,8) + 176*t11*t15 + 276*t13*t15 + 48*r*t17 + 120*t1*t17 + 4*t15*(20*t11 + 39*t13 + 2*t15 + 12*r*t2 + 10*t1*t2)*t30 + 32*t1*t17*t33 + 7*t75 + 8*t33*t75 + 8*t2*t4*(16*pow(r,6) - 12*r*t15 - 8*t1*t15 + t17 - 32*t11*t2 - 30*t13*t2 - 4*t8) + 32*t2*t8 + t75*cos(8*th)))/16.;</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"long double t2 = pow(spin,2);\\nlong double t1 = pow(r,2);\\nlong double t11 = pow(r,3);\\nlong double t13 = pow(r,4);\\nlong double t15 = pow(spin,4);\\nlong double t3 = 2*th;\\nlong double t4 = cos(t3);\\nlong double t17 = pow(spin,6);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t7 = pow(t6,-4);\\nlong double t8 = pow(r,5);\\nlong double t9 = 16*t8;\\nlong double t12 = 48*t11*t2;\\nlong double t19 = 80*t11;\\nlong double t21 = 48*r*t2;\\nlong double t29 = 4*th;\\nlong double t30 = cos(t29);\\nlong double t32 = 6*th;\\nlong double t33 = cos(t32);\\nlong double t37 = pow(r,-3);\\nlong double t38 = 2*b1*spin*t37;\\nlong double t39 = 36*t13*t2;\\nlong double t40 = 48*t1*t15;\\nlong double t41 = 2*t17;\\nlong double t42 = 36*t13;\\nlong double t43 = 56*t1*t2;\\nlong double t44 = 5*t15;\\nlong double t45 = t19 + t21 + t42 + t43 + t44;\\nlong double t46 = -(t2*t4*t45);\\nlong double t47 = 4*t1;\\nlong double t48 = t2 + t47;\\nlong double t49 = 2*t15*t30*t48;\\nlong double t50 = t17*t33;\\nlong double t51 = t12 + t39 + t40 + t41 + t46 + t49 + t50 + t9;\\nlong double t52 = sin(th);\\nlong double t53 = pow(t52,2);\\nlong double t54 = -0.25*(spin*t51*t53*t7);\\nlong double t75 = pow(spin,8);\\ndg2[0][0] = -0.25*(t7*(t12 + 56*t1*t15 + 6*t17 + 12*t13*t2 + 2*t15*(8*t1 + 3*t2)*t30 - t17*t33 - t2*(12*t13 + 11*t15 + t19 + 72*t1*t2 + t21)*t4 + t9));\\ndg2[0][1] = t38;\\ndg2[0][2] = 0;\\ndg2[0][3] = t54;\\ndg2[1][0] = t38;\\ndg2[1][1] = (2*(2*t11 + t15 - 3*t1*t2 - t2*(-4 + 6*r - 3*t1 + t2)*pow(cos(th),2)))/pow(-2*r + t1 + t2,3);\\ndg2[1][2] = 0;\\ndg2[1][3] = 0;\\ndg2[2][0] = 0;\\ndg2[2][1] = 0;\\ndg2[2][2] = 2;\\ndg2[2][3] = 0;\\ndg2[3][0] = t54;\\ndg2[3][1] = 0;\\ndg2[3][2] = 0;\\ndg2[3][3] = (t53*t7*(32*pow(r,8) + 176*t11*t15 + 276*t13*t15 + 48*r*t17 + 120*t1*t17 + 4*t15*(20*t11 + 39*t13 + 2*t15 + 12*r*t2 + 10*t1*t2)*t30 + 32*t1*t17*t33 + 7*t75 + 8*t33*t75 + 8*t2*t4*(16*pow(r,6) - 12*r*t15 - 8*t1*t15 + t17 - 32*t11*t2 - 30*t13*t2 - 4*t8) + 32*t2*t8 + t75*cos(8*th)))/16.;\"",
       "mime": "text/plain"
      }
     ],
     "id": "a7d46c82-1c21-4cbe-9ec9-6efeba619e85",
     "metadata": {
      "cellLabel": "Out[357]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691551319200,
     "endTime": 1691551319720
    },
    "executionOrder": 356,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "### Covariant Metric Components",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "OptimizeExpressionToC[{\r\n   Ginv[[1]][[1]], Ginv[[1]][[2]], Ginv[[1]][[3]], Ginv[[1]][[4]], \r\n   Ginv[[2]][[1]], Ginv[[2]][[2]], Ginv[[2]][[3]], Ginv[[2]][[4]],\r\n   Ginv[[3]][[1]], Ginv[[3]][[2]], Ginv[[3]][[3]], Ginv[[3]][[4]],\r\n   Ginv[[4]][[1]], Ginv[[4]][[2]], Ginv[[4]][[3]], Ginv[[4]][[4]]\r\n   }];\r\nmeet = ToString[Column[StringReplace[%, {\r\n   \"Sqrt\" -> \"sqrt\", \"Power(E,\" -> \"exp(\", \"Power\" -> \"pow\", \"Sin\" -> \"sin\", \"Cos\" -> \"cos\", \"double\" -> \"long double\", \";,\" -> \";\\n   \",\r\n   \"out(0)\" -> \"gu[0][0]\", \"out(1)\" -> \"gu[0][1]\", \"out(2)\" -> \"gu[0][2]\", \"out(3)\" -> \"gu[0][3]\",\r\n   \"out(4)\" -> \"gu[1][0]\", \"out(5)\" -> \"gu[1][1]\", \"out(6)\" -> \"gu[1][2]\", \"out(7)\" -> \"gu[1][3]\",\r\n   \"out(8)\" -> \"gu[2][0]\", \"out(9)\" -> \"gu[2][1]\", \"out(10)\" -> \"gu[2][2]\", \"out(11)\" -> \"gu[2][3]\",\r\n   \"out(12)\" -> \"gu[3][0]\", \"out(13)\" -> \"gu[3][1]\", \"out(14)\" -> \"gu[3][2]\", \"out(15)\" -> \"gu[3][3]\"\r\n   }]]]\r\nheader = \"void uppermetric(long double r, long double th, long double gu[4][4])\\n{\\n\";\r\nfooter = \"\\n}\";\r\nmetricupper = header <> meet <> footer;",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>long double t1 = pow(r,2);</w><br/><w>long double t2 = pow(spin,2);</w><br/><w>long double t14 = sin(th);</w><br/><w>long double t15 = pow(t14,2);</w><br/><w>long double t3 = cos(th);</w><br/><w>long double t4 = pow(t3,2);</w><br/><w>long double t5 = t2*t4;</w><br/><w>long double t6 = t1 + t5;</w><br/><w>long double t16 = t1 + t2;</w><br/><w>long double t17 = pow(t16,2);</w><br/><w>long double t18 = -2 + r;</w><br/><w>long double t19 = r*t18;</w><br/><w>long double t20 = t19 + t2;</w><br/><w>long double t21 = -(t15*t2*t20);</w><br/><w>long double t22 = t17 + t21;</w><br/><w>long double t8 = 2*th;</w><br/><w>long double t9 = cos(t8);</w><br/><w>long double t11 = t2*t9;</w><br/><w>long double t12 = t1 + t11;</w><br/><w>long double t13 = pow(t12,2);</w><br/><w>long double t31 = -2*r;</w><br/><w>long double t32 = t1 + t2 + t31;</w><br/><w>long double t23 = 2 + r;</w><br/><w>long double t24 = r*t23;</w><br/><w>long double t25 = t2 + t24;</w><br/><w>long double t26 = pow(t25,2);</w><br/><w>long double t27 = pow(t6,3);</w><br/><w>long double t28 = pow(t14,4);</w><br/><w>long double t29 = t1*t2*t26*t27*t28;</w><br/><w>long double t30 = pow(b1,2);</w><br/><w>long double t33 = -(t13*t2*t30*t32);</w><br/><w>long double t34 = pow(r,3);</w><br/><w>long double t35 = r*t2*t4;</w><br/><w>long double t36 = t34 + t35;</w><br/><w>long double t37 = pow(t36,2);</w><br/><w>long double t38 = -4*t15*t2;</w><br/><w>long double t39 = t19 + t2 + t38;</w><br/><w>long double t40 = t37*t39;</w><br/><w>long double t41 = t33 + t40;</w><br/><w>long double t42 = -(t15*t22*t41*t6);</w><br/><w>long double t43 = t29 + t42;</w><br/><w>long double t44 = 1/t43;</w><br/><w>long double t7 = pow(t6,2);</w><br/><w>long double t46 = b1*r*spin;</w><br/><w>long double t47 = 1/r;</w><br/><w>long double t48 = pow(spin,3);</w><br/><w>long double t49 = b1*t4*t47*t48;</w><br/><w>long double t50 = t46 + t49;</w><br/><w>long double t51 = t1*t13*t15*t22*t32*t44*t50;</w><br/><w>long double t52 = -(spin*t1*t13*t15*t25*t44*t7);</w><br/><w>gu[0][0] = -(t1*t13*t15*t22*t44*t7);</w><br/><w>gu[0][1] = t51;</w><br/><w>gu[0][2] = 0;</w><br/><w>gu[0][3] = t52;</w><br/><w>gu[1][0] = t51;</w><br/><w>gu[1][1] = -(t1*t15*t32*(-(t15*t2*t26) + t22*t39)*t44*t7);</w><br/><w>gu[1][2] = 0;</w><br/><w>gu[1][3] = b1*r*t13*t15*t2*t25*t32*t44*t6;</w><br/><w>gu[2][0] = 0;</w><br/><w>gu[2][1] = 0;</w><br/><w>gu[2][2] = 1/t6;</w><br/><w>gu[2][3] = 0;</w><br/><w>gu[3][0] = t52;</w><br/><w>gu[3][1] = spin*t1*t13*t15*t25*t32*t44*t50;</w><br/><w>gu[3][2] = 0;</w><br/><w>gu[3][3] = -(t1*pow(t12,4)*t32*t44*(-((t2*t30)/pow(r,2)) + (t39*t7)/(pow(t12,2)*t32)));</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"long double t1 = pow(r,2);\\nlong double t2 = pow(spin,2);\\nlong double t14 = sin(th);\\nlong double t15 = pow(t14,2);\\nlong double t3 = cos(th);\\nlong double t4 = pow(t3,2);\\nlong double t5 = t2*t4;\\nlong double t6 = t1 + t5;\\nlong double t16 = t1 + t2;\\nlong double t17 = pow(t16,2);\\nlong double t18 = -2 + r;\\nlong double t19 = r*t18;\\nlong double t20 = t19 + t2;\\nlong double t21 = -(t15*t2*t20);\\nlong double t22 = t17 + t21;\\nlong double t8 = 2*th;\\nlong double t9 = cos(t8);\\nlong double t11 = t2*t9;\\nlong double t12 = t1 + t11;\\nlong double t13 = pow(t12,2);\\nlong double t31 = -2*r;\\nlong double t32 = t1 + t2 + t31;\\nlong double t23 = 2 + r;\\nlong double t24 = r*t23;\\nlong double t25 = t2 + t24;\\nlong double t26 = pow(t25,2);\\nlong double t27 = pow(t6,3);\\nlong double t28 = pow(t14,4);\\nlong double t29 = t1*t2*t26*t27*t28;\\nlong double t30 = pow(b1,2);\\nlong double t33 = -(t13*t2*t30*t32);\\nlong double t34 = pow(r,3);\\nlong double t35 = r*t2*t4;\\nlong double t36 = t34 + t35;\\nlong double t37 = pow(t36,2);\\nlong double t38 = -4*t15*t2;\\nlong double t39 = t19 + t2 + t38;\\nlong double t40 = t37*t39;\\nlong double t41 = t33 + t40;\\nlong double t42 = -(t15*t22*t41*t6);\\nlong double t43 = t29 + t42;\\nlong double t44 = 1/t43;\\nlong double t7 = pow(t6,2);\\nlong double t46 = b1*r*spin;\\nlong double t47 = 1/r;\\nlong double t48 = pow(spin,3);\\nlong double t49 = b1*t4*t47*t48;\\nlong double t50 = t46 + t49;\\nlong double t51 = t1*t13*t15*t22*t32*t44*t50;\\nlong double t52 = -(spin*t1*t13*t15*t25*t44*t7);\\ngu[0][0] = -(t1*t13*t15*t22*t44*t7);\\ngu[0][1] = t51;\\ngu[0][2] = 0;\\ngu[0][3] = t52;\\ngu[1][0] = t51;\\ngu[1][1] = -(t1*t15*t32*(-(t15*t2*t26) + t22*t39)*t44*t7);\\ngu[1][2] = 0;\\ngu[1][3] = b1*r*t13*t15*t2*t25*t32*t44*t6;\\ngu[2][0] = 0;\\ngu[2][1] = 0;\\ngu[2][2] = 1/t6;\\ngu[2][3] = 0;\\ngu[3][0] = t52;\\ngu[3][1] = spin*t1*t13*t15*t25*t32*t44*t50;\\ngu[3][2] = 0;\\ngu[3][3] = -(t1*pow(t12,4)*t32*t44*(-((t2*t30)/pow(r,2)) + (t39*t7)/(pow(t12,2)*t32)));\"",
       "mime": "text/plain"
      }
     ],
     "id": "f8e5fb3c-08dd-4cc2-a9a3-4f553589ce37",
     "metadata": {
      "cellLabel": "Out[362]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691551320132,
     "endTime": 1691551320606
    },
    "executionOrder": 361,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "output = metric <> \"\\n\\n\" <> metricupper <> \"\\n\\n\" <> metricdr <> \"\\n\\n\" <> metricdr2;\r\n\r\n(* write to metric.cpp file *)\r\nSetDirectory[\"C:\\\\Users\\\\Administrator\\\\Documents\\\\script\\\\raytransfer\"];\r\nExport[\"metric.cpp\", output, \"Text\"]",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>metric.cpp</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"metric.cpp\"",
       "mime": "text/plain"
      }
     ],
     "id": "2e0cef58-f291-4be2-a7b1-dc6c6e7f0f9a",
     "metadata": {
      "cellLabel": "Out[368]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691551321597,
     "endTime": 1691551321932
    },
    "executionOrder": 366,
    "success": true
   }
  },
  {
   "kind": 1,
   "value": "### Christoffel Symbols",
   "languageId": "markdown",
   "outputs": [],
   "metadata": {},
   "executionSummary": {}
  },
  {
   "kind": 2,
   "value": "OptimizeExpressionToC[{\r\n   Christ[[1]][[1]][[1]], Christ[[1]][[1]][[2]], Christ[[1]][[1]][[3]], Christ[[1]][[1]][[4]],\r\n   Christ[[1]][[2]][[2]], Christ[[1]][[2]][[3]], Christ[[1]][[2]][[4]],\r\n   Christ[[1]][[3]][[3]], Christ[[1]][[3]][[4]],\r\n   Christ[[1]][[4]][[4]],\r\n   Christ[[2]][[1]][[1]], Christ[[2]][[1]][[2]], Christ[[2]][[1]][[3]], Christ[[2]][[1]][[4]],\r\n   Christ[[2]][[2]][[2]], Christ[[2]][[2]][[3]], Christ[[2]][[2]][[4]],\r\n   Christ[[2]][[3]][[3]], Christ[[2]][[3]][[4]],\r\n   Christ[[2]][[4]][[4]],\r\n   Christ[[3]][[1]][[1]], Christ[[3]][[1]][[2]], Christ[[3]][[1]][[3]], Christ[[3]][[1]][[4]],\r\n   Christ[[3]][[2]][[2]], Christ[[3]][[2]][[3]], Christ[[3]][[2]][[4]],\r\n   Christ[[3]][[3]][[3]], Christ[[3]][[3]][[4]],\r\n   Christ[[3]][[4]][[4]],\r\n   Christ[[4]][[1]][[1]], Christ[[4]][[1]][[2]], Christ[[4]][[1]][[3]], Christ[[4]][[1]][[4]],\r\n   Christ[[4]][[2]][[2]], Christ[[4]][[2]][[3]], Christ[[4]][[2]][[4]],\r\n   Christ[[4]][[3]][[3]], Christ[[4]][[3]][[4]],\r\n   Christ[[4]][[4]][[4]]\r\n   }];\r\nmeat = ToString[Column[StringReplace[%, {\r\n   \"Sqrt\" -> \"sqrt\", \"Power(E,\" -> \"exp(\", \"Power\" -> \"pow\", \"Sin\" -> \"sin\", \"Cos\" -> \"cos\", \"double\" -> \"long double\", \";,\" -> \";\\n    \",\r\n   \"out(0)\" -> \"christ[0][0][0]\", \"out(1)\" -> \"christ[0][0][1]\", \"out(2)\" -> \"christ[0][0][2]\", \"out(3)\" -> \"christ[0][0][3]\",\r\n   \"out(4)\" -> \"christ[0][1][1]\", \"out(5)\" -> \"christ[0][1][2]\", \"out(6)\" -> \"christ[0][1][3]\", \r\n   \"out(7)\" -> \"christ[0][2][2]\", \"out(8)\" -> \"christ[0][2][3]\", \r\n   \"out(9)\" -> \"christ[0][3][3]\",\r\n   \"out(10)\" -> \"christ[1][0][0]\", \"out(11)\" -> \"christ[1][0][1]\", \"out(12)\" -> \"christ[1][0][2]\", \"out(13)\" -> \"christ[1][0][3]\",\r\n   \"out(14)\" -> \"christ[1][1][1]\", \"out(15)\" -> \"christ[1][1][2]\", \"out(16)\" -> \"christ[1][1][3]\",\r\n   \"out(17)\" -> \"christ[1][2][2]\", \"out(18)\" -> \"christ[1][2][3]\",\r\n   \"out(19)\" -> \"christ[1][3][3]\",\r\n   \"out(20)\" -> \"christ[2][0][0]\", \"out(21)\" -> \"christ[2][0][1]\", \"out(22)\" -> \"christ[2][0][2]\", \"out(23)\" -> \"christ[2][0][3]\",\r\n   \"out(24)\" -> \"christ[2][1][1]\", \"out(25)\" -> \"christ[2][1][2]\", \"out(26)\" -> \"christ[2][1][3]\",\r\n   \"out(27)\" -> \"christ[2][2][2]\", \"out(28)\" -> \"christ[2][2][3]\",\r\n   \"out(29)\" -> \"christ[2][3][3]\",\r\n   \"out(30)\" -> \"christ[3][0][0]\", \"out(31)\" -> \"christ[3][0][1]\", \"out(32)\" -> \"christ[3][0][2]\", \"out(33)\" -> \"christ[3][0][3]\",\r\n   \"out(34)\" -> \"christ[3][1][1]\", \"out(35)\" -> \"christ[3][1][2]\", \"out(36)\" -> \"christ[3][1][3]\",\r\n   \"out(37)\" -> \"christ[3][2][2]\", \"out(38)\" -> \"christ[3][2][3]\",\r\n   \"out(39)\" -> \"christ[3][3][3]\"}]]]\r\nheader = \"void christoffel(long double r, long double th, long double christ[4][4][4])\\n{\\n\";\r\nfooter = \"\\n}\";\r\nchristoffel = header <> meat <> footer;",
   "languageId": "wolfram",
   "outputs": [
    {
     "items": [
      {
       "data": "<div class=\"wexpr\"><w>long double t1 = pow(r,2);</w><br/><w>long double t3 = pow(spin,2);</w><br/><w>long double t23 = pow(spin,4);</w><br/><w>long double t21 = pow(r,3);</w><br/><w>long double t13 = 2*th;</w><br/><w>long double t14 = cos(t13);</w><br/><w>long double t35 = sin(th);</w><br/><w>long double t36 = pow(t35,2);</w><br/><w>long double t8 = cos(th);</w><br/><w>long double t9 = pow(t8,2);</w><br/><w>long double t48 = t3*t9;</w><br/><w>long double t49 = t1 + t48;</w><br/><w>long double t37 = t1 + t3;</w><br/><w>long double t38 = pow(t37,2);</w><br/><w>long double t39 = -2 + r;</w><br/><w>long double t40 = r*t39;</w><br/><w>long double t41 = t3 + t40;</w><br/><w>long double t42 = -(t3*t36*t41);</w><br/><w>long double t43 = t38 + t42;</w><br/><w>long double t2 = -2*r;</w><br/><w>long double t4 = t1 + t2 + t3;</w><br/><w>long double t15 = t14*t3;</w><br/><w>long double t16 = t1 + t15;</w><br/><w>long double t17 = 1/t16;</w><br/><w>long double t44 = 2 + r;</w><br/><w>long double t45 = r*t44;</w><br/><w>long double t46 = t3 + t45;</w><br/><w>long double t70 = 3*r;</w><br/><w>long double t18 = pow(r,4);</w><br/><w>long double t19 = 4*t18;</w><br/><w>long double t20 = 6*t1*t3;</w><br/><w>long double t22 = 2*t21*t3;</w><br/><w>long double t24 = -t23;</w><br/><w>long double t25 = 5*r*t23;</w><br/><w>long double t26 = 3*t1;</w><br/><w>long double t27 = 3*r*t3;</w><br/><w>long double t28 = t21 + t26 + t27 + t3;</w><br/><w>long double t29 = -2*t14*t28*t3;</w><br/><w>long double t30 = -1 + r;</w><br/><w>long double t31 = 4*th;</w><br/><w>long double t32 = cos(t31);</w><br/><w>long double t33 = t23*t30*t32;</w><br/><w>long double t34 = t19 + t20 + t22 + t24 + t25 + t29 + t33;</w><br/><w>long double t47 = pow(t46,2);</w><br/><w>long double t50 = pow(t49,3);</w><br/><w>long double t51 = pow(t35,4);</w><br/><w>long double t52 = t1*t3*t47*t50*t51;</w><br/><w>long double t53 = pow(b1,2);</w><br/><w>long double t54 = pow(t16,2);</w><br/><w>long double t55 = -(t3*t4*t53*t54);</w><br/><w>long double t56 = r*t3*t9;</w><br/><w>long double t57 = t21 + t56;</w><br/><w>long double t58 = pow(t57,2);</w><br/><w>long double t59 = -4*t3*t36;</w><br/><w>long double t60 = t3 + t40 + t59;</w><br/><w>long double t61 = t58*t60;</w><br/><w>long double t62 = t55 + t61;</w><br/><w>long double t63 = -(t36*t43*t49*t62);</w><br/><w>long double t64 = t52 + t63;</w><br/><w>long double t65 = 1/t64;</w><br/><w>long double t67 = pow(t49,2);</w><br/><w>long double t97 = t14*t3*t4;</w><br/><w>long double t5 = b1*r*spin;</w><br/><w>long double t6 = 1/r;</w><br/><w>long double t7 = pow(spin,3);</w><br/><w>long double t11 = b1*t6*t7*t9;</w><br/><w>long double t12 = t11 + t5;</w><br/><w>long double t77 = 1 + r;</w><br/><w>long double t74 = 2*t3;</w><br/><w>long double t125 = pow(spin,6);</w><br/><w>long double t138 = pow(r,5);</w><br/><w>long double t71 = 2*t1;</w><br/><w>long double t165 = pow(r,9);</w><br/><w>long double t168 = pow(r,10);</w><br/><w>long double t133 = pow(r,6);</w><br/><w>long double t135 = pow(r,7);</w><br/><w>long double t163 = pow(r,8);</w><br/><w>long double t183 = pow(spin,8);</w><br/><w>long double t189 = pow(spin,10);</w><br/><w>long double t258 = 6*th;</w><br/><w>long double t259 = cos(t258);</w><br/><w>long double t192 = pow(spin,12);</w><br/><w>long double t271 = 8*th;</w><br/><w>long double t272 = cos(t271);</w><br/><w>long double t131 = pow(t35,3);</w><br/><w>long double t117 = -3*r;</w><br/><w>long double t68 = r + t3;</w><br/><w>long double t69 = 2*t21*t68;</w><br/><w>long double t72 = t3 + t70 + t71;</w><br/><w>long double t73 = -2*r*t14*t3*t72;</w><br/><w>long double t75 = t1 + t70 + t74;</w><br/><w>long double t76 = -(r*t75);</w><br/><w>long double t78 = t14*t3*t77;</w><br/><w>long double t79 = t76 + t78;</w><br/><w>long double t80 = -2*t3*t79*t9;</w><br/><w>long double t81 = t69 + t73 + t80;</w><br/><w>long double t107 = -4*t18;</w><br/><w>long double t108 = -6*t1*t3;</w><br/><w>long double t88 = 2*r;</w><br/><w>long double t89 = t1 + t3 + t88;</w><br/><w>long double t90 = pow(t89,2);</w><br/><w>long double t91 = 2*t38*t90;</w><br/><w>long double t92 = -6*t21;</w><br/><w>long double t93 = -t18;</w><br/><w>long double t94 = -4*r*t3;</w><br/><w>long double t95 = -3*t1*t3;</w><br/><w>long double t96 = -2*t23;</w><br/><w>long double t98 = t92 + t93 + t94 + t95 + t96 + t97;</w><br/><w>long double t99 = 2*t18;</w><br/><w>long double t100 = 2*r*t3;</w><br/><w>long double t101 = 3*t1*t3;</w><br/><w>long double t102 = t100 + t101 + t23 + t97 + t99;</w><br/><w>long double t103 = -(t102*t98);</w><br/><w>long double t104 = t103 + t91;</w><br/><w>long double t105 = sin(t13);</w><br/><w>long double t298 = pow(t16,-3);</w><br/><w>long double t109 = -6*t21*t3;</w><br/><w>long double t110 = -3*r*t23;</w><br/><w>long double t111 = t26 + t3;</w><br/><w>long double t112 = 2*t111*t14*t3*t77;</w><br/><w>long double t113 = t23*t32*t77;</w><br/><w>long double t114 = t107 + t108 + t109 + t110 + t112 + t113 + t23;</w><br/><w>long double t299 = -(t3*t36*t47);</w><br/><w>long double t300 = t43*t60;</w><br/><w>long double t301 = t299 + t300;</w><br/><w>long double t83 = -(t3*t36*t4);</w><br/><w>long double t84 = t38 + t83;</w><br/><w>long double t148 = -t3;</w><br/><w>long double t134 = 12*t133;</w><br/><w>long double t136 = 4*t135;</w><br/><w>long double t137 = 10*t18*t3;</w><br/><w>long double t139 = 10*t138*t3;</w><br/><w>long double t140 = 3*t1*t23;</w><br/><w>long double t141 = 8*t21*t23;</w><br/><w>long double t142 = -t125;</w><br/><w>long double t143 = 2*r*t125;</w><br/><w>long double t144 = 5*t18;</w><br/><w>long double t145 = r*t23;</w><br/><w>long double t146 = t138 + t144 + t145 + t22 + t24;</w><br/><w>long double t147 = 2*t14*t146*t3;</w><br/><w>long double t149 = t1 + t148;</w><br/><w>long double t150 = t149*t23*t32;</w><br/><w>long double t151 = t134 + t136 + t137 + t139 + t140 + t141 + t142 + t143 + t147 + t150;</w><br/><w>long double t159 = pow(r,11);</w><br/><w>long double t161 = pow(r,12);</w><br/><w>long double t194 = 32*t165;</w><br/><w>long double t195 = -64*t168;</w><br/><w>long double t196 = -6*t53;</w><br/><w>long double t197 = 1 + t196;</w><br/><w>long double t198 = 16*t135*t197*t3;</w><br/><w>long double t199 = -12*t53;</w><br/><w>long double t200 = 7 + t199;</w><br/><w>long double t201 = 8*t138*t200*t23;</w><br/><w>long double t202 = 3*t53;</w><br/><w>long double t203 = -2 + t202;</w><br/><w>long double t204 = -8*t125*t203*t21;</w><br/><w>long double t205 = -24*r*t183*t53;</w><br/><w>long double t206 = 6*t189*t53;</w><br/><w>long double t207 = -3 + t53;</w><br/><w>long double t208 = 5*t207*t3;</w><br/><w>long double t209 = -8 + t208;</w><br/><w>long double t210 = 8*t163*t209;</w><br/><w>long double t211 = -5*t183;</w><br/><w>long double t212 = 7*t3;</w><br/><w>long double t213 = 6 + t212;</w><br/><w>long double t214 = 4*t125*t213*t53;</w><br/><w>long double t215 = t211 + t214;</w><br/><w>long double t216 = t1*t215;</w><br/><w>long double t217 = -15*t3;</w><br/><w>long double t218 = 39*t3;</w><br/><w>long double t219 = -32 + t218;</w><br/><w>long double t220 = t219*t53;</w><br/><w>long double t221 = 2 + t217 + t220;</w><br/><w>long double t222 = 2*t18*t221*t23;</w><br/><w>long double t223 = -81*t23;</w><br/><w>long double t224 = 3*t23;</w><br/><w>long double t225 = t224 + t3;</w><br/><w>long double t226 = 32*t225*t53;</w><br/><w>long double t227 = t223 + t226;</w><br/><w>long double t228 = t133*t227;</w><br/><w>long double t229 = t194 + t195 + t198 + t201 + t204 + t205 + t206 + t210 + t216 + t222 + t228;</w><br/><w>long double t231 = -10*t135;</w><br/><w>long double t232 = 17*t163;</w><br/><w>long double t233 = 6*t53;</w><br/><w>long double t234 = 1 + t233;</w><br/><w>long double t235 = 4*t138*t234*t3;</w><br/><w>long double t236 = 24*t21*t23*t53;</w><br/><w>long double t237 = -2*t183*t53;</w><br/><w>long double t238 = -8*t53;</w><br/><w>long double t239 = 30 + t238;</w><br/><w>long double t240 = t239*t3;</w><br/><w>long double t241 = 16 + t240;</w><br/><w>long double t242 = t133*t241;</w><br/><w>long double t243 = -8*t3;</w><br/><w>long double t244 = 9*t3;</w><br/><w>long double t245 = 8 + t244;</w><br/><w>long double t246 = t245*t53;</w><br/><w>long double t247 = -2 + t243 + t246;</w><br/><w>long double t248 = -2*t18*t247*t3;</w><br/><w>long double t249 = 3*t125;</w><br/><w>long double t250 = 8*t23;</w><br/><w>long double t251 = -12*t125;</w><br/><w>long double t252 = t250 + t251;</w><br/><w>long double t253 = t252*t53;</w><br/><w>long double t254 = t249 + t253;</w><br/><w>long double t255 = t1*t254;</w><br/><w>long double t256 = t231 + t232 + t235 + t236 + t237 + t242 + t248 + t255;</w><br/><w>long double t279 = 16*t135;</w><br/><w>long double t280 = -8*t18*t3;</w><br/><w>long double t281 = -18*t1*t23;</w><br/><w>long double t282 = -6*t21*t23;</w><br/><w>long double t283 = 8*t18;</w><br/><w>long double t284 = 48*t138;</w><br/><w>long double t285 = 24*t1*t3;</w><br/><w>long double t286 = 40*t21*t3;</w><br/><w>long double t287 = 7*r*t23;</w><br/><w>long double t288 = t23 + t283 + t284 + t285 + t286 + t287;</w><br/><w>long double t289 = t14*t288*t3;</w><br/><w>long double t290 = 7*t1;</w><br/><w>long double t291 = 4*t3;</w><br/><w>long double t292 = t117 + t290 + t291;</w><br/><w>long double t293 = 2*r*t23*t292*t32;</w><br/><w>long double t294 = -(t125*t259);</w><br/><w>long double t295 = r*t125*t259;</w><br/><w>long double t296 = t279 + t280 + t281 + t282 + t289 + t293 + t294 + t295;</w><br/><w>long double t375 = 1/t49;</w><br/><w>long double t116 = 1/t4;</w><br/><w>long double t304 = -2*t21*t3;</w><br/><w>long double t305 = -5*r*t23;</w><br/><w>long double t306 = 2*t14*t28*t3;</w><br/><w>long double t307 = -(t23*t30*t32);</w><br/><w>long double t308 = t107 + t108 + t23 + t304 + t305 + t306 + t307;</w><br/><w>long double t399 = -32*t125*t53;</w><br/><w>long double t118 = t1 + t117 + t74;</w><br/><w>long double t157 = t15 + t3 + t71;</w><br/><w>long double t158 = pow(t157,2);</w><br/><w>christ[0][0][0] = -0.25*(t1*t12*t17*t34*t36*t4*t43*t65);</w><br/><w>christ[0][0][1] = -0.5*(t1*t17*t36*t65*t67*(t3*t36*t46*t81 + (t34*t84)/2.));</w><br/><w>christ[0][0][2] = (t1*t104*t105*t17*t3*t36*t65*t67)/4.;</w><br/><w>christ[0][0][3] = (spin*t1*t114*t12*t17*t4*t43*t51*t65)/4.;</w><br/><w>christ[0][1][1] = b1*spin*t116*t36*t43*t54*t65*(t118*t18 + (t125 - r*t23)*pow(t8,4) + t1*t3*(-4*r + t1 + 3*t3)*t9);</w><br/><w>christ[0][1][2] = -(t1*t12*t131*t3*t43*t54*t65*t8);</w><br/><w>christ[0][1][3] = -0.25*(spin*t151*t51*t58*t65);</w><br/><w>christ[0][2][2] = -(t12*t21*t36*t4*t43*t54*t65);</w><br/><w>christ[0][2][3] = (-8*t1*t131*t158*(t18 + t23 + 2*t1*(-2 + t3))*t7*t8)/(24*t125*t133 - 144*t125*t138 - 64*t159 + 32*t161 - 16*t125*t18 + 15*t18*t183 + 3*t1*t189 - 30*t183*t21 - 64*t133*t23 - 312*t135*t23 + 12*t163*t23 + 14*t125*t133*t259 - 16*t125*t138*t259 + 8*t125*t18*t259 + 20*t18*t183*t259 + 6*t1*t189*t259 + t18*t183*t272 + t1*t189*t272 - 2*t183*t21*t272 - 128*t163*t3 - 192*t165*t3 + 32*t168*t3 - 2*t14*t229*t3 + 4*t23*t256*t32 - 96*t125*t133*t53 + 96*t125*t138*t53 - 64*t125*t18*t53 + 32*t1*t183*t53 - 88*t18*t183*t53 - 48*t1*t189*t53 - 8*t192*t53 + 96*t183*t21*t53 + 64*t133*t23*t53 + 64*t135*t23*t53 - 80*t163*t23*t53 - 16*t1*t183*t259*t53 - 4*t18*t183*t259*t53 + 16*r*t189*t259*t53 - 8*t1*t189*t259*t53 - 4*t192*t259*t53 + 16*t183*t21*t259*t53 + 64*t165*t3*t53 - 32*t168*t3*t53);</w><br/><w>christ[0][3][3] = -0.0625*(t1*t12*t17*t296*t4*t43*t51*t65);</w><br/><w>christ[1][0][0] = (t1*t298*t301*t34*t36*t4*t65*t67)/4.;</w><br/><w>christ[1][0][1] = -0.5*(t1*t12*t17*t36*t4*t65*((t308*t43)/2. - t3*t36*t46*t81));</w><br/><w>christ[1][0][2] = -0.25*(t1*t104*t105*t12*t17*t3*t36*t4*t65);</w><br/><w>christ[1][0][3] = -0.25*(spin*t114*t298*t301*t4*t51*t58*t65);</w><br/><w>christ[1][1][1] = -(t1*t36*t4*t49*t65*((t3*t53*t54*t84)/pow(r,3) - (t301*t49*(r*(r + t148) + t3*t30*t9))/pow(t4,2)));</w><br/><w>christ[1][1][2] = t1*t131*t3*t301*t65*t67*t8;</w><br/><w>christ[1][1][3] = (spin*t1*t12*t151*t4*t51*t65)/4.;</w><br/><w>christ[1][2][2] = t21*t301*t36*t4*t65*t67;</w><br/><w>christ[1][2][3] = (-32*b1*r*t131*t23*pow(t4,2)*t49*t8*t89)/(-24*t125*t133 + 144*t125*t138 + 64*t159 - 32*t161 + 16*t125*t18 - 15*t18*t183 - 3*t1*t189 + 30*t183*t21 + 64*t133*t23 + 312*t135*t23 - 12*t163*t23 - 14*t125*t133*t259 + 16*t125*t138*t259 - 8*t125*t18*t259 - 20*t18*t183*t259 - 6*t1*t189*t259 - t18*t183*t272 - t1*t189*t272 + 2*t183*t21*t272 + 128*t163*t3 + 192*t165*t3 - 32*t168*t3 + 2*t14*t229*t3 - 4*t23*t256*t32 + 96*t125*t133*t53 - 96*t125*t138*t53 + 64*t125*t18*t53 - 32*t1*t183*t53 + 88*t18*t183*t53 + 48*t1*t189*t53 + 8*t192*t53 - 96*t183*t21*t53 - 64*t133*t23*t53 - 64*t135*t23*t53 + 80*t163*t23*t53 + 16*t1*t183*t259*t53 + 4*t18*t183*t259*t53 - 16*r*t189*t259*t53 + 8*t1*t189*t259*t53 + 4*t192*t259*t53 - 16*t183*t21*t259*t53 - 64*t165*t3*t53 + 32*t168*t3*t53);</w><br/><w>christ[1][3][3] = (t296*t298*t301*t4*t51*t58*t65)/16.;</w><br/><w>christ[2][0][0] = -0.5*(t105*t298*t3*t375*t98);</w><br/><w>christ[2][0][1] = 0;</w><br/><w>christ[2][0][2] = 0;</w><br/><w>christ[2][0][3] = (spin*t105*t298*t375*t38*t89)/2.;</w><br/><w>christ[2][1][1] = t116*t3*t35*t375*t8;</w><br/><w>christ[2][1][2] = r*t375;</w><br/><w>christ[2][1][3] = 0;</w><br/><w>christ[2][2][2] = -(t3*t35*t375*t8);</w><br/><w>christ[2][2][3] = 0;</w><br/><w>christ[2][3][3] = t298*t35*(-2*t105*t3*t35*t43 + t16*t3*t36*t41*t8 - t16*t43*t8 + t16*t3*t36*t375*t43*t8);</w><br/><w>christ[3][0][0] = -0.25*(b1*r*t17*t3*t34*t36*t4*t46*t49*t65);</w><br/><w>christ[3][0][1] = (spin*t17*t36*t65*(t308*t46*t58 - 2*t62*t81))/4.;</w><br/><w>christ[3][0][2] = (spin*t105*t4*t65*(t14*t3*(48*t133 + t399 + t1*t23*(15 - 64*t53) + 16*t18*t3*(3 - 2*t53)) + t1*(10*t125 + 32*t133 + 36*t1*t23 + t125*t259 + 48*t18*t3 + t399 - 64*t1*t23*t53 - 32*t18*t3*t53 + 6*t23*t32*(t3 + t71)))*t89)/64.;</w><br/><w>christ[3][0][3] = (b1*r*t114*t17*t4*t46*t49*t51*t65*t7)/4.;</w><br/><w>christ[3][1][1] = (b1*t1*t116*pow(t16,4)*t3*t36*t46*t49*t65*(t1*t118 + (t23 - r*t3)*t9))/pow(t21 + r*t14*t3,2);</w><br/><w>christ[3][1][2] = -(b1*r*t131*t23*t46*t49*t54*t65*t8);</w><br/><w>christ[3][1][3] = -0.5*(t17*t65*(((r*(r*(t110 + 8*t138 - 9*t23 - 4*t1*t3) + t23*t292*t32) + t14*t3*(24*t138 + t19 + t23 + 3*r*t23 + 12*t1*t3 + 20*t21*t3 + t33))*t36*t62)/4. + t1*t3*t46*t51*t67*t81));</w><br/><w>christ[3][2][2] = -(b1*t1*t3*t36*t4*t46*t49*t54*t65);</w><br/><w>christ[3][2][3] = t17*t65*(t35*t62*(-2*t105*t3*t35*t43*t49 + t16*t3*t36*t43*t8 + t16*t3*t36*t41*t49*t8 - t16*t43*t49*t8) + (t1*t131*t158*t3*t38*t8*t90)/4.);</w><br/><w>christ[3][3][3] = -0.0625*(b1*r*t17*t296*t3*t4*t46*t49*t51*t65);</w></div>",
       "mime": "x-application/wolfram-language-html"
      },
      {
       "data": "\"long double t1 = pow(r,2);\\nlong double t3 = pow(spin,2);\\nlong double t23 = pow(spin,4);\\nlong double t21 = pow(r,3);\\nlong double t13 = 2*th;\\nlong double t14 = cos(t13);\\nlong double t35 = sin(th);\\nlong double t36 = pow(t35,2);\\nlong double t8 = cos(th);\\nlong double t9 = pow(t8,2);\\nlong double t48 = t3*t9;\\nlong double t49 = t1 + t48;\\nlong double t37 = t1 + t3;\\nlong double t38 = pow(t37,2);\\nlong double t39 = -2 + r;\\nlong double t40 = r*t39;\\nlong double t41 = t3 + t40;\\nlong double t42 = -(t3*t36*t41);\\nlong double t43 = t38 + t42;\\nlong double t2 = -2*r;\\nlong double t4 = t1 + t2 + t3;\\nlong double t15 = t14*t3;\\nlong double t16 = t1 + t15;\\nlong double t17 = 1/t16;\\nlong double t44 = 2 + r;\\nlong double t45 = r*t44;\\nlong double t46 = t3 + t45;\\nlong double t70 = 3*r;\\nlong double t18 = pow(r,4);\\nlong double t19 = 4*t18;\\nlong double t20 = 6*t1*t3;\\nlong double t22 = 2*t21*t3;\\nlong double t24 = -t23;\\nlong double t25 = 5*r*t23;\\nlong double t26 = 3*t1;\\nlong double t27 = 3*r*t3;\\nlong double t28 = t21 + t26 + t27 + t3;\\nlong double t29 = -2*t14*t28*t3;\\nlong double t30 = -1 + r;\\nlong double t31 = 4*th;\\nlong double t32 = cos(t31);\\nlong double t33 = t23*t30*t32;\\nlong double t34 = t19 + t20 + t22 + t24 + t25 + t29 + t33;\\nlong double t47 = pow(t46,2);\\nlong double t50 = pow(t49,3);\\nlong double t51 = pow(t35,4);\\nlong double t52 = t1*t3*t47*t50*t51;\\nlong double t53 = pow(b1,2);\\nlong double t54 = pow(t16,2);\\nlong double t55 = -(t3*t4*t53*t54);\\nlong double t56 = r*t3*t9;\\nlong double t57 = t21 + t56;\\nlong double t58 = pow(t57,2);\\nlong double t59 = -4*t3*t36;\\nlong double t60 = t3 + t40 + t59;\\nlong double t61 = t58*t60;\\nlong double t62 = t55 + t61;\\nlong double t63 = -(t36*t43*t49*t62);\\nlong double t64 = t52 + t63;\\nlong double t65 = 1/t64;\\nlong double t67 = pow(t49,2);\\nlong double t97 = t14*t3*t4;\\nlong double t5 = b1*r*spin;\\nlong double t6 = 1/r;\\nlong double t7 = pow(spin,3);\\nlong double t11 = b1*t6*t7*t9;\\nlong double t12 = t11 + t5;\\nlong double t77 = 1 + r;\\nlong double t74 = 2*t3;\\nlong double t125 = pow(spin,6);\\nlong double t138 = pow(r,5);\\nlong double t71 = 2*t1;\\nlong double t165 = pow(r,9);\\nlong double t168 = pow(r,10);\\nlong double t133 = pow(r,6);\\nlong double t135 = pow(r,7);\\nlong double t163 = pow(r,8);\\nlong double t183 = pow(spin,8);\\nlong double t189 = pow(spin,10);\\nlong double t258 = 6*th;\\nlong double t259 = cos(t258);\\nlong double t192 = pow(spin,12);\\nlong double t271 = 8*th;\\nlong double t272 = cos(t271);\\nlong double t131 = pow(t35,3);\\nlong double t117 = -3*r;\\nlong double t68 = r + t3;\\nlong double t69 = 2*t21*t68;\\nlong double t72 = t3 + t70 + t71;\\nlong double t73 = -2*r*t14*t3*t72;\\nlong double t75 = t1 + t70 + t74;\\nlong double t76 = -(r*t75);\\nlong double t78 = t14*t3*t77;\\nlong double t79 = t76 + t78;\\nlong double t80 = -2*t3*t79*t9;\\nlong double t81 = t69 + t73 + t80;\\nlong double t107 = -4*t18;\\nlong double t108 = -6*t1*t3;\\nlong double t88 = 2*r;\\nlong double t89 = t1 + t3 + t88;\\nlong double t90 = pow(t89,2);\\nlong double t91 = 2*t38*t90;\\nlong double t92 = -6*t21;\\nlong double t93 = -t18;\\nlong double t94 = -4*r*t3;\\nlong double t95 = -3*t1*t3;\\nlong double t96 = -2*t23;\\nlong double t98 = t92 + t93 + t94 + t95 + t96 + t97;\\nlong double t99 = 2*t18;\\nlong double t100 = 2*r*t3;\\nlong double t101 = 3*t1*t3;\\nlong double t102 = t100 + t101 + t23 + t97 + t99;\\nlong double t103 = -(t102*t98);\\nlong double t104 = t103 + t91;\\nlong double t105 = sin(t13);\\nlong double t298 = pow(t16,-3);\\nlong double t109 = -6*t21*t3;\\nlong double t110 = -3*r*t23;\\nlong double t111 = t26 + t3;\\nlong double t112 = 2*t111*t14*t3*t77;\\nlong double t113 = t23*t32*t77;\\nlong double t114 = t107 + t108 + t109 + t110 + t112 + t113 + t23;\\nlong double t299 = -(t3*t36*t47);\\nlong double t300 = t43*t60;\\nlong double t301 = t299 + t300;\\nlong double t83 = -(t3*t36*t4);\\nlong double t84 = t38 + t83;\\nlong double t148 = -t3;\\nlong double t134 = 12*t133;\\nlong double t136 = 4*t135;\\nlong double t137 = 10*t18*t3;\\nlong double t139 = 10*t138*t3;\\nlong double t140 = 3*t1*t23;\\nlong double t141 = 8*t21*t23;\\nlong double t142 = -t125;\\nlong double t143 = 2*r*t125;\\nlong double t144 = 5*t18;\\nlong double t145 = r*t23;\\nlong double t146 = t138 + t144 + t145 + t22 + t24;\\nlong double t147 = 2*t14*t146*t3;\\nlong double t149 = t1 + t148;\\nlong double t150 = t149*t23*t32;\\nlong double t151 = t134 + t136 + t137 + t139 + t140 + t141 + t142 + t143 + t147 + t150;\\nlong double t159 = pow(r,11);\\nlong double t161 = pow(r,12);\\nlong double t194 = 32*t165;\\nlong double t195 = -64*t168;\\nlong double t196 = -6*t53;\\nlong double t197 = 1 + t196;\\nlong double t198 = 16*t135*t197*t3;\\nlong double t199 = -12*t53;\\nlong double t200 = 7 + t199;\\nlong double t201 = 8*t138*t200*t23;\\nlong double t202 = 3*t53;\\nlong double t203 = -2 + t202;\\nlong double t204 = -8*t125*t203*t21;\\nlong double t205 = -24*r*t183*t53;\\nlong double t206 = 6*t189*t53;\\nlong double t207 = -3 + t53;\\nlong double t208 = 5*t207*t3;\\nlong double t209 = -8 + t208;\\nlong double t210 = 8*t163*t209;\\nlong double t211 = -5*t183;\\nlong double t212 = 7*t3;\\nlong double t213 = 6 + t212;\\nlong double t214 = 4*t125*t213*t53;\\nlong double t215 = t211 + t214;\\nlong double t216 = t1*t215;\\nlong double t217 = -15*t3;\\nlong double t218 = 39*t3;\\nlong double t219 = -32 + t218;\\nlong double t220 = t219*t53;\\nlong double t221 = 2 + t217 + t220;\\nlong double t222 = 2*t18*t221*t23;\\nlong double t223 = -81*t23;\\nlong double t224 = 3*t23;\\nlong double t225 = t224 + t3;\\nlong double t226 = 32*t225*t53;\\nlong double t227 = t223 + t226;\\nlong double t228 = t133*t227;\\nlong double t229 = t194 + t195 + t198 + t201 + t204 + t205 + t206 + t210 + t216 + t222 + t228;\\nlong double t231 = -10*t135;\\nlong double t232 = 17*t163;\\nlong double t233 = 6*t53;\\nlong double t234 = 1 + t233;\\nlong double t235 = 4*t138*t234*t3;\\nlong double t236 = 24*t21*t23*t53;\\nlong double t237 = -2*t183*t53;\\nlong double t238 = -8*t53;\\nlong double t239 = 30 + t238;\\nlong double t240 = t239*t3;\\nlong double t241 = 16 + t240;\\nlong double t242 = t133*t241;\\nlong double t243 = -8*t3;\\nlong double t244 = 9*t3;\\nlong double t245 = 8 + t244;\\nlong double t246 = t245*t53;\\nlong double t247 = -2 + t243 + t246;\\nlong double t248 = -2*t18*t247*t3;\\nlong double t249 = 3*t125;\\nlong double t250 = 8*t23;\\nlong double t251 = -12*t125;\\nlong double t252 = t250 + t251;\\nlong double t253 = t252*t53;\\nlong double t254 = t249 + t253;\\nlong double t255 = t1*t254;\\nlong double t256 = t231 + t232 + t235 + t236 + t237 + t242 + t248 + t255;\\nlong double t279 = 16*t135;\\nlong double t280 = -8*t18*t3;\\nlong double t281 = -18*t1*t23;\\nlong double t282 = -6*t21*t23;\\nlong double t283 = 8*t18;\\nlong double t284 = 48*t138;\\nlong double t285 = 24*t1*t3;\\nlong double t286 = 40*t21*t3;\\nlong double t287 = 7*r*t23;\\nlong double t288 = t23 + t283 + t284 + t285 + t286 + t287;\\nlong double t289 = t14*t288*t3;\\nlong double t290 = 7*t1;\\nlong double t291 = 4*t3;\\nlong double t292 = t117 + t290 + t291;\\nlong double t293 = 2*r*t23*t292*t32;\\nlong double t294 = -(t125*t259);\\nlong double t295 = r*t125*t259;\\nlong double t296 = t279 + t280 + t281 + t282 + t289 + t293 + t294 + t295;\\nlong double t375 = 1/t49;\\nlong double t116 = 1/t4;\\nlong double t304 = -2*t21*t3;\\nlong double t305 = -5*r*t23;\\nlong double t306 = 2*t14*t28*t3;\\nlong double t307 = -(t23*t30*t32);\\nlong double t308 = t107 + t108 + t23 + t304 + t305 + t306 + t307;\\nlong double t399 = -32*t125*t53;\\nlong double t118 = t1 + t117 + t74;\\nlong double t157 = t15 + t3 + t71;\\nlong double t158 = pow(t157,2);\\nchrist[0][0][0] = -0.25*(t1*t12*t17*t34*t36*t4*t43*t65);\\nchrist[0][0][1] = -0.5*(t1*t17*t36*t65*t67*(t3*t36*t46*t81 + (t34*t84)/2.));\\nchrist[0][0][2] = (t1*t104*t105*t17*t3*t36*t65*t67)/4.;\\nchrist[0][0][3] = (spin*t1*t114*t12*t17*t4*t43*t51*t65)/4.;\\nchrist[0][1][1] = b1*spin*t116*t36*t43*t54*t65*(t118*t18 + (t125 - r*t23)*pow(t8,4) + t1*t3*(-4*r + t1 + 3*t3)*t9);\\nchrist[0][1][2] = -(t1*t12*t131*t3*t43*t54*t65*t8);\\nchrist[0][1][3] = -0.25*(spin*t151*t51*t58*t65);\\nchrist[0][2][2] = -(t12*t21*t36*t4*t43*t54*t65);\\nchrist[0][2][3] = (-8*t1*t131*t158*(t18 + t23 + 2*t1*(-2 + t3))*t7*t8)/(24*t125*t133 - 144*t125*t138 - 64*t159 + 32*t161 - 16*t125*t18 + 15*t18*t183 + 3*t1*t189 - 30*t183*t21 - 64*t133*t23 - 312*t135*t23 + 12*t163*t23 + 14*t125*t133*t259 - 16*t125*t138*t259 + 8*t125*t18*t259 + 20*t18*t183*t259 + 6*t1*t189*t259 + t18*t183*t272 + t1*t189*t272 - 2*t183*t21*t272 - 128*t163*t3 - 192*t165*t3 + 32*t168*t3 - 2*t14*t229*t3 + 4*t23*t256*t32 - 96*t125*t133*t53 + 96*t125*t138*t53 - 64*t125*t18*t53 + 32*t1*t183*t53 - 88*t18*t183*t53 - 48*t1*t189*t53 - 8*t192*t53 + 96*t183*t21*t53 + 64*t133*t23*t53 + 64*t135*t23*t53 - 80*t163*t23*t53 - 16*t1*t183*t259*t53 - 4*t18*t183*t259*t53 + 16*r*t189*t259*t53 - 8*t1*t189*t259*t53 - 4*t192*t259*t53 + 16*t183*t21*t259*t53 + 64*t165*t3*t53 - 32*t168*t3*t53);\\nchrist[0][3][3] = -0.0625*(t1*t12*t17*t296*t4*t43*t51*t65);\\nchrist[1][0][0] = (t1*t298*t301*t34*t36*t4*t65*t67)/4.;\\nchrist[1][0][1] = -0.5*(t1*t12*t17*t36*t4*t65*((t308*t43)/2. - t3*t36*t46*t81));\\nchrist[1][0][2] = -0.25*(t1*t104*t105*t12*t17*t3*t36*t4*t65);\\nchrist[1][0][3] = -0.25*(spin*t114*t298*t301*t4*t51*t58*t65);\\nchrist[1][1][1] = -(t1*t36*t4*t49*t65*((t3*t53*t54*t84)/pow(r,3) - (t301*t49*(r*(r + t148) + t3*t30*t9))/pow(t4,2)));\\nchrist[1][1][2] = t1*t131*t3*t301*t65*t67*t8;\\nchrist[1][1][3] = (spin*t1*t12*t151*t4*t51*t65)/4.;\\nchrist[1][2][2] = t21*t301*t36*t4*t65*t67;\\nchrist[1][2][3] = (-32*b1*r*t131*t23*pow(t4,2)*t49*t8*t89)/(-24*t125*t133 + 144*t125*t138 + 64*t159 - 32*t161 + 16*t125*t18 - 15*t18*t183 - 3*t1*t189 + 30*t183*t21 + 64*t133*t23 + 312*t135*t23 - 12*t163*t23 - 14*t125*t133*t259 + 16*t125*t138*t259 - 8*t125*t18*t259 - 20*t18*t183*t259 - 6*t1*t189*t259 - t18*t183*t272 - t1*t189*t272 + 2*t183*t21*t272 + 128*t163*t3 + 192*t165*t3 - 32*t168*t3 + 2*t14*t229*t3 - 4*t23*t256*t32 + 96*t125*t133*t53 - 96*t125*t138*t53 + 64*t125*t18*t53 - 32*t1*t183*t53 + 88*t18*t183*t53 + 48*t1*t189*t53 + 8*t192*t53 - 96*t183*t21*t53 - 64*t133*t23*t53 - 64*t135*t23*t53 + 80*t163*t23*t53 + 16*t1*t183*t259*t53 + 4*t18*t183*t259*t53 - 16*r*t189*t259*t53 + 8*t1*t189*t259*t53 + 4*t192*t259*t53 - 16*t183*t21*t259*t53 - 64*t165*t3*t53 + 32*t168*t3*t53);\\nchrist[1][3][3] = (t296*t298*t301*t4*t51*t58*t65)/16.;\\nchrist[2][0][0] = -0.5*(t105*t298*t3*t375*t98);\\nchrist[2][0][1] = 0;\\nchrist[2][0][2] = 0;\\nchrist[2][0][3] = (spin*t105*t298*t375*t38*t89)/2.;\\nchrist[2][1][1] = t116*t3*t35*t375*t8;\\nchrist[2][1][2] = r*t375;\\nchrist[2][1][3] = 0;\\nchrist[2][2][2] = -(t3*t35*t375*t8);\\nchrist[2][2][3] = 0;\\nchrist[2][3][3] = t298*t35*(-2*t105*t3*t35*t43 + t16*t3*t36*t41*t8 - t16*t43*t8 + t16*t3*t36*t375*t43*t8);\\nchrist[3][0][0] = -0.25*(b1*r*t17*t3*t34*t36*t4*t46*t49*t65);\\nchrist[3][0][1] = (spin*t17*t36*t65*(t308*t46*t58 - 2*t62*t81))/4.;\\nchrist[3][0][2] = (spin*t105*t4*t65*(t14*t3*(48*t133 + t399 + t1*t23*(15 - 64*t53) + 16*t18*t3*(3 - 2*t53)) + t1*(10*t125 + 32*t133 + 36*t1*t23 + t125*t259 + 48*t18*t3 + t399 - 64*t1*t23*t53 - 32*t18*t3*t53 + 6*t23*t32*(t3 + t71)))*t89)/64.;\\nchrist[3][0][3] = (b1*r*t114*t17*t4*t46*t49*t51*t65*t7)/4.;\\nchrist[3][1][1] = (b1*t1*t116*pow(t16,4)*t3*t36*t46*t49*t65*(t1*t118 + (t23 - r*t3)*t9))/pow(t21 + r*t14*t3,2);\\nchrist[3][1][2] = -(b1*r*t131*t23*t46*t49*t54*t65*t8);\\nchrist[3][1][3] = -0.5*(t17*t65*(((r*(r*(t110 + 8*t138 - 9*t23 - 4*t1*t3) + t23*t292*t32) + t14*t3*(24*t138 + t19 + t23 + 3*r*t23 + 12*t1*t3 + 20*t21*t3 + t33))*t36*t62)/4. + t1*t3*t46*t51*t67*t81));\\nchrist[3][2][2] = -(b1*t1*t3*t36*t4*t46*t49*t54*t65);\\nchrist[3][2][3] = t17*t65*(t35*t62*(-2*t105*t3*t35*t43*t49 + t16*t3*t36*t43*t8 + t16*t3*t36*t41*t49*t8 - t16*t43*t49*t8) + (t1*t131*t158*t3*t38*t8*t90)/4.);\\nchrist[3][3][3] = -0.0625*(b1*r*t17*t296*t3*t4*t46*t49*t51*t65);\"",
       "mime": "text/plain"
      }
     ],
     "id": "61645f11-46dc-45ff-adb4-0a7a1aeca21f",
     "metadata": {
      "cellLabel": "Out[380]= ",
      "isBoxData": false
     }
    }
   ],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691552042873,
     "endTime": 1691552043472
    },
    "executionOrder": 379,
    "success": true
   }
  },
  {
   "kind": 2,
   "value": "output = christoffel;\r\n\r\n(* write to christoffel file *)\r\nExport[\"christoffel.cpp\", output, \"Text\"];",
   "languageId": "wolfram",
   "outputs": [],
   "metadata": {},
   "executionSummary": {
    "timing": {
     "startTime": 1691552044796,
     "endTime": 1691552044981
    },
    "executionOrder": 384,
    "success": true
   }
  }
 ]
}