void metric(long double r, long double th, long double g[4][4])
{
long double t1 = pow(r,2);
long double t2 = pow(spin,2);
long double t3 = cos(th);
long double t4 = pow(t3,2);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t7 = 2*th;
long double t8 = cos(t7);
long double t9 = t2*t8;
long double t11 = t1 + t9;
long double t12 = pow(t11,-2);
long double t15 = sin(th);
long double t16 = pow(t15,2);
long double t20 = 1/r;
long double t21 = b1*spin*t20;
long double t22 = 2 + r;
long double t23 = r*t22;
long double t24 = t2 + t23;
long double t25 = -(spin*t12*t16*t24*t6);
long double t13 = -2 + r;
long double t14 = r*t13;
g[0][0] = t12*(t14 + t2 - 4*t16*t2)*t6;
g[0][1] = t21;
g[0][2] = 0;
g[0][3] = t25;
g[1][0] = t21;
g[1][1] = t6/(-2*r + t1 + t2);
g[1][2] = 0;
g[1][3] = 0;
g[2][0] = 0;
g[2][1] = 0;
g[2][2] = t6;
g[2][3] = 0;
g[3][0] = t25;
g[3][1] = 0;
g[3][2] = 0;
g[3][3] = t12*t16*(pow(t1 + t2,2) - t16*t2*(t14 + t2))*t6;
}

void uppermetric(long double r, long double th, long double gu[4][4])
{
long double t1 = pow(r,2);
long double t2 = pow(spin,2);
long double t14 = sin(th);
long double t15 = pow(t14,2);
long double t3 = cos(th);
long double t4 = pow(t3,2);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t16 = t1 + t2;
long double t17 = pow(t16,2);
long double t18 = -2 + r;
long double t19 = r*t18;
long double t20 = t19 + t2;
long double t21 = -(t15*t2*t20);
long double t22 = t17 + t21;
long double t8 = 2*th;
long double t9 = cos(t8);
long double t11 = t2*t9;
long double t12 = t1 + t11;
long double t13 = pow(t12,2);
long double t31 = -2*r;
long double t32 = t1 + t2 + t31;
long double t23 = 2 + r;
long double t24 = r*t23;
long double t25 = t2 + t24;
long double t26 = pow(t25,2);
long double t27 = pow(t6,3);
long double t28 = pow(t14,4);
long double t29 = t1*t2*t26*t27*t28;
long double t30 = pow(b1,2);
long double t33 = -(t13*t2*t30*t32);
long double t34 = pow(r,3);
long double t35 = r*t2*t4;
long double t36 = t34 + t35;
long double t37 = pow(t36,2);
long double t38 = -4*t15*t2;
long double t39 = t19 + t2 + t38;
long double t40 = t37*t39;
long double t41 = t33 + t40;
long double t42 = -(t15*t22*t41*t6);
long double t43 = t29 + t42;
long double t44 = 1/t43;
long double t7 = pow(t6,2);
long double t46 = b1*r*spin;
long double t47 = 1/r;
long double t48 = pow(spin,3);
long double t49 = b1*t4*t47*t48;
long double t50 = t46 + t49;
long double t51 = t1*t13*t15*t22*t32*t44*t50;
long double t52 = -(spin*t1*t13*t15*t25*t44*t7);
gu[0][0] = -(t1*t13*t15*t22*t44*t7);
gu[0][1] = t51;
gu[0][2] = 0;
gu[0][3] = t52;
gu[1][0] = t51;
gu[1][1] = -(t1*t15*t32*(-(t15*t2*t26) + t22*t39)*t44*t7);
gu[1][2] = 0;
gu[1][3] = b1*r*t13*t15*t2*t25*t32*t44*t6;
gu[2][0] = 0;
gu[2][1] = 0;
gu[2][2] = 1/t6;
gu[2][3] = 0;
gu[3][0] = t52;
gu[3][1] = spin*t1*t13*t15*t25*t32*t44*t50;
gu[3][2] = 0;
gu[3][3] = -(t1*pow(t12,4)*t32*t44*(-((t2*t30)/pow(r,2)) + (t39*t7)/(pow(t12,2)*t32)));
}

void metric_rderivatives(long double r, long double th, long double dg[4][4])
{
long double t1 = pow(r,2);
long double t2 = pow(spin,2);
long double t14 = pow(spin,4);
long double t12 = pow(r,3);
long double t3 = 2*th;
long double t4 = cos(t3);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t7 = pow(t6,-3);
long double t8 = pow(r,4);
long double t17 = 3*t1;
long double t33 = 1 + r;
long double t22 = 4*th;
long double t23 = cos(t22);
long double t27 = pow(r,-2);
long double t28 = -(b1*spin*t27);
long double t21 = -1 + r;
long double t29 = -4*t8;
long double t30 = -6*t1*t2;
long double t31 = -6*t12*t2;
long double t32 = -3*r*t14;
long double t34 = t17 + t2;
long double t35 = 2*t2*t33*t34*t4;
long double t36 = t14*t23*t33;
long double t37 = t14 + t29 + t30 + t31 + t32 + t35 + t36;
long double t38 = sin(th);
long double t39 = pow(t38,2);
long double t40 = -0.5*(spin*t37*t39*t7);
long double t71 = pow(spin,6);
long double t72 = 6*th;
long double t73 = cos(t72);
dg[0][0] = (t7*(-t14 + 5*r*t14 + 6*t1*t2 + 2*t12*t2 + t14*t21*t23 - 2*t2*(t12 + t17 + t2 + 3*r*t2)*t4 + 4*t8))/2.;
dg[0][1] = t28;
dg[0][2] = 0;
dg[0][3] = t40;
dg[1][0] = t28;
dg[1][1] = (-2*(r*(r - t2) + t2*t21*pow(cos(th),2)))/pow(-2*r + t1 + t2,2);
dg[1][2] = 0;
dg[1][3] = 0;
dg[2][0] = 0;
dg[2][1] = 0;
dg[2][2] = 2*r;
dg[2][3] = 0;
dg[3][0] = t40;
dg[3][1] = 0;
dg[3][2] = 0;
dg[3][3] = (t39*t7*(16*pow(r,7) - 18*t1*t14 - 6*t12*t14 + 2*r*t14*(-3*r + 7*t1 + 4*t2)*t23 - t71*t73 + r*t71*t73 - 8*t2*t8 + t2*t4*(48*pow(r,5) + t14 + 7*r*t14 + 24*t1*t2 + 40*t12*t2 + 8*t8)))/8.;
}

void metric_r2derivatives(long double r, long double th, long double dg2[4][4])
{
long double t2 = pow(spin,2);
long double t1 = pow(r,2);
long double t11 = pow(r,3);
long double t13 = pow(r,4);
long double t15 = pow(spin,4);
long double t3 = 2*th;
long double t4 = cos(t3);
long double t17 = pow(spin,6);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t7 = pow(t6,-4);
long double t8 = pow(r,5);
long double t9 = 16*t8;
long double t12 = 48*t11*t2;
long double t19 = 80*t11;
long double t21 = 48*r*t2;
long double t29 = 4*th;
long double t30 = cos(t29);
long double t32 = 6*th;
long double t33 = cos(t32);
long double t37 = pow(r,-3);
long double t38 = 2*b1*spin*t37;
long double t39 = 36*t13*t2;
long double t40 = 48*t1*t15;
long double t41 = 2*t17;
long double t42 = 36*t13;
long double t43 = 56*t1*t2;
long double t44 = 5*t15;
long double t45 = t19 + t21 + t42 + t43 + t44;
long double t46 = -(t2*t4*t45);
long double t47 = 4*t1;
long double t48 = t2 + t47;
long double t49 = 2*t15*t30*t48;
long double t50 = t17*t33;
long double t51 = t12 + t39 + t40 + t41 + t46 + t49 + t50 + t9;
long double t52 = sin(th);
long double t53 = pow(t52,2);
long double t54 = -0.25*(spin*t51*t53*t7);
long double t75 = pow(spin,8);
dg2[0][0] = -0.25*(t7*(t12 + 56*t1*t15 + 6*t17 + 12*t13*t2 + 2*t15*(8*t1 + 3*t2)*t30 - t17*t33 - t2*(12*t13 + 11*t15 + t19 + 72*t1*t2 + t21)*t4 + t9));
dg2[0][1] = t38;
dg2[0][2] = 0;
dg2[0][3] = t54;
dg2[1][0] = t38;
dg2[1][1] = (2*(2*t11 + t15 - 3*t1*t2 - t2*(-4 + 6*r - 3*t1 + t2)*pow(cos(th),2)))/pow(-2*r + t1 + t2,3);
dg2[1][2] = 0;
dg2[1][3] = 0;
dg2[2][0] = 0;
dg2[2][1] = 0;
dg2[2][2] = 2;
dg2[2][3] = 0;
dg2[3][0] = t54;
dg2[3][1] = 0;
dg2[3][2] = 0;
dg2[3][3] = (t53*t7*(32*pow(r,8) + 176*t11*t15 + 276*t13*t15 + 48*r*t17 + 120*t1*t17 + 4*t15*(20*t11 + 39*t13 + 2*t15 + 12*r*t2 + 10*t1*t2)*t30 + 32*t1*t17*t33 + 7*t75 + 8*t33*t75 + 8*t2*t4*(16*pow(r,6) - 12*r*t15 - 8*t1*t15 + t17 - 32*t11*t2 - 30*t13*t2 - 4*t8) + 32*t2*t8 + t75*cos(8*th)))/16.;
}