void metric(long double r, long double th, long double g[4][4])
{
long double t1 = pow(r,2);
long double t2 = pow(spin,2);
long double t3 = cos(th);
long double t4 = pow(t3,2);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t7 = 2*th;
long double t8 = cos(t7);
long double t9 = t2*t8;
long double t11 = t1 + t9;
long double t12 = pow(t11,-2);
long double t15 = sin(th);
long double t16 = pow(t15,2);
long double t20 = 1/r;
long double t21 = defpar*spin*t20;
long double t22 = 2 + r;
long double t23 = r*t22;
long double t24 = t2 + t23;
long double t25 = -(spin*t12*t16*t24*t6);
long double t13 = -2 + r;
long double t14 = r*t13;
g[0][0] = t12*(t14 + t2 - 4*t16*t2)*t6;
g[0][1] = t21;
g[0][2] = 0;
g[0][3] = t25;
g[1][0] = t21;
g[1][1] = t6/(-2*r + t1 + t2);
g[1][2] = 0;
g[1][3] = 0;
g[2][0] = 0;
g[2][1] = 0;
g[2][2] = t6;
g[2][3] = 0;
g[3][0] = t25;
g[3][1] = 0;
g[3][2] = 0;
g[3][3] = t12*t16*(pow(t1 + t2,2) - t16*t2*(t14 + t2))*t6;
}

void uppermetric(long double r, long double th, long double gu[4][4])
{
long double t1 = pow(r,2);
long double t2 = pow(spin,2);
long double t14 = sin(th);
long double t15 = pow(t14,2);
long double t3 = cos(th);
long double t4 = pow(t3,2);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t16 = t1 + t2;
long double t17 = pow(t16,2);
long double t18 = -2 + r;
long double t19 = r*t18;
long double t20 = t19 + t2;
long double t21 = -(t15*t2*t20);
long double t22 = t17 + t21;
long double t8 = 2*th;
long double t9 = cos(t8);
long double t11 = t2*t9;
long double t12 = t1 + t11;
long double t13 = pow(t12,2);
long double t23 = 2 + r;
long double t24 = r*t23;
long double t25 = t2 + t24;
long double t26 = pow(t25,2);
long double t27 = pow(t6,3);
long double t28 = pow(t14,4);
long double t29 = t1*t2*t26*t27*t28;
long double t30 = pow(defpar,2);
long double t31 = t13*t2*t20*t30;
long double t32 = pow(r,3);
long double t33 = r*t2*t4;
long double t34 = t32 + t33;
long double t35 = pow(t34,2);
long double t36 = -4*t15*t2;
long double t37 = t19 + t2 + t36;
long double t38 = -(t35*t37);
long double t39 = t31 + t38;
long double t40 = t15*t22*t39*t6;
long double t41 = t29 + t40;
long double t42 = 1/t41;
long double t7 = pow(t6,2);
long double t44 = defpar*r*spin;
long double t45 = 1/r;
long double t46 = pow(spin,3);
long double t47 = defpar*t4*t45*t46;
long double t48 = t44 + t47;
long double t49 = t1*t13*t15*t20*t22*t42*t48;
long double t50 = -(spin*t1*t13*t15*t25*t42*t7);
gu[0][0] = -(t1*t13*t15*t22*t42*t7);
gu[0][1] = t49;
gu[0][2] = 0;
gu[0][3] = t50;
gu[1][0] = t49;
gu[1][1] = -(t1*t15*t20*(-(t15*t2*t26) + t22*t37)*t42*t7);
gu[1][2] = 0;
gu[1][3] = defpar*r*t13*t15*t2*t20*t25*t42*t6;
gu[2][0] = 0;
gu[2][1] = 0;
gu[2][2] = 1/t6;
gu[2][3] = 0;
gu[3][0] = t50;
gu[3][1] = spin*t1*t13*t15*t20*t25*t42*t48;
gu[3][2] = 0;
gu[3][3] = -(t1*pow(t12,4)*t20*t42*(-((t2*t30)/pow(r,2)) + (t37*t7)/(pow(t12,2)*t20)));
}

void metric_rderivatives(long double r, long double th, long double dg[4][4])
{
long double t1 = pow(r,2);
long double t2 = pow(spin,2);
long double t14 = pow(spin,4);
long double t3 = 2*th;
long double t4 = cos(t3);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t7 = pow(t6,-3);
long double t8 = pow(r,4);
long double t12 = pow(r,3);
long double t37 = 1 + r;
long double t26 = 4*th;
long double t27 = cos(t26);
long double t31 = pow(r,-2);
long double t32 = -(defpar*spin*t31);
long double t24 = -r;
long double t25 = 1 + t24;
long double t33 = -4*t8;
long double t34 = -6*t1*t2;
long double t35 = -6*t12*t2;
long double t36 = -3*r*t14;
long double t38 = 3*t1;
long double t39 = t2 + t38;
long double t40 = 2*t2*t37*t39*t4;
long double t41 = t14*t27*t37;
long double t42 = t14 + t33 + t34 + t35 + t36 + t40 + t41;
long double t43 = sin(th);
long double t44 = pow(t43,2);
long double t45 = -0.5*(spin*t42*t44*t7);
long double t79 = pow(spin,6);
long double t80 = 6*th;
long double t81 = cos(t80);
dg[0][0] = (t7*(-t14 + 5*r*t14 + 6*t1*t2 + 2*t12*t2 - t14*t25*t27 - 2*t2*((3 + r)*t1 + (1 + 3*r)*t2)*t4 + 4*t8))/2.;
dg[0][1] = t32;
dg[0][2] = 0;
dg[0][3] = t45;
dg[1][0] = t32;
dg[1][1] = (2*(r*(t2 + t24) + t2*t25*pow(cos(th),2)))/pow((-2 + r)*r + t2,2);
dg[1][2] = 0;
dg[1][3] = 0;
dg[2][0] = 0;
dg[2][1] = 0;
dg[2][2] = 2*r;
dg[2][3] = 0;
dg[3][0] = t45;
dg[3][1] = 0;
dg[3][2] = 0;
dg[3][3] = (t44*t7*(16*pow(r,7) - 18*t1*t14 - 6*t12*t14 + 2*r*t14*(-3*r + 7*t1 + 4*t2)*t27 - 8*t2*t8 + t2*t4*((1 + 7*r)*t14 + 8*(3 + 5*r)*t1*t2 + 8*(1 + 6*r)*t8) - t79*t81 + r*t79*t81))/8.;
}

void metric_r2derivatives(long double r, long double th, long double dg2[4][4])
{
long double t2 = pow(spin,2);
long double t1 = pow(r,2);
long double t11 = pow(r,3);
long double t19 = 3*r;
long double t15 = pow(spin,4);
long double t3 = 2*th;
long double t4 = cos(t3);
long double t17 = pow(spin,6);
long double t5 = t2*t4;
long double t6 = t1 + t5;
long double t7 = pow(t6,-4);
long double t8 = pow(r,5);
long double t9 = 16*t8;
long double t12 = 48*t11*t2;
long double t13 = pow(r,4);
long double t30 = 4*th;
long double t31 = cos(t30);
long double t33 = 6*th;
long double t34 = cos(t33);
long double t38 = pow(r,-3);
long double t39 = 2*defpar*spin*t38;
long double t40 = 36*t13*t2;
long double t41 = 48*t1*t15;
long double t42 = 2*t17;
long double t43 = 9*r;
long double t44 = 20 + t43;
long double t45 = 4*t11*t44;
long double t46 = 7*r;
long double t47 = 6 + t46;
long double t48 = 8*r*t2*t47;
long double t49 = 5*t15;
long double t50 = t45 + t48 + t49;
long double t51 = -(t2*t4*t50);
long double t52 = 4*t1;
long double t53 = t2 + t52;
long double t54 = 2*t15*t31*t53;
long double t55 = t17*t34;
long double t56 = t12 + t40 + t41 + t42 + t51 + t54 + t55 + t9;
long double t57 = sin(th);
long double t58 = pow(t57,2);
long double t59 = -0.25*(spin*t56*t58*t7);
long double t81 = pow(spin,8);
dg2[0][0] = -0.25*(t7*(t12 + 56*t1*t15 + 6*t17 + 12*t13*t2 + 2*t15*(8*t1 + 3*t2)*t31 - t17*t34 - t2*(11*t15 + 4*t11*(20 + t19) + 24*r*(2 + t19)*t2)*t4 + t9));
dg2[0][1] = t39;
dg2[0][2] = 0;
dg2[0][3] = t59;
dg2[1][0] = t39;
dg2[1][1] = (2*(2*t11 + t15 - 3*t1*t2 - t2*(-4 + 6*r - 3*t1 + t2)*pow(cos(th),2)))/pow((-2 + r)*r + t2,3);
dg2[1][2] = 0;
dg2[1][3] = 0;
dg2[2][0] = 0;
dg2[2][1] = 0;
dg2[2][2] = 2;
dg2[2][3] = 0;
dg2[3][0] = t59;
dg2[3][1] = 0;
dg2[3][2] = 0;
dg2[3][3] = (t58*t7*(32*pow(r,8) + 176*t11*t15 + 276*t13*t15 + 48*r*t17 + 120*t1*t17 + 4*t15*((20 + 39*r)*t11 + 2*t15 + 2*r*(6 + 5*r)*t2)*t31 + 32*t1*t17*t34 + 32*t2*t8 + 8*t2*t4*(-4*r*(3 + 2*r)*t15 + t17 - 2*(16 + 15*r)*t11*t2 + 4*(-1 + 4*r)*t8) + 7*t81 + 8*t34*t81 + t81*cos(8*th)))/16.;
}